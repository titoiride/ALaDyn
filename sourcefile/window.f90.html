<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="A High-Accuracy PIC Code for the Maxwell-Vlasov Equations">
    
    <meta name="author" content="The ALaDyn Collaboration" >
    <link rel="icon" href="../favicon.png">

    <title>window.f90 &ndash; ALaDyn</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">ALaDyn <small>3.0.1</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>Guide</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../program/aladyn.html">Program</a></li>
      
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/aladyn.html">Program</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>window.f90
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 1.1% of total for source files.">271 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/window.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
  
     <li class="active">window.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/window.html">window</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/window.f90.html#src">window.f90</a>
  </div>
</div>



</div>

    </div>
    <div class="col-md-9" id='text'>
      
      <br>
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">This file depends on</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~window.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefilewindowf90EfferentGraph" width="641pt" height="355pt"
 viewBox="0.00 0.00 641.00 355.27" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~window.f90~~EfferentGraph" class="graph" transform="scale(.7559 .7559) rotate(0) translate(4 466)">
<title>sourcefile~~window.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-466 844,-466 844,4 -4,4"/>
<!-- sourcefile~window.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~window.f90</title>
<polygon fill="none" stroke="#000000" points="840,-224 768,-224 768,-200 840,-200 840,-224"/>
<text text-anchor="middle" x="804" y="-209.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">window.f90</text>
</g>
<!-- sourcefile~run_data_info.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~run_data_info.f90</title>
<g id="a_sourcefile~~window.f90~~EfferentGraph_node2"><a xlink:href=".././sourcefile/run_data_info.f90.html" xlink:title="run_data_info.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="717.5,-155 611.5,-155 611.5,-131 717.5,-131 717.5,-155"/>
<text text-anchor="middle" x="664.5" y="-140.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">run_data_info.f90</text>
</a>
</g>
</g>
<!-- sourcefile~window.f90&#45;&gt;sourcefile~run_data_info.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~window.f90&#45;&gt;sourcefile~run_data_info.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M785.8356,-199.9695C771.5595,-190.808 750.9818,-178.2401 732,-169 724.6148,-165.405 716.5971,-161.9498 708.7523,-158.7976"/>
<polygon fill="#ff0000" stroke="#ff0000" points="709.9112,-155.4928 699.3232,-155.1139 707.364,-162.0129 709.9112,-155.4928"/>
</g>
<!-- sourcefile~util.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~util.f90</title>
<g id="a_sourcefile~~window.f90~~EfferentGraph_node3"><a xlink:href=".././sourcefile/util.f90.html" xlink:title="util.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="350.5,-462 296.5,-462 296.5,-438 350.5,-438 350.5,-462"/>
<text text-anchor="middle" x="323.5" y="-447.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">util.f90</text>
</a>
</g>
</g>
<!-- sourcefile~window.f90&#45;&gt;sourcefile~util.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~window.f90&#45;&gt;sourcefile~util.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M490.5,-450C446.0503,-451.4977 394.908,-451.2006 361.0535,-450.7217"/>
<polygon fill="#ff0000" stroke="#ff0000" points="360.7525,-447.2168 350.6996,-450.562 360.6444,-454.2159 360.7525,-447.2168"/>
</g>
<!-- sourcefile~pstruct_data.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~pstruct_data.f90</title>
<g id="a_sourcefile~~window.f90~~EfferentGraph_node4"><a xlink:href=".././sourcefile/pstruct_data.f90.html" xlink:title="pstruct_data.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="373,-344 274,-344 274,-320 373,-320 373,-344"/>
<text text-anchor="middle" x="323.5" y="-329.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pstruct_data.f90</text>
</a>
</g>
</g>
<!-- sourcefile~window.f90&#45;&gt;sourcefile~pstruct_data.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~window.f90&#45;&gt;sourcefile~pstruct_data.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M797.2022,-224.1285C767.1071,-276.0436 640.6943,-475.7514 490.5,-450"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M490.5,-450C423.4063,-452.2607 364.3111,-386.7954 338.0072,-352.426"/>
<polygon fill="#ff0000" stroke="#ff0000" points="340.536,-349.9614 331.7587,-344.0275 334.9198,-354.1398 340.536,-349.9614"/>
</g>
<!-- sourcefile~common_param.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_node5" class="node">
<title>sourcefile~common_param.f90</title>
<g id="a_sourcefile~~window.f90~~EfferentGraph_node5"><a xlink:href=".././sourcefile/common_param.f90.html" xlink:title="common_param.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="384,-24 263,-24 263,0 384,0 384,-24"/>
<text text-anchor="middle" x="323.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">common_param.f90</text>
</a>
</g>
</g>
<!-- sourcefile~window.f90&#45;&gt;sourcefile~common_param.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~window.f90&#45;&gt;sourcefile~common_param.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M796.7415,-199.8102C785.0787,-181.0619 760.5574,-144.9204 732,-122 665.9645,-68.9992 642.3106,-61.6299 561,-38 506.4509,-22.1473 442.2959,-15.815 394.4239,-13.3538"/>
<polygon fill="#ff0000" stroke="#ff0000" points="394.3124,-9.8448 384.1593,-12.8723 393.9843,-16.8371 394.3124,-9.8448"/>
</g>
<!-- sourcefile~grid_param.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_node6" class="node">
<title>sourcefile~grid_param.f90</title>
<g id="a_sourcefile~~window.f90~~EfferentGraph_node6"><a xlink:href=".././sourcefile/grid_param.f90.html" xlink:title="grid_param.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="537.5,-262 443.5,-262 443.5,-238 537.5,-238 537.5,-262"/>
<text text-anchor="middle" x="490.5" y="-247.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">grid_param.f90</text>
</a>
</g>
</g>
<!-- sourcefile~window.f90&#45;&gt;sourcefile~grid_param.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge8" class="edge">
<title>sourcefile~window.f90&#45;&gt;sourcefile~grid_param.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M664.5,-183C615.035,-181.8766 607.214,-206.3276 561,-224 551.9565,-227.4582 542.2311,-231.0966 532.9793,-234.52"/>
<polygon fill="#ff0000" stroke="#ff0000" points="531.7299,-231.2503 523.5578,-237.9932 534.1512,-237.8182 531.7299,-231.2503"/>
</g>
<!-- sourcefile~mpi_part_interface.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_node7" class="node">
<title>sourcefile~mpi_part_interface.f90</title>
<g id="a_sourcefile~~window.f90~~EfferentGraph_node7"><a xlink:href=".././sourcefile/mpi_part_interface.f90.html" xlink:title="mpi_part_interface.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="731,-304 598,-304 598,-280 731,-280 731,-304"/>
<text text-anchor="middle" x="664.5" y="-289.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mpi_part_interface.f90</text>
</a>
</g>
</g>
<!-- sourcefile~window.f90&#45;&gt;sourcefile~mpi_part_interface.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge6" class="edge">
<title>sourcefile~window.f90&#45;&gt;sourcefile~mpi_part_interface.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M788.545,-224.0133C774.3307,-234.7465 752.4242,-250.5056 732,-262 723.2908,-266.9014 713.6289,-271.5988 704.4015,-275.762"/>
<polygon fill="#ff0000" stroke="#ff0000" points="702.7475,-272.6658 695.0009,-279.8935 705.564,-279.0742 702.7475,-272.6658"/>
</g>
<!-- sourcefile~fstruct_data.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_node8" class="node">
<title>sourcefile~fstruct_data.f90</title>
<g id="a_sourcefile~~window.f90~~EfferentGraph_node8"><a xlink:href=".././sourcefile/fstruct_data.f90.html" xlink:title="fstruct_data.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="371.5,-222 275.5,-222 275.5,-198 371.5,-198 371.5,-222"/>
<text text-anchor="middle" x="323.5" y="-207.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">fstruct_data.f90</text>
</a>
</g>
</g>
<!-- sourcefile~window.f90&#45;&gt;sourcefile~fstruct_data.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge7" class="edge">
<title>sourcefile~window.f90&#45;&gt;sourcefile~fstruct_data.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M767.9991,-200.7501C740.0743,-192.9466 700.2351,-183.8116 664.5,-183"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M664.5,-183C587.0323,-181.2406 567.9877,-172.0862 490.5,-172"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M490.5,-172C447.3855,-171.9521 399.5354,-184.1494 366.146,-194.7359"/>
<polygon fill="#ff0000" stroke="#ff0000" points="364.6928,-191.5282 356.2693,-197.9542 366.8616,-198.1837 364.6928,-191.5282"/>
</g>
<!-- sourcefile~mpi_field_interface.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_node9" class="node">
<title>sourcefile~mpi_field_interface.f90</title>
<g id="a_sourcefile~~window.f90~~EfferentGraph_node9"><a xlink:href=".././sourcefile/mpi_field_interface.f90.html" xlink:title="mpi_field_interface.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="732,-253 597,-253 597,-229 732,-229 732,-253"/>
<text text-anchor="middle" x="664.5" y="-238.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mpi_field_interface.f90</text>
</a>
</g>
</g>
<!-- sourcefile~window.f90&#45;&gt;sourcefile~mpi_field_interface.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~window.f90&#45;&gt;sourcefile~mpi_field_interface.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M767.7122,-219.5437C756.7558,-221.8214 744.3557,-224.3992 732.0471,-226.9579"/>
<polygon fill="#ff0000" stroke="#ff0000" points="731.3032,-223.5377 722.2249,-228.9998 732.728,-230.3912 731.3032,-223.5377"/>
</g>
<!-- sourcefile~run_data_info.f90&#45;&gt;sourcefile~pstruct_data.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge12" class="edge">
<title>sourcefile~run_data_info.f90&#45;&gt;sourcefile~pstruct_data.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M631.6888,-155.0833C620.6018,-159.3131 608.1986,-164.2068 597,-169 580.7332,-175.9625 577.5058,-179.6247 561,-186 499.8844,-209.6056 475.6134,-194.3662 420,-229 410.5816,-234.8654 366.1861,-283.9891 341.0208,-312.2243"/>
<polygon fill="#ff0000" stroke="#ff0000" points="338.2128,-310.115 334.1827,-319.9134 343.4436,-314.7668 338.2128,-310.115"/>
</g>
<!-- sourcefile~run_data_info.f90&#45;&gt;sourcefile~common_param.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge13" class="edge">
<title>sourcefile~run_data_info.f90&#45;&gt;sourcefile~common_param.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M650.01,-130.7715C630.8022,-115.1206 595.3224,-88.1098 561,-72 531.5164,-58.1613 521.61,-61.6415 490.5,-52"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M490.5,-52C458.5191,-42.0886 422.4586,-33.1752 392.0526,-26.2918"/>
<polygon fill="#ff0000" stroke="#ff0000" points="392.4947,-22.8043 381.9718,-24.0367 390.9665,-29.6354 392.4947,-22.8043"/>
</g>
<!-- sourcefile~run_data_info.f90&#45;&gt;sourcefile~grid_param.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge17" class="edge">
<title>sourcefile~run_data_info.f90&#45;&gt;sourcefile~grid_param.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M621.2684,-155.0324C612.6845,-158.6502 604.1315,-163.2395 597,-169 574.2729,-187.3579 583.8582,-205.8057 561,-224 556.3575,-227.6953 551.1392,-230.8982 545.6962,-233.6671"/>
<polygon fill="#ff0000" stroke="#ff0000" points="544.0227,-230.5838 536.3859,-237.9275 546.9355,-236.949 544.0227,-230.5838"/>
</g>
<!-- sourcefile~run_data_info.f90&#45;&gt;sourcefile~fstruct_data.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge15" class="edge">
<title>sourcefile~run_data_info.f90&#45;&gt;sourcefile~fstruct_data.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M490.5,-134C457.5075,-136.6557 449.4075,-142.8094 420,-158 402.4647,-167.0579 401.1699,-174.2673 384,-184 377.9192,-187.4469 371.292,-190.7304 364.7263,-193.7319"/>
<polygon fill="#ff0000" stroke="#ff0000" points="362.9652,-190.6829 355.2216,-197.9139 365.7844,-197.0901 362.9652,-190.6829"/>
</g>
<!-- sourcefile~ionz_data.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_node11" class="node">
<title>sourcefile~ionz_data.f90</title>
<g id="a_sourcefile~~window.f90~~EfferentGraph_node11"><a xlink:href=".././sourcefile/ionz_data.f90.html" xlink:title="ionz_data.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="226.5,-153 142.5,-153 142.5,-129 226.5,-129 226.5,-153"/>
<text text-anchor="middle" x="184.5" y="-138.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ionz_data.f90</text>
</a>
</g>
</g>
<!-- sourcefile~run_data_info.f90&#45;&gt;sourcefile~ionz_data.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge9" class="edge">
<title>sourcefile~run_data_info.f90&#45;&gt;sourcefile~ionz_data.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M490.5,-52C393.3848,-21.9023 356.7114,-36.5614 263,-76 256.4132,-78.7721 226.877,-103.9318 205.9801,-122.1188"/>
<polygon fill="#ff0000" stroke="#ff0000" points="203.418,-119.7095 198.189,-128.9241 208.023,-124.9816 203.418,-119.7095"/>
</g>
<!-- sourcefile~phys_param.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_node12" class="node">
<title>sourcefile~phys_param.f90</title>
<g id="a_sourcefile~~window.f90~~EfferentGraph_node12"><a xlink:href=".././sourcefile/phys_param.f90.html" xlink:title="phys_param.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="372.5,-142 274.5,-142 274.5,-118 372.5,-118 372.5,-142"/>
<text text-anchor="middle" x="323.5" y="-127.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">phys_param.f90</text>
</a>
</g>
</g>
<!-- sourcefile~run_data_info.f90&#45;&gt;sourcefile~phys_param.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge10" class="edge">
<title>sourcefile~run_data_info.f90&#45;&gt;sourcefile~phys_param.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M611.1404,-136.6004C576.6824,-133.3662 530.9026,-130.7478 490.5,-134"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M490.5,-134C454.7638,-136.8766 414.5989,-136.0422 382.6158,-134.4101"/>
<polygon fill="#ff0000" stroke="#ff0000" points="382.7122,-130.9102 372.5352,-133.8559 382.3279,-137.8997 382.7122,-130.9102"/>
</g>
<!-- sourcefile~control_bunch_input.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_node13" class="node">
<title>sourcefile~control_bunch_input.f90</title>
<g id="a_sourcefile~~window.f90~~EfferentGraph_node13"><a xlink:href=".././sourcefile/control_bunch_input.f90.html" xlink:title="control_bunch_input.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="561,-105 420,-105 420,-81 561,-81 561,-105"/>
<text text-anchor="middle" x="490.5" y="-90.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">control_bunch_input.f90</text>
</a>
</g>
</g>
<!-- sourcefile~run_data_info.f90&#45;&gt;sourcefile~control_bunch_input.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge11" class="edge">
<title>sourcefile~run_data_info.f90&#45;&gt;sourcefile~control_bunch_input.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M622.3795,-130.8964C598.317,-123.9819 567.9472,-115.2549 542.4183,-107.919"/>
<polygon fill="#ff0000" stroke="#ff0000" points="543.1116,-104.4767 532.5339,-105.0787 541.1783,-111.2044 543.1116,-104.4767"/>
</g>
<!-- sourcefile~parallel.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_node15" class="node">
<title>sourcefile~parallel.f90</title>
<g id="a_sourcefile~~window.f90~~EfferentGraph_node15"><a xlink:href=".././sourcefile/parallel.f90.html" xlink:title="parallel.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="528.5,-304 452.5,-304 452.5,-280 528.5,-280 528.5,-304"/>
<text text-anchor="middle" x="490.5" y="-289.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">parallel.F90</text>
</a>
</g>
</g>
<!-- sourcefile~run_data_info.f90&#45;&gt;sourcefile~parallel.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge14" class="edge">
<title>sourcefile~run_data_info.f90&#45;&gt;sourcefile~parallel.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M617.3462,-155.0479C609.8413,-158.5897 602.6894,-163.1468 597,-169 563.4923,-203.4724 595.8291,-237.8632 561,-271 554.6823,-277.0107 546.7193,-281.309 538.4381,-284.3808"/>
<polygon fill="#ff0000" stroke="#ff0000" points="537.1433,-281.1187 528.65,-287.4524 539.2393,-287.7976 537.1433,-281.1187"/>
</g>
<!-- sourcefile~code_util.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_node16" class="node">
<title>sourcefile~code_util.f90</title>
<g id="a_sourcefile~~window.f90~~EfferentGraph_node16"><a xlink:href=".././sourcefile/code_util.f90.html" xlink:title="code_util.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="225,-403 144,-403 144,-379 225,-379 225,-403"/>
<text text-anchor="middle" x="184.5" y="-388.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">code_util.f90</text>
</a>
</g>
</g>
<!-- sourcefile~run_data_info.f90&#45;&gt;sourcefile~code_util.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge16" class="edge">
<title>sourcefile~run_data_info.f90&#45;&gt;sourcefile~code_util.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M490.5,-134C464.5778,-136.0866 281.8012,-171.0326 263,-189 221.5119,-228.6481 248.8563,-259.9384 227,-313 218.6827,-333.1922 206.5626,-354.9124 197.3917,-370.2915"/>
<polygon fill="#ff0000" stroke="#ff0000" points="194.3169,-368.6121 192.1231,-378.9774 200.3019,-372.2425 194.3169,-368.6121"/>
</g>
<!-- sourcefile~util.f90&#45;&gt;sourcefile~code_util.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge18" class="edge">
<title>sourcefile~util.f90&#45;&gt;sourcefile~code_util.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M296.3694,-438.4841C275.2598,-429.5239 245.7171,-416.9842 222.2917,-407.0411"/>
<polygon fill="#ffbf00" stroke="#ffbf00" points="223.5683,-403.7808 212.9957,-403.0953 220.8332,-410.2243 223.5683,-403.7808"/>
</g>
<!-- sourcefile~precision_def.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_node17" class="node">
<title>sourcefile~precision_def.f90</title>
<g id="a_sourcefile~~window.f90~~EfferentGraph_node17"><a xlink:href=".././sourcefile/precision_def.f90.html" xlink:title="precision_def.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="106,-283 0,-283 0,-259 106,-259 106,-283"/>
<text text-anchor="middle" x="53" y="-268.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">precision_def.F90</text>
</a>
</g>
</g>
<!-- sourcefile~util.f90&#45;&gt;sourcefile~precision_def.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge19" class="edge">
<title>sourcefile~util.f90&#45;&gt;sourcefile~precision_def.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M296.3272,-450.6709C258.4286,-450.2919 189.0658,-444.69 142,-412 99.0647,-382.1788 72.4165,-324.2674 60.4421,-292.7354"/>
<polygon fill="#ffbf00" stroke="#ffbf00" points="63.6547,-291.3286 56.9415,-283.132 57.078,-293.726 63.6547,-291.3286"/>
</g>
<!-- sourcefile~struct_def.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_node10" class="node">
<title>sourcefile~struct_def.f90</title>
<g id="a_sourcefile~~window.f90~~EfferentGraph_node10"><a xlink:href=".././sourcefile/struct_def.f90.html" xlink:title="struct_def.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="227,-262 142,-262 142,-238 227,-238 227,-262"/>
<text text-anchor="middle" x="184.5" y="-247.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">struct_def.f90</text>
</a>
</g>
</g>
<!-- sourcefile~pstruct_data.f90&#45;&gt;sourcefile~struct_def.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge20" class="edge">
<title>sourcefile~pstruct_data.f90&#45;&gt;sourcefile~struct_def.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M305.7017,-319.9569C286.5928,-307.2159 255.1746,-286.8085 227,-271 224.3578,-269.5175 221.5967,-268.0271 218.8055,-266.5618"/>
<polygon fill="#7fff00" stroke="#7fff00" points="220.3936,-263.4428 209.8965,-262.007 217.207,-269.6755 220.3936,-263.4428"/>
</g>
<!-- sourcefile~pstruct_data.f90&#45;&gt;sourcefile~precision_def.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge21" class="edge">
<title>sourcefile~pstruct_data.f90&#45;&gt;sourcefile~precision_def.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M273.745,-331.2758C236.7925,-329.6661 185.4804,-325.156 142,-313 121.1747,-307.1778 99.1878,-296.8469 82.2779,-287.8885"/>
<polygon fill="#7fff00" stroke="#7fff00" points="83.9033,-284.7884 73.4454,-283.0901 80.5616,-290.9393 83.9033,-284.7884"/>
</g>
<!-- sourcefile~common_param.f90&#45;&gt;sourcefile~precision_def.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge22" class="edge">
<title>sourcefile~common_param.f90&#45;&gt;sourcefile~precision_def.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M292.3273,-24.1131C253.0424,-40.6915 185.4196,-73.755 142,-120 104.5731,-159.8624 75.8388,-218.1587 62.0334,-249.3723"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="58.69,-248.286 57.933,-258.8538 65.1149,-251.0646 58.69,-248.286"/>
</g>
<!-- sourcefile~grid_param.f90&#45;&gt;sourcefile~struct_def.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge23" class="edge">
<title>sourcefile~grid_param.f90&#45;&gt;sourcefile~struct_def.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M323.5,-250C295.0255,-247.962 263.1858,-247.8075 237.1712,-248.231"/>
<polygon fill="#00ffff" stroke="#00ffff" points="237.0705,-244.7322 227.1409,-248.4271 237.2074,-251.7308 237.0705,-244.7322"/>
</g>
<!-- sourcefile~grid_param.f90&#45;&gt;sourcefile~precision_def.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge24" class="edge">
<title>sourcefile~grid_param.f90&#45;&gt;sourcefile~precision_def.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M443.2867,-251.7939C409.8066,-252.628 363.8421,-252.8874 323.5,-250"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M323.5,-250C315.4849,-249.4263 192.0282,-207.1898 184.5,-210"/>
</g>
<!-- sourcefile~mpi_part_interface.f90&#45;&gt;sourcefile~grid_param.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge27" class="edge">
<title>sourcefile~mpi_part_interface.f90&#45;&gt;sourcefile~grid_param.f90</title>
<path fill="none" stroke="#003fff" stroke-dasharray="5,2" d="M614.6386,-279.9645C593.6509,-274.8985 569.1134,-268.9757 547.421,-263.7396"/>
<polygon fill="#003fff" stroke="#003fff" points="548.2195,-260.3318 537.6774,-261.3877 546.577,-267.1364 548.2195,-260.3318"/>
</g>
<!-- sourcefile~array_alloc.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_node14" class="node">
<title>sourcefile~array_alloc.f90</title>
<g id="a_sourcefile~~window.f90~~EfferentGraph_node14"><a xlink:href=".././sourcefile/array_alloc.f90.html" xlink:title="array_alloc.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="536.5,-384 444.5,-384 444.5,-360 536.5,-360 536.5,-384"/>
<text text-anchor="middle" x="490.5" y="-369.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">array_alloc.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mpi_part_interface.f90&#45;&gt;sourcefile~array_alloc.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge28" class="edge">
<title>sourcefile~mpi_part_interface.f90&#45;&gt;sourcefile~array_alloc.f90</title>
<path fill="none" stroke="#003fff" stroke-dasharray="5,2" d="M643.0881,-304.1978C622.4284,-315.7198 590.0918,-333.1094 561,-346 552.8542,-349.6094 544.037,-353.1435 535.4864,-356.3855"/>
<polygon fill="#003fff" stroke="#003fff" points="534.1516,-353.1476 525.9958,-359.9102 536.5887,-359.7096 534.1516,-353.1476"/>
</g>
<!-- sourcefile~mpi_part_interface.f90&#45;&gt;sourcefile~parallel.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge26" class="edge">
<title>sourcefile~mpi_part_interface.f90&#45;&gt;sourcefile~parallel.f90</title>
<path fill="none" stroke="#003fff" stroke-dasharray="5,2" d="M597.7247,-292C578.0854,-292 556.9906,-292 538.7513,-292"/>
<polygon fill="#003fff" stroke="#003fff" points="538.6582,-288.5001 528.6581,-292 538.6581,-295.5001 538.6582,-288.5001"/>
</g>
<!-- sourcefile~mpi_part_interface.f90&#45;&gt;sourcefile~code_util.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge25" class="edge">
<title>sourcefile~mpi_part_interface.f90&#45;&gt;sourcefile~code_util.f90</title>
<path fill="none" stroke="#003fff" stroke-dasharray="5,2" d="M656.9346,-304.0205C641.9161,-326.6023 605.8798,-374.7307 561,-393 451.861,-437.4273 309.733,-418.2929 235.1959,-403.0846"/>
<polygon fill="#003fff" stroke="#003fff" points="235.6434,-399.6023 225.1375,-400.9718 234.2044,-406.4528 235.6434,-399.6023"/>
</g>
<!-- sourcefile~fstruct_data.f90&#45;&gt;sourcefile~precision_def.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge29" class="edge">
<title>sourcefile~fstruct_data.f90&#45;&gt;sourcefile~precision_def.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M275.3811,-201.8667C247.917,-199.1979 213.3254,-199.2399 184.5,-210"/>
</g>
<!-- sourcefile~mpi_field_interface.f90&#45;&gt;sourcefile~pstruct_data.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge31" class="edge">
<title>sourcefile~mpi_field_interface.f90&#45;&gt;sourcefile~pstruct_data.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M629.5806,-253.0371C618.5847,-257.715 606.7704,-263.7225 597,-271 577.283,-285.6862 582.9085,-301.8437 561,-313 505.6521,-341.1845 433.5241,-342.8427 383.3421,-339.3959"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="383.5361,-335.9006 373.2956,-338.6179 382.9955,-342.8797 383.5361,-335.9006"/>
</g>
<!-- sourcefile~mpi_field_interface.f90&#45;&gt;sourcefile~grid_param.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge32" class="edge">
<title>sourcefile~mpi_field_interface.f90&#45;&gt;sourcefile~grid_param.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M596.7288,-244.5054C580.5256,-245.3435 563.3857,-246.23 547.7127,-247.0407"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="547.4555,-243.5493 537.6496,-247.5612 547.8171,-250.5399 547.4555,-243.5493"/>
</g>
<!-- sourcefile~mpi_field_interface.f90&#45;&gt;sourcefile~fstruct_data.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge30" class="edge">
<title>sourcefile~mpi_field_interface.f90&#45;&gt;sourcefile~fstruct_data.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M647.1233,-228.9955C616.7955,-209.2482 551.594,-172.0679 490.5,-172"/>
</g>
<!-- sourcefile~mpi_field_interface.f90&#45;&gt;sourcefile~parallel.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge33" class="edge">
<title>sourcefile~mpi_field_interface.f90&#45;&gt;sourcefile~parallel.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M623.2644,-253.0863C597.8675,-260.5302 565.1969,-270.1061 538.6202,-277.8958"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="537.3725,-274.6142 528.7607,-280.7857 539.3415,-281.3316 537.3725,-274.6142"/>
</g>
<!-- sourcefile~struct_def.f90&#45;&gt;sourcefile~precision_def.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge34" class="edge">
<title>sourcefile~struct_def.f90&#45;&gt;sourcefile~precision_def.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M141.8057,-256.8181C133.6126,-258.1265 124.8725,-259.5223 116.1921,-260.9085"/>
<polygon fill="#ff0000" stroke="#ff0000" points="115.3885,-257.4924 106.0656,-262.5256 116.4925,-264.4048 115.3885,-257.4924"/>
</g>
<!-- sourcefile~ionz_data.f90&#45;&gt;sourcefile~precision_def.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge35" class="edge">
<title>sourcefile~ionz_data.f90&#45;&gt;sourcefile~precision_def.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M171.8912,-153.4649C148.9559,-176.1386 100.2534,-224.2856 72.8318,-251.3944"/>
<polygon fill="#ffbf00" stroke="#ffbf00" points="70.0295,-249.2431 65.3786,-258.7626 74.9508,-254.2212 70.0295,-249.2431"/>
</g>
<!-- sourcefile~phys_param.f90&#45;&gt;sourcefile~precision_def.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge36" class="edge">
<title>sourcefile~phys_param.f90&#45;&gt;sourcefile~precision_def.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M292.1627,-142.0835C282.6124,-146.1315 272.2088,-150.9186 263,-156 225.9234,-176.4588 224.1727,-195.1908 184.5,-210"/>
</g>
<!-- sourcefile~control_bunch_input.f90&#45;&gt;sourcefile~precision_def.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge37" class="edge">
<title>sourcefile~control_bunch_input.f90&#45;&gt;sourcefile~precision_def.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M419.9806,-82.6751C372.5413,-79.2364 310.2725,-81.7969 263,-109 238.3191,-123.2027 244.4742,-139.5163 227,-162 209.5146,-184.4981 211.1947,-200.0353 184.5,-210"/>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M184.5,-210C149.788,-222.7602 111.5964,-240.9713 85.3582,-254.1706"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="83.5944,-251.1408 76.2609,-258.7874 86.7622,-257.383 83.5944,-251.1408"/>
</g>
<!-- sourcefile~array_alloc.f90&#45;&gt;sourcefile~pstruct_data.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge39" class="edge">
<title>sourcefile~array_alloc.f90&#45;&gt;sourcefile~pstruct_data.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M444.4244,-360.9639C425.4247,-356.4131 403.1655,-351.0815 382.9594,-346.2418"/>
<polygon fill="#00ffff" stroke="#00ffff" points="383.7686,-342.8367 373.2283,-343.911 382.138,-349.6441 383.7686,-342.8367"/>
</g>
<!-- sourcefile~array_alloc.f90&#45;&gt;sourcefile~fstruct_data.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge38" class="edge">
<title>sourcefile~array_alloc.f90&#45;&gt;sourcefile~fstruct_data.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M471.7557,-359.7909C456.2914,-348.9708 434.5958,-331.9763 420,-313 396.9677,-283.0555 411.1297,-262.2896 384,-236 380.4902,-232.5989 376.4655,-229.6087 372.1958,-226.9869"/>
<polygon fill="#00ffff" stroke="#00ffff" points="373.6351,-223.7864 363.1738,-222.1094 370.306,-229.9441 373.6351,-223.7864"/>
</g>
<!-- sourcefile~parallel.f90&#45;&gt;sourcefile~util.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge42" class="edge">
<title>sourcefile~parallel.f90&#45;&gt;sourcefile~util.f90</title>
<path fill="none" stroke="#003fff" stroke-dasharray="5,2" d="M475.2694,-304.0036C460.7294,-315.6342 438.3768,-333.9656 420,-351 391.5621,-377.3605 360.5856,-409.8772 341.6,-430.282"/>
<polygon fill="#003fff" stroke="#003fff" points="338.9341,-428.0096 334.7072,-437.7248 344.07,-432.766 338.9341,-428.0096"/>
</g>
<!-- sourcefile~parallel.f90&#45;&gt;sourcefile~common_param.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge41" class="edge">
<title>sourcefile~parallel.f90&#45;&gt;sourcefile~common_param.f90</title>
<path fill="none" stroke="#003fff" stroke-dasharray="5,2" d="M452.4666,-288.2499C440.6106,-285.2745 428.4439,-280.0643 420,-271 369.7258,-217.0323 411.9165,-177.2691 384,-109 372.3917,-80.6121 352.7537,-51.1524 339.0094,-32.2583"/>
<polygon fill="#003fff" stroke="#003fff" points="341.7451,-30.0715 332.978,-24.1227 336.1219,-34.2403 341.7451,-30.0715"/>
</g>
<!-- sourcefile~mpi_var.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_node18" class="node">
<title>sourcefile~mpi_var.f90</title>
<g id="a_sourcefile~~window.f90~~EfferentGraph_node18"><a xlink:href=".././sourcefile/mpi_var.f90.html" xlink:title="mpi_var.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="222,-304 147,-304 147,-280 222,-280 222,-304"/>
<text text-anchor="middle" x="184.5" y="-289.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mpi_var.f90</text>
</a>
</g>
</g>
<!-- sourcefile~parallel.f90&#45;&gt;sourcefile~mpi_var.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge40" class="edge">
<title>sourcefile~parallel.f90&#45;&gt;sourcefile~mpi_var.f90</title>
<path fill="none" stroke="#003fff" stroke-dasharray="5,2" d="M452.3636,-292C396.6297,-292 292.9745,-292 232.2467,-292"/>
<polygon fill="#003fff" stroke="#003fff" points="232.1558,-288.5001 222.1558,-292 232.1557,-295.5001 232.1558,-288.5001"/>
</g>
<!-- sourcefile~code_util.f90&#45;&gt;sourcefile~precision_def.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge43" class="edge">
<title>sourcefile~code_util.f90&#45;&gt;sourcefile~precision_def.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M170.9225,-378.6099C147.8684,-357.572 100.9307,-314.7391 73.7406,-289.9268"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="76.0538,-287.2994 66.3078,-283.144 71.3353,-292.4701 76.0538,-287.2994"/>
</g>
<!-- sourcefile~mpi_var.f90&#45;&gt;sourcefile~precision_def.f90 -->
<g id="sourcefile~~window.f90~~EfferentGraph_edge44" class="edge">
<title>sourcefile~mpi_var.f90&#45;&gt;sourcefile~precision_def.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M146.8174,-285.9822C137.2701,-284.4576 126.7508,-282.7777 116.3135,-281.1109"/>
<polygon fill="#ff0000" stroke="#ff0000" points="116.793,-277.6432 106.3661,-279.5223 115.689,-284.5556 116.793,-277.6432"/>
</g>
</g>
</svg>
</div><script>var pansourcefilewindowf90EfferentGraph = svgPanZoom('#sourcefilewindowf90EfferentGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="202pt" height="32pt"
 viewBox="0.00 0.00 201.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 197.5,-28 197.5,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="71,-24 0,-24 0,0 71,0 71,-24"/>
<text text-anchor="middle" x="35.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="193.5,-24 89.5,-24 89.5,0 193.5,0 193.5,-24"/>
<text text-anchor="middle" x="141.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
    
      
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Files dependent on this one</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~window.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefilewindowf90AfferentGraph" width="365pt" height="74pt"
 viewBox="0.00 0.00 365.00 74.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~window.f90~~AfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 70)">
<title>sourcefile~~window.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-70 361,-70 361,4 -4,4"/>
<!-- sourcefile~window.f90 -->
<g id="sourcefile~~window.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~window.f90</title>
<polygon fill="none" stroke="#000000" points="72,-45 0,-45 0,-21 72,-21 72,-45"/>
<text text-anchor="middle" x="36" y="-30.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">window.f90</text>
</g>
<!-- sourcefile~pic_evolve_in_time.f90 -->
<g id="sourcefile~~window.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~pic_evolve_in_time.f90</title>
<g id="a_sourcefile~~window.f90~~AfferentGraph_node2"><a xlink:href=".././sourcefile/pic_evolve_in_time.f90.html" xlink:title="pic_evolve_in_time.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="243,-66 110,-66 110,-42 243,-42 243,-66"/>
<text text-anchor="middle" x="176.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pic_evolve_in_time.f90</text>
</a>
</g>
</g>
<!-- sourcefile~pic_evolve_in_time.f90&#45;&gt;sourcefile~window.f90 -->
<g id="sourcefile~~window.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~pic_evolve_in_time.f90&#45;&gt;sourcefile~window.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M109.9531,-44.0535C100.5729,-42.6515 91.1044,-41.2362 82.2191,-39.9082"/>
<polygon fill="#ff0000" stroke="#ff0000" points="82.5042,-36.412 72.0967,-38.3952 81.4694,-43.3351 82.5042,-36.412"/>
</g>
<!-- sourcefile~env_evolve_in_time.f90 -->
<g id="sourcefile~~window.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~env_evolve_in_time.f90</title>
<g id="a_sourcefile~~window.f90~~AfferentGraph_node3"><a xlink:href=".././sourcefile/env_evolve_in_time.f90.html" xlink:title="env_evolve_in_time.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="245,-24 108,-24 108,0 245,0 245,-24"/>
<text text-anchor="middle" x="176.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">env_evolve_in_time.f90</text>
</a>
</g>
</g>
<!-- sourcefile~env_evolve_in_time.f90&#45;&gt;sourcefile~window.f90 -->
<g id="sourcefile~~window.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~env_evolve_in_time.f90&#45;&gt;sourcefile~window.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M107.8964,-22.2539C99.1782,-23.557 90.4261,-24.8651 82.1778,-26.098"/>
<polygon fill="#ff0000" stroke="#ff0000" points="81.4124,-22.6734 72.0397,-27.6133 82.4472,-29.5965 81.4124,-22.6734"/>
</g>
<!-- sourcefile~aladyn.f90 -->
<g id="sourcefile~~window.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~aladyn.f90</title>
<g id="a_sourcefile~~window.f90~~AfferentGraph_node4"><a xlink:href=".././sourcefile/aladyn.f90.html" xlink:title="ALaDyn.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="357,-45 281,-45 281,-21 357,-21 357,-45"/>
<text text-anchor="middle" x="319" y="-30.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ALaDyn.F90</text>
</a>
</g>
</g>
<!-- sourcefile~aladyn.f90&#45;&gt;sourcefile~pic_evolve_in_time.f90 -->
<g id="sourcefile~~window.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~aladyn.f90&#45;&gt;sourcefile~pic_evolve_in_time.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M280.8126,-38.6276C272.1852,-39.899 262.7268,-41.2929 253.1375,-42.7061"/>
<polygon fill="#ff0000" stroke="#ff0000" points="252.5092,-39.2608 243.1264,-44.1814 253.5298,-46.186 252.5092,-39.2608"/>
</g>
<!-- sourcefile~aladyn.f90&#45;&gt;sourcefile~env_evolve_in_time.f90 -->
<g id="sourcefile~~window.f90~~AfferentGraph_edge4" class="edge">
<title>sourcefile~aladyn.f90&#45;&gt;sourcefile~env_evolve_in_time.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M280.8126,-27.3724C272.7861,-26.1895 264.0404,-24.9007 255.1391,-23.5889"/>
<polygon fill="#00ffff" stroke="#00ffff" points="255.4567,-20.098 245.0533,-22.1026 254.4361,-27.0232 255.4567,-20.098"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="202pt" height="32pt"
 viewBox="0.00 0.00 201.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 197.5,-28 197.5,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="71,-24 0,-24 0,0 71,0 71,-24"/>
<text text-anchor="middle" x="35.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="193.5,-24 89.5,-24 89.5,0 193.5,0 193.5,-24"/>
<text text-anchor="middle" x="141.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
      
      <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/window.html">window</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/window.f90.html#src">window.f90</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="c">!*****************************************************************************************************!</span>
<a name="ln-2"></a><span class="c">!                            Copyright 2008-2020  The ALaDyn Collaboration                            !</span>
<a name="ln-3"></a><span class="c">!*****************************************************************************************************!</span>
<a name="ln-4"></a>
<a name="ln-5"></a><span class="c">!*****************************************************************************************************!</span>
<a name="ln-6"></a><span class="c">!  This file is part of ALaDyn.                                                                       !</span>
<a name="ln-7"></a><span class="c">!                                                                                                     !</span>
<a name="ln-8"></a><span class="c">!  ALaDyn is free software: you can redistribute it and/or modify                                     !</span>
<a name="ln-9"></a><span class="c">!  it under the terms of the GNU General Public License as published by                               !</span>
<a name="ln-10"></a><span class="c">!  the Free Software Foundation, either version 3 of the License, or                                  !</span>
<a name="ln-11"></a><span class="c">!  (at your option) any later version.                                                                !</span>
<a name="ln-12"></a><span class="c">!                                                                                                     !</span>
<a name="ln-13"></a><span class="c">!  ALaDyn is distributed in the hope that it will be useful,                                          !</span>
<a name="ln-14"></a><span class="c">!  but WITHOUT ANY WARRANTY; without even the implied warranty of                                     !</span>
<a name="ln-15"></a><span class="c">!  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the                                      !</span>
<a name="ln-16"></a><span class="c">!  GNU General Public License for more details.                                                       !</span>
<a name="ln-17"></a><span class="c">!                                                                                                     !</span>
<a name="ln-18"></a><span class="c">!  You should have received a copy of the GNU General Public License                                  !</span>
<a name="ln-19"></a><span class="c">!  along with ALaDyn.  If not, see &lt;http://www.gnu.org/licenses/&gt;.                                    !</span>
<a name="ln-20"></a><span class="c">!*****************************************************************************************************!</span>
<a name="ln-21"></a>
<a name="ln-22"></a> <span class="k">module </span><span class="n">window</span>
<a name="ln-23"></a>  <span class="k">use </span><span class="n">util</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">init_random_seed</span><span class="p">,</span> <span class="n">gasdev</span>
<a name="ln-24"></a>  <span class="k">use </span><span class="n">pstruct_data</span>
<a name="ln-25"></a>  <span class="k">use </span><span class="n">fstruct_data</span>
<a name="ln-26"></a>  <span class="k">use </span><span class="n">common_param</span>
<a name="ln-27"></a>  <span class="k">use </span><span class="n">grid_param</span>
<a name="ln-28"></a>  <span class="k">use </span><span class="n">mpi_field_interface</span>
<a name="ln-29"></a>  <span class="k">use </span><span class="n">mpi_part_interface</span>
<a name="ln-30"></a>  <span class="k">use </span><span class="n">run_data_info</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">part_numbers</span>
<a name="ln-31"></a>
<a name="ln-32"></a>  <span class="k">implicit none</span>
<a name="ln-33"></a>  <span class="c">!===============================</span>
<a name="ln-34"></a>  <span class="c">! MOVING WINDOW SECTION</span>
<a name="ln-35"></a>  <span class="c">!=============================</span>
<a name="ln-36"></a> <span class="k">contains</span>
<a name="ln-37"></a>
<a name="ln-38"></a><span class="k">  subroutine </span><span class="n">add_particles</span><span class="p">(</span><span class="n">np</span><span class="p">,</span> <span class="n">i1</span><span class="p">,</span> <span class="n">i2</span><span class="p">,</span> <span class="n">ic</span><span class="p">)</span>
<a name="ln-39"></a>   <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">np</span><span class="p">,</span> <span class="n">i1</span><span class="p">,</span> <span class="n">i2</span><span class="p">,</span> <span class="n">ic</span>
<a name="ln-40"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">n</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">j2</span><span class="p">,</span> <span class="n">k2</span>
<a name="ln-41"></a>   <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">u</span><span class="p">,</span> <span class="n">tmp0</span><span class="p">,</span> <span class="n">whz</span>
<a name="ln-42"></a>
<a name="ln-43"></a>   <span class="n">tmp0</span> <span class="o">=</span> <span class="n">t0_pl</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span>
<a name="ln-44"></a>   <span class="n">n</span> <span class="o">=</span> <span class="n">np</span>
<a name="ln-45"></a>   <span class="n">charge</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">unit_charge</span><span class="p">(</span><span class="n">ic</span><span class="p">),</span> <span class="n">hp_int</span><span class="p">)</span>
<a name="ln-46"></a>   <span class="n">part_ind</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-47"></a>   <span class="n">k2</span> <span class="o">=</span> <span class="n">loc_nptz</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span>
<a name="ln-48"></a>   <span class="n">j2</span> <span class="o">=</span> <span class="n">loc_npty</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span>
<a name="ln-49"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">curr_ndim</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-50"></a><span class="k">    do </span><span class="n">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k2</span>
<a name="ln-51"></a>     <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j2</span>
<a name="ln-52"></a>      <span class="k">do </span><span class="n">ix</span> <span class="o">=</span> <span class="n">i1</span><span class="p">,</span> <span class="n">i2</span>
<a name="ln-53"></a>       <span class="n">whz</span> <span class="o">=</span> <span class="n">wghpt</span><span class="p">(</span><span class="n">ix</span><span class="p">,</span> <span class="n">ic</span><span class="p">)</span><span class="o">*</span><span class="n">loc_wghyz</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">ic</span><span class="p">)</span>
<a name="ln-54"></a>       <span class="n">wgh</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">whz</span><span class="p">,</span> <span class="n">sp</span><span class="p">)</span>
<a name="ln-55"></a>       <span class="n">n</span> <span class="o">=</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-56"></a>       <span class="n">spec</span><span class="p">(</span><span class="n">ic</span><span class="p">)%</span><span class="n">part</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">xpt</span><span class="p">(</span><span class="n">ix</span><span class="p">,</span> <span class="n">ic</span><span class="p">)</span>
<a name="ln-57"></a>       <span class="n">spec</span><span class="p">(</span><span class="n">ic</span><span class="p">)%</span><span class="n">part</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">loc_ypt</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">ic</span><span class="p">)</span>
<a name="ln-58"></a>       <span class="n">spec</span><span class="p">(</span><span class="n">ic</span><span class="p">)%</span><span class="n">part</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">loc_zpt</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">ic</span><span class="p">)</span>
<a name="ln-59"></a>       <span class="n">spec</span><span class="p">(</span><span class="n">ic</span><span class="p">)%</span><span class="n">part</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="n">zero_dp</span>
<a name="ln-60"></a>       <span class="n">spec</span><span class="p">(</span><span class="n">ic</span><span class="p">)%</span><span class="n">part</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span> <span class="o">=</span> <span class="n">wgh_cmp</span>
<a name="ln-61"></a>      <span class="k">end do</span>
<a name="ln-62"></a><span class="k">     end do</span>
<a name="ln-63"></a><span class="k">    end do</span>
<a name="ln-64"></a><span class="k">   else</span>
<a name="ln-65"></a><span class="k">    do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j2</span>
<a name="ln-66"></a>     <span class="k">do </span><span class="n">ix</span> <span class="o">=</span> <span class="n">i1</span><span class="p">,</span> <span class="n">i2</span>
<a name="ln-67"></a>      <span class="n">wgh</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">loc_wghyz</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ic</span><span class="p">)</span><span class="o">*</span><span class="n">wghpt</span><span class="p">(</span><span class="n">ix</span><span class="p">,</span> <span class="n">ic</span><span class="p">),</span> <span class="n">sp</span><span class="p">)</span>
<a name="ln-68"></a>      <span class="n">n</span> <span class="o">=</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-69"></a>      <span class="n">spec</span><span class="p">(</span><span class="n">ic</span><span class="p">)%</span><span class="n">part</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">xpt</span><span class="p">(</span><span class="n">ix</span><span class="p">,</span> <span class="n">ic</span><span class="p">)</span>
<a name="ln-70"></a>      <span class="n">spec</span><span class="p">(</span><span class="n">ic</span><span class="p">)%</span><span class="n">part</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">loc_ypt</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">ic</span><span class="p">)</span>
<a name="ln-71"></a>      <span class="n">spec</span><span class="p">(</span><span class="n">ic</span><span class="p">)%</span><span class="n">part</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">zero_dp</span>
<a name="ln-72"></a>      <span class="n">spec</span><span class="p">(</span><span class="n">ic</span><span class="p">)%</span><span class="n">part</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">wgh_cmp</span>
<a name="ln-73"></a>     <span class="k">end do</span>
<a name="ln-74"></a><span class="k">    end do</span>
<a name="ln-75"></a><span class="k">   end if</span>
<a name="ln-76"></a><span class="k">   if</span> <span class="p">(</span><span class="n">tmp0</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-77"></a><span class="k">    </span><span class="n">n</span> <span class="o">=</span> <span class="n">np</span>
<a name="ln-78"></a>    <span class="k">call </span><span class="n">init_random_seed</span><span class="p">(</span><span class="n">mype</span><span class="p">)</span>
<a name="ln-79"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">curr_ndim</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-80"></a><span class="k">     do </span><span class="n">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k2</span>
<a name="ln-81"></a>      <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j2</span>
<a name="ln-82"></a>       <span class="k">do </span><span class="n">ix</span> <span class="o">=</span> <span class="n">i1</span><span class="p">,</span> <span class="n">i2</span>
<a name="ln-83"></a>        <span class="n">n</span> <span class="o">=</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-84"></a>        <span class="k">call </span><span class="n">gasdev</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
<a name="ln-85"></a>        <span class="n">spec</span><span class="p">(</span><span class="n">ic</span><span class="p">)%</span><span class="n">part</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">tmp0</span><span class="o">*</span><span class="n">u</span>
<a name="ln-86"></a>        <span class="n">spec</span><span class="p">(</span><span class="n">ic</span><span class="p">)%</span><span class="n">part</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">tmp0</span><span class="o">*</span><span class="n">u</span>
<a name="ln-87"></a>        <span class="n">spec</span><span class="p">(</span><span class="n">ic</span><span class="p">)%</span><span class="n">part</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="n">tmp0</span><span class="o">*</span><span class="n">u</span>
<a name="ln-88"></a>       <span class="k">end do</span>
<a name="ln-89"></a><span class="k">      end do</span>
<a name="ln-90"></a><span class="k">     end do</span>
<a name="ln-91"></a><span class="k">    else</span>
<a name="ln-92"></a><span class="k">     do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j2</span>
<a name="ln-93"></a>      <span class="k">do </span><span class="n">ix</span> <span class="o">=</span> <span class="n">i1</span><span class="p">,</span> <span class="n">i2</span>
<a name="ln-94"></a>       <span class="n">n</span> <span class="o">=</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-95"></a>       <span class="k">call </span><span class="n">gasdev</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
<a name="ln-96"></a>       <span class="n">spec</span><span class="p">(</span><span class="n">ic</span><span class="p">)%</span><span class="n">part</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">tmp0</span><span class="o">*</span><span class="n">u</span>
<a name="ln-97"></a>       <span class="k">call </span><span class="n">gasdev</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
<a name="ln-98"></a>       <span class="n">spec</span><span class="p">(</span><span class="n">ic</span><span class="p">)%</span><span class="n">part</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">tmp0</span><span class="o">*</span><span class="n">u</span>
<a name="ln-99"></a>      <span class="k">end do</span>
<a name="ln-100"></a><span class="k">     end do</span>
<a name="ln-101"></a><span class="k">    end if</span>
<a name="ln-102"></a><span class="k">   end if</span>
<a name="ln-103"></a><span class="k">  end subroutine</span>
<a name="ln-104"></a>  <span class="c">!---------------------------</span>
<a name="ln-105"></a>  <span class="k">subroutine </span><span class="n">particles_inject</span><span class="p">(</span><span class="n">xmx</span><span class="p">)</span>
<a name="ln-106"></a>   <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">xmx</span>
<a name="ln-107"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ic</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">npt_inj</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="n">np_old</span><span class="p">,</span> <span class="n">np_new</span>
<a name="ln-108"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i1</span><span class="p">,</span> <span class="n">i2</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">q</span>
<a name="ln-109"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">j2</span><span class="p">,</span> <span class="n">k2</span><span class="p">,</span> <span class="n">ndv</span>
<a name="ln-110"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span>
<a name="ln-111"></a>
<a name="ln-112"></a>   <span class="c">!========== inject particles from the right</span>
<a name="ln-113"></a>   <span class="c">!   xmx is the box xmax grid value at current time after window move</span>
<a name="ln-114"></a>   <span class="c">!   in Comoving frame xmax is fixed and particles are left advected</span>
<a name="ln-115"></a>   <span class="c">!=================================</span>
<a name="ln-116"></a>   <span class="c">!  nptx(ic) is the max particle index inside the computational box</span>
<a name="ln-117"></a>   <span class="c">!  nptx(ic) is updated in the same way both for moving window xmax</span>
<a name="ln-118"></a>   <span class="c">!  or for left-advect particles with fixed xmax</span>
<a name="ln-119"></a>   <span class="c">!===============================================</span>
<a name="ln-120"></a>
<a name="ln-121"></a>   <span class="n">ndv</span> <span class="o">=</span> <span class="n">nd2</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-122"></a>   <span class="k">do </span><span class="n">ic</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nsp</span>
<a name="ln-123"></a>    <span class="n">i1</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">nptx</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span>
<a name="ln-124"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">i1</span> <span class="o">&lt;=</span> <span class="n">sptx_max</span><span class="p">(</span><span class="n">ic</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-125"></a>     <span class="c">!while particle index is less then the max index</span>
<a name="ln-126"></a>     <span class="k">do </span><span class="n">ix</span> <span class="o">=</span> <span class="n">i1</span><span class="p">,</span> <span class="n">sptx_max</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span>
<a name="ln-127"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">xpt</span><span class="p">(</span><span class="n">ix</span><span class="p">,</span> <span class="n">ic</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">xmx</span><span class="p">)</span> <span class="k">exit</span>
<a name="ln-128"></a><span class="k">     end do</span>
<a name="ln-129"></a><span class="k">     </span><span class="n">i2</span> <span class="o">=</span> <span class="n">ix</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-130"></a>     <span class="k">if</span> <span class="p">(</span><span class="n">ix</span> <span class="o">==</span> <span class="n">sptx_max</span><span class="p">(</span><span class="n">ic</span><span class="p">))</span> <span class="n">i2</span> <span class="o">=</span> <span class="n">ix</span>
<a name="ln-131"></a>    <span class="k">else</span>
<a name="ln-132"></a><span class="k">     </span><span class="n">i2</span> <span class="o">=</span> <span class="n">i1</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-133"></a>    <span class="k">end if</span>
<a name="ln-134"></a><span class="k">    </span><span class="n">nptx</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span> <span class="o">=</span> <span class="n">i2</span>
<a name="ln-135"></a>    <span class="c">! endif</span>
<a name="ln-136"></a>    <span class="c">!==========================</span>
<a name="ln-137"></a>    <span class="c">! Partcles to be injected have index ix [i1,i2]</span>
<a name="ln-138"></a>    <span class="c">!============================</span>
<a name="ln-139"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">i2</span> <span class="o">&gt;</span> <span class="n">i1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-140"></a>     <span class="c">!==========================</span>
<a name="ln-141"></a>     <span class="n">npt_inj</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-142"></a>     <span class="c">!=========== injects particles with coordinates index i1&lt;= ix &lt;=i2</span>
<a name="ln-143"></a>     <span class="k">select case</span> <span class="p">(</span><span class="n">ndim</span><span class="p">)</span>
<a name="ln-144"></a>     <span class="k">case</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-145"></a>      <span class="k">do </span><span class="n">ix</span> <span class="o">=</span> <span class="n">i1</span><span class="p">,</span> <span class="n">i2</span>
<a name="ln-146"></a>       <span class="n">npt_inj</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span> <span class="o">=</span> <span class="n">npt_inj</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-147"></a>      <span class="k">end do</span>
<a name="ln-148"></a><span class="k">     case</span> <span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-149"></a>      <span class="n">j2</span> <span class="o">=</span> <span class="n">loc_npty</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span>
<a name="ln-150"></a>      <span class="k">do </span><span class="n">ix</span> <span class="o">=</span> <span class="n">i1</span><span class="p">,</span> <span class="n">i2</span>
<a name="ln-151"></a>       <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j2</span>
<a name="ln-152"></a>        <span class="n">npt_inj</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span> <span class="o">=</span> <span class="n">npt_inj</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-153"></a>       <span class="k">end do</span>
<a name="ln-154"></a><span class="k">      end do</span>
<a name="ln-155"></a><span class="k">     case</span> <span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-156"></a>      <span class="n">k2</span> <span class="o">=</span> <span class="n">loc_nptz</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span>
<a name="ln-157"></a>      <span class="n">j2</span> <span class="o">=</span> <span class="n">loc_npty</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span>
<a name="ln-158"></a>      <span class="k">do </span><span class="n">ix</span> <span class="o">=</span> <span class="n">i1</span><span class="p">,</span> <span class="n">i2</span>
<a name="ln-159"></a>       <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k2</span>
<a name="ln-160"></a>        <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j2</span>
<a name="ln-161"></a>         <span class="n">npt_inj</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span> <span class="o">=</span> <span class="n">npt_inj</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-162"></a>        <span class="k">end do</span>
<a name="ln-163"></a><span class="k">       end do</span>
<a name="ln-164"></a><span class="k">      end do</span>
<a name="ln-165"></a><span class="k">     end select</span>
<a name="ln-166"></a><span class="k">     </span><span class="n">np_new</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-167"></a>     <span class="n">np_old</span> <span class="o">=</span> <span class="n">loc_npart</span><span class="p">(</span><span class="n">imody</span><span class="p">,</span> <span class="n">imodz</span><span class="p">,</span> <span class="n">imodx</span><span class="p">,</span> <span class="n">ic</span><span class="p">)</span>
<a name="ln-168"></a>     <span class="n">np_new</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">np_old</span> <span class="o">+</span> <span class="n">npt_inj</span><span class="p">(</span><span class="n">ic</span><span class="p">),</span> <span class="n">np_new</span><span class="p">)</span>
<a name="ln-169"></a>     <span class="k">call </span><span class="n">v_realloc</span><span class="p">(</span><span class="n">ebfp</span><span class="p">,</span> <span class="n">np_new</span><span class="p">,</span> <span class="n">ndv</span><span class="p">)</span>
<a name="ln-170"></a>     <span class="c">!=========================</span>
<a name="ln-171"></a>     <span class="k">if</span> <span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">spec</span><span class="p">(</span><span class="n">ic</span><span class="p">)%</span><span class="n">part</span><span class="p">,</span> <span class="n">ic</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">np_new</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-172"></a><span class="k">      </span><span class="n">ebfp</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">np_old</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">ndv</span><span class="p">)</span> <span class="o">=</span> <span class="n">spec</span><span class="p">(</span><span class="n">ic</span><span class="p">)%</span><span class="n">part</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">np_old</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">ndv</span><span class="p">)</span>
<a name="ln-173"></a>      <span class="k">deallocate</span> <span class="p">(</span><span class="n">spec</span><span class="p">(</span><span class="n">ic</span><span class="p">)%</span><span class="n">part</span><span class="p">)</span>
<a name="ln-174"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">spec</span><span class="p">(</span><span class="n">ic</span><span class="p">)%</span><span class="n">part</span><span class="p">(</span><span class="n">np_new</span><span class="p">,</span> <span class="n">ndv</span><span class="p">))</span>
<a name="ln-175"></a>      <span class="n">spec</span><span class="p">(</span><span class="n">ic</span><span class="p">)%</span><span class="n">part</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">np_old</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">ndv</span><span class="p">)</span> <span class="o">=</span> <span class="n">ebfp</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">np_old</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">ndv</span><span class="p">)</span>
<a name="ln-176"></a>     <span class="k">end if</span>
<a name="ln-177"></a><span class="k">     </span><span class="n">q</span> <span class="o">=</span> <span class="n">np_old</span>
<a name="ln-178"></a>     <span class="k">call </span><span class="n">add_particles</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">i1</span><span class="p">,</span> <span class="n">i2</span><span class="p">,</span> <span class="n">ic</span><span class="p">)</span>
<a name="ln-179"></a>     <span class="n">loc_npart</span><span class="p">(</span><span class="n">imody</span><span class="p">,</span> <span class="n">imodz</span><span class="p">,</span> <span class="n">imodx</span><span class="p">,</span> <span class="n">ic</span><span class="p">)</span> <span class="o">=</span> <span class="n">np_new</span>
<a name="ln-180"></a>    <span class="k">end if</span>
<a name="ln-181"></a><span class="k">   end do</span>
<a name="ln-182"></a>   <span class="c">!=======================</span>
<a name="ln-183"></a>  <span class="k">end subroutine</span>
<a name="ln-184"></a>  <span class="c">!=======================</span>
<a name="ln-185"></a>  <span class="k">subroutine </span><span class="n">reset_loc_xgrid</span>
<a name="ln-186"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">,</span> <span class="n">ip</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">ii</span><span class="p">,</span> <span class="n">n_loc</span>
<a name="ln-187"></a>
<a name="ln-188"></a>   <span class="n">p</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-189"></a>   <span class="n">n_loc</span> <span class="o">=</span> <span class="n">loc_xgrid</span><span class="p">(</span><span class="n">p</span><span class="p">)%</span><span class="n">ng</span>
<a name="ln-190"></a>   <span class="n">loc_xg</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">dx</span>
<a name="ln-191"></a>   <span class="n">loc_xg</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="o">=</span> <span class="n">xh</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">dx</span>
<a name="ln-192"></a>   <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n_loc</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-193"></a>    <span class="n">loc_xg</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-194"></a>    <span class="n">loc_xg</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="o">=</span> <span class="n">xh</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-195"></a>   <span class="k">end do</span>
<a name="ln-196"></a><span class="k">   </span><span class="n">ip</span> <span class="o">=</span> <span class="n">loc_xgrid</span><span class="p">(</span><span class="mi">0</span><span class="p">)%</span><span class="n">ng</span>
<a name="ln-197"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">npe_xloc</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-198"></a><span class="k">    do </span><span class="n">p</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">npe_xloc</span> <span class="o">-</span> <span class="mi">2</span>
<a name="ln-199"></a>     <span class="n">n_loc</span> <span class="o">=</span> <span class="n">loc_xgrid</span><span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)%</span><span class="n">ng</span>
<a name="ln-200"></a>     <span class="n">loc_xg</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="o">=</span> <span class="n">loc_xg</span><span class="p">(</span><span class="n">n_loc</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="n">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-201"></a>     <span class="n">n_loc</span> <span class="o">=</span> <span class="n">loc_xgrid</span><span class="p">(</span><span class="n">p</span><span class="p">)%</span><span class="n">ng</span>
<a name="ln-202"></a>     <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n_loc</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-203"></a>      <span class="n">ii</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="n">ip</span>
<a name="ln-204"></a>      <span class="n">loc_xg</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span>
<a name="ln-205"></a>      <span class="n">loc_xg</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="o">=</span> <span class="n">xh</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span>
<a name="ln-206"></a>     <span class="k">end do</span>
<a name="ln-207"></a><span class="k">     </span><span class="n">loc_xgrid</span><span class="p">(</span><span class="n">p</span><span class="p">)%</span><span class="n">gmin</span> <span class="o">=</span> <span class="n">loc_xgrid</span><span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)%</span><span class="n">gmax</span>
<a name="ln-208"></a>     <span class="n">ip</span> <span class="o">=</span> <span class="n">ip</span> <span class="o">+</span> <span class="n">n_loc</span>
<a name="ln-209"></a>     <span class="n">loc_xgrid</span><span class="p">(</span><span class="n">p</span><span class="p">)%</span><span class="n">gmax</span> <span class="o">=</span> <span class="n">x</span><span class="p">(</span><span class="n">ip</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-210"></a>    <span class="k">end do</span>
<a name="ln-211"></a><span class="k">   end if</span>
<a name="ln-212"></a><span class="k">   </span><span class="n">p</span> <span class="o">=</span> <span class="n">npe_xloc</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-213"></a>   <span class="n">n_loc</span> <span class="o">=</span> <span class="n">loc_xgrid</span><span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)%</span><span class="n">ng</span>
<a name="ln-214"></a>   <span class="n">loc_xg</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="o">=</span> <span class="n">loc_xg</span><span class="p">(</span><span class="n">n_loc</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="n">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-215"></a>   <span class="n">n_loc</span> <span class="o">=</span> <span class="n">loc_xgrid</span><span class="p">(</span><span class="n">p</span><span class="p">)%</span><span class="n">ng</span>
<a name="ln-216"></a>   <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n_loc</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-217"></a>    <span class="n">ii</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="n">ip</span>
<a name="ln-218"></a>    <span class="n">loc_xg</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span>
<a name="ln-219"></a>    <span class="n">loc_xg</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="o">=</span> <span class="n">xh</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span>
<a name="ln-220"></a>   <span class="k">end do</span>
<a name="ln-221"></a><span class="k">   </span><span class="n">loc_xgrid</span><span class="p">(</span><span class="n">p</span><span class="p">)%</span><span class="n">gmin</span> <span class="o">=</span> <span class="n">loc_xgrid</span><span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)%</span><span class="n">gmax</span>
<a name="ln-222"></a>   <span class="n">ip</span> <span class="o">=</span> <span class="n">ip</span> <span class="o">+</span> <span class="n">n_loc</span>
<a name="ln-223"></a>   <span class="n">loc_xgrid</span><span class="p">(</span><span class="n">p</span><span class="p">)%</span><span class="n">gmax</span> <span class="o">=</span> <span class="n">x</span><span class="p">(</span><span class="n">ip</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-224"></a>  <span class="k">end subroutine</span>
<a name="ln-225"></a>  <span class="c">!========================================</span>
<a name="ln-226"></a>  <span class="k">subroutine </span><span class="n">comoving_coordinate</span><span class="p">(</span><span class="n">vb</span><span class="p">,</span> <span class="n">w_nst</span><span class="p">,</span> <span class="n">loc_it</span><span class="p">)</span>
<a name="ln-227"></a>   <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vb</span>
<a name="ln-228"></a>   <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">w_nst</span><span class="p">,</span> <span class="n">loc_it</span>
<a name="ln-229"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span><span class="p">,</span> <span class="n">ic</span><span class="p">,</span> <span class="n">nshx</span>
<a name="ln-230"></a>   <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dt_tot</span><span class="p">,</span> <span class="n">dt_step</span>
<a name="ln-231"></a>   <span class="kt">logical</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">mw</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-232"></a>   <span class="c">!======================</span>
<a name="ln-233"></a>   <span class="c">! In comoving x-coordinate the</span>
<a name="ln-234"></a>   <span class="c">! [xmin &lt;= x &lt;= xmax] computational box is stationaty</span>
<a name="ln-235"></a>   <span class="c">! xi= (x-vb*t) =&gt; xw is left-advected</span>
<a name="ln-236"></a>   <span class="c">! fields are left-advected in the x-grid directely in the maxw. equations</span>
<a name="ln-237"></a>   <span class="c">! particles are left-advected:</span>
<a name="ln-238"></a>   <span class="c">! xp=xp-vb*dt inside the computational box is added in the eq. of motion and</span>
<a name="ln-239"></a>   <span class="c">! for moving coordinates at each w_nst steps</span>
<a name="ln-240"></a>   <span class="c">! xpt(ix,ic)=xpt(ix,ic)-vb*w_nst*dt outside the computational box</span>
<a name="ln-241"></a>   <span class="c">! then targ_in=targ_in -vb*w_nst*dt   targ_out=targ_out-vb*w_nst*dt</span>
<a name="ln-242"></a>   <span class="c">!</span>
<a name="ln-243"></a>   <span class="c">!==================</span>
<a name="ln-244"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">loc_it</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-245"></a><span class="k">   </span><span class="n">dt_step</span> <span class="o">=</span> <span class="n">dt_loc</span>
<a name="ln-246"></a>   <span class="n">dt_tot</span> <span class="o">=</span> <span class="mf">0.0</span>
<a name="ln-247"></a>   <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">w_nst</span>
<a name="ln-248"></a>    <span class="n">dt_tot</span> <span class="o">=</span> <span class="n">dt_tot</span> <span class="o">+</span> <span class="n">dt_step</span>
<a name="ln-249"></a>   <span class="k">end do</span>
<a name="ln-250"></a><span class="k">   </span><span class="n">nshx</span> <span class="o">=</span> <span class="nb">nint</span><span class="p">(</span><span class="n">dx_inv</span><span class="o">*</span><span class="n">dt_tot</span><span class="o">*</span><span class="n">vb</span><span class="p">)</span> <span class="c">!the number of grid points x-shift for each w_nst step</span>
<a name="ln-251"></a>   <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nx</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-252"></a>    <span class="n">xw</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">xw</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">-</span> <span class="n">dx</span><span class="o">*</span><span class="n">nshx</span> <span class="c">!moves backwards the grid xw</span>
<a name="ln-253"></a>   <span class="k">end do</span>
<a name="ln-254"></a><span class="k">   </span><span class="n">xw_max</span> <span class="o">=</span> <span class="n">xw_max</span> <span class="o">-</span> <span class="n">dx</span><span class="o">*</span><span class="n">nshx</span>
<a name="ln-255"></a>   <span class="n">xw_min</span> <span class="o">=</span> <span class="n">xw_min</span> <span class="o">-</span> <span class="n">dx</span><span class="o">*</span><span class="n">nshx</span>
<a name="ln-256"></a>   <span class="c">!======================== xw(i) grid used only for diagnostics purposes</span>
<a name="ln-257"></a>   <span class="n">targ_in</span> <span class="o">=</span> <span class="n">targ_in</span> <span class="o">-</span> <span class="n">vb</span><span class="o">*</span><span class="n">dt_tot</span>
<a name="ln-258"></a>   <span class="n">targ_end</span> <span class="o">=</span> <span class="n">targ_end</span> <span class="o">-</span> <span class="n">vb</span><span class="o">*</span><span class="n">dt_tot</span>
<a name="ln-259"></a>   <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">part</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-260"></a>   <span class="c">!===========================</span>
<a name="ln-261"></a>   <span class="k">do </span><span class="n">ic</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nsp</span> <span class="c">!left-advects all particles of the target outside the computational box</span>
<a name="ln-262"></a>    <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">nptx</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sptx_max</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span>
<a name="ln-263"></a>     <span class="n">xpt</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">ic</span><span class="p">)</span> <span class="o">=</span> <span class="n">xpt</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">ic</span><span class="p">)</span> <span class="o">-</span> <span class="n">vb</span><span class="o">*</span><span class="n">dt_tot</span>
<a name="ln-264"></a>    <span class="k">end do</span>
<a name="ln-265"></a><span class="k">   end do</span>
<a name="ln-266"></a>   <span class="c">!======================</span>
<a name="ln-267"></a>   <span class="k">call </span><span class="n">cell_part_dist</span><span class="p">(</span><span class="n">mw</span><span class="p">)</span> <span class="c">!particles are redistributes along the</span>
<a name="ln-268"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">pex1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-269"></a><span class="k">    if</span> <span class="p">(</span><span class="n">targ_in</span> <span class="o">&lt;=</span> <span class="n">xmax</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">targ_end</span> <span class="o">&gt;</span> <span class="n">xmax</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-270"></a><span class="k">     call </span><span class="n">particles_inject</span><span class="p">(</span><span class="n">xmax</span><span class="p">)</span>
<a name="ln-271"></a>    <span class="k">end if</span>
<a name="ln-272"></a><span class="k">   end if</span>
<a name="ln-273"></a><span class="k">  end subroutine</span>
<a name="ln-274"></a>  <span class="c">!====================================</span>
<a name="ln-275"></a>  <span class="k">subroutine </span><span class="n">lp_window_xshift</span><span class="p">(</span><span class="n">witr</span><span class="p">,</span> <span class="n">init_iter</span><span class="p">)</span>
<a name="ln-276"></a>   <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">witr</span><span class="p">,</span> <span class="n">init_iter</span>
<a name="ln-277"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i1</span><span class="p">,</span> <span class="n">n1p</span><span class="p">,</span> <span class="n">nc_env</span>
<a name="ln-278"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ix</span><span class="p">,</span> <span class="n">nshx</span><span class="p">,</span> <span class="n">wi2</span>
<a name="ln-279"></a>   <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">save</span> <span class="kd">::</span> <span class="n">xlapse</span><span class="p">,</span> <span class="n">dt_step</span>
<a name="ln-280"></a>   <span class="kt">integer</span><span class="p">,</span> <span class="k">save</span> <span class="kd">::</span> <span class="n">wi1</span>
<a name="ln-281"></a>   <span class="kt">logical</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">mw</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-282"></a>
<a name="ln-283"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">init_iter</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-284"></a><span class="k">    </span><span class="n">xlapse</span> <span class="o">=</span> <span class="mf">0.0</span>
<a name="ln-285"></a>    <span class="n">wi1</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-286"></a>    <span class="k">return</span>
<a name="ln-287"></a><span class="k">   end if</span>
<a name="ln-288"></a><span class="k">   </span><span class="n">dt_step</span> <span class="o">=</span> <span class="n">dt_loc</span>
<a name="ln-289"></a>   <span class="c">!==================</span>
<a name="ln-290"></a>   <span class="n">i1</span> <span class="o">=</span> <span class="n">loc_xgrid</span><span class="p">(</span><span class="n">imodx</span><span class="p">)%</span><span class="n">p_ind</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-291"></a>   <span class="n">n1p</span> <span class="o">=</span> <span class="n">loc_xgrid</span><span class="p">(</span><span class="n">imodx</span><span class="p">)%</span><span class="n">p_ind</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-292"></a>   <span class="c">!======================</span>
<a name="ln-293"></a>   <span class="n">xlapse</span> <span class="o">=</span> <span class="n">xlapse</span> <span class="o">+</span> <span class="n">w_speed</span><span class="o">*</span><span class="n">dt_step</span><span class="o">*</span><span class="n">witr</span>
<a name="ln-294"></a>   <span class="n">wi2</span> <span class="o">=</span> <span class="nb">nint</span><span class="p">(</span><span class="n">dx_inv</span><span class="o">*</span><span class="n">xlapse</span><span class="p">)</span>
<a name="ln-295"></a>   <span class="n">nshx</span> <span class="o">=</span> <span class="n">wi2</span> <span class="o">-</span> <span class="n">wi1</span>
<a name="ln-296"></a>   <span class="n">wi1</span> <span class="o">=</span> <span class="n">wi2</span>
<a name="ln-297"></a>   <span class="k">do </span><span class="n">ix</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nx</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-298"></a>    <span class="n">x</span><span class="p">(</span><span class="n">ix</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span><span class="p">(</span><span class="n">ix</span><span class="p">)</span> <span class="o">+</span> <span class="n">dx</span><span class="o">*</span><span class="n">nshx</span>
<a name="ln-299"></a>    <span class="n">xh</span><span class="p">(</span><span class="n">ix</span><span class="p">)</span> <span class="o">=</span> <span class="n">xh</span><span class="p">(</span><span class="n">ix</span><span class="p">)</span> <span class="o">+</span> <span class="n">dx</span><span class="o">*</span><span class="n">nshx</span>
<a name="ln-300"></a>   <span class="k">end do</span>
<a name="ln-301"></a><span class="k">   </span><span class="n">xmin</span> <span class="o">=</span> <span class="n">xmin</span> <span class="o">+</span> <span class="n">dx</span><span class="o">*</span><span class="n">nshx</span>
<a name="ln-302"></a>   <span class="n">xmax</span> <span class="o">=</span> <span class="n">xmax</span> <span class="o">+</span> <span class="n">dx</span><span class="o">*</span><span class="n">nshx</span>
<a name="ln-303"></a>   <span class="n">xp0_out</span> <span class="o">=</span> <span class="n">xp0_out</span> <span class="o">+</span> <span class="n">dx</span><span class="o">*</span><span class="n">nshx</span>
<a name="ln-304"></a>   <span class="n">xp1_out</span> <span class="o">=</span> <span class="n">xp1_out</span> <span class="o">+</span> <span class="n">dx</span><span class="o">*</span><span class="n">nshx</span>
<a name="ln-305"></a>   <span class="n">loc_xgrid</span><span class="p">(</span><span class="n">imodx</span><span class="p">)%</span><span class="n">gmin</span> <span class="o">=</span> <span class="n">loc_xgrid</span><span class="p">(</span><span class="n">imodx</span><span class="p">)%</span><span class="n">gmin</span> <span class="o">+</span> <span class="n">dx</span><span class="o">*</span><span class="n">nshx</span>
<a name="ln-306"></a>   <span class="n">loc_xgrid</span><span class="p">(</span><span class="n">imodx</span><span class="p">)%</span><span class="n">gmax</span> <span class="o">=</span> <span class="n">loc_xgrid</span><span class="p">(</span><span class="n">imodx</span><span class="p">)%</span><span class="n">gmax</span> <span class="o">+</span> <span class="n">dx</span><span class="o">*</span><span class="n">nshx</span>
<a name="ln-307"></a>   <span class="n">xmn</span> <span class="o">=</span> <span class="n">xmn</span> <span class="o">+</span> <span class="n">dx</span><span class="o">*</span><span class="n">nshx</span>
<a name="ln-308"></a>   <span class="n">wi2</span> <span class="o">=</span> <span class="n">n1p</span> <span class="o">-</span> <span class="n">nshx</span>
<a name="ln-309"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">wi2</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-310"></a><span class="k">    write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;(a37,3i6)&#39;</span><span class="p">)</span> <span class="s1">&#39;Error in window shifting for MPI proc&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-311"></a>     <span class="n">imody</span><span class="p">,</span> <span class="n">imodz</span><span class="p">,</span> <span class="n">imodx</span>
<a name="ln-312"></a>    <span class="n">ier</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-313"></a>    <span class="k">return</span>
<a name="ln-314"></a><span class="k">   end if</span>
<a name="ln-315"></a>   <span class="c">!===========================</span>
<a name="ln-316"></a>   <span class="k">call </span><span class="n">fields_left_xshift</span><span class="p">(</span><span class="n">ebf</span><span class="p">,</span> <span class="n">i1</span><span class="p">,</span> <span class="n">wi2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nfield</span><span class="p">,</span> <span class="n">nshx</span><span class="p">)</span>
<a name="ln-317"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">hybrid</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-318"></a><span class="k">    do </span><span class="n">ix</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nxf</span> <span class="o">-</span> <span class="n">nshx</span>
<a name="ln-319"></a>     <span class="n">fluid_x_profile</span><span class="p">(</span><span class="n">ix</span><span class="p">)</span> <span class="o">=</span> <span class="n">fluid_x_profile</span><span class="p">(</span><span class="n">ix</span> <span class="o">+</span> <span class="n">nshx</span><span class="p">)</span>
<a name="ln-320"></a>    <span class="k">end do</span>
<a name="ln-321"></a><span class="k">    </span><span class="n">nxf</span> <span class="o">=</span> <span class="n">nxf</span> <span class="o">-</span> <span class="n">nshx</span>
<a name="ln-322"></a>    <span class="k">call </span><span class="n">fluid_left_xshift</span><span class="p">(</span><span class="n">up</span><span class="p">,</span> <span class="n">fluid_x_profile</span><span class="p">,</span> <span class="n">fluid_yz_profile</span><span class="p">,</span> <span class="n">i1</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-323"></a>                           <span class="n">wi2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nfcomp</span><span class="p">,</span> <span class="n">nshx</span><span class="p">)</span>
<a name="ln-324"></a>    <span class="k">call </span><span class="n">fields_left_xshift</span><span class="p">(</span><span class="n">up0</span><span class="p">,</span> <span class="n">i1</span><span class="p">,</span> <span class="n">wi2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nfcomp</span><span class="p">,</span> <span class="n">nshx</span><span class="p">)</span>
<a name="ln-325"></a>   <span class="k">end if</span>
<a name="ln-326"></a><span class="k">   if</span> <span class="p">(</span><span class="n">envelope</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-327"></a><span class="k">    </span><span class="n">nc_env</span> <span class="o">=</span> <span class="n">size</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<a name="ln-328"></a>    <span class="k">call </span><span class="n">fields_left_xshift</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">i1</span><span class="p">,</span> <span class="n">wi2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nc_env</span><span class="p">,</span> <span class="n">nshx</span><span class="p">)</span>
<a name="ln-329"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">Two_color</span><span class="p">)</span> <span class="k">call </span><span class="n">fields_left_xshift</span><span class="p">(</span><span class="n">env1</span><span class="p">,</span> <span class="n">i1</span><span class="p">,</span> <span class="n">wi2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nc_env</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-330"></a>                                           <span class="n">nshx</span><span class="p">)</span>
<a name="ln-331"></a>   <span class="k">end if</span>
<a name="ln-332"></a>   <span class="c">!shifts fields data and inject right ebf(wi2+1:n1p) x-grid nshx new data</span>
<a name="ln-333"></a>   <span class="c">!===========================</span>
<a name="ln-334"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">part</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-335"></a><span class="k">    call </span><span class="n">cell_part_dist</span><span class="p">(</span><span class="n">mw</span><span class="p">)</span> <span class="c">!particles are redistributes along the</span>
<a name="ln-336"></a>    <span class="c">! right-shifted x-coordinate in MPI domains</span>
<a name="ln-337"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">pex1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-338"></a><span class="k">     if</span> <span class="p">(</span><span class="n">targ_in</span> <span class="o">&lt;=</span> <span class="n">xmax</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-339"></a><span class="k">      if</span> <span class="p">(</span><span class="n">targ_end</span> <span class="o">&gt;</span> <span class="n">xmax</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-340"></a><span class="k">       call </span><span class="n">particles_inject</span><span class="p">(</span><span class="n">xmax</span><span class="p">)</span>
<a name="ln-341"></a>      <span class="k">end if</span>
<a name="ln-342"></a><span class="k">     end if</span>
<a name="ln-343"></a><span class="k">    end if</span>
<a name="ln-344"></a><span class="k">    call </span><span class="n">part_numbers</span>
<a name="ln-345"></a>   <span class="k">end if</span>
<a name="ln-346"></a><span class="k">  end subroutine</span>
<a name="ln-347"></a>  <span class="c">!==============================</span>
<a name="ln-348"></a> <span class="k">end module</span>
</pre></div>

    </section>
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2020 <a rel="license" href="http://www.gnu.org/licenses/old-licenses/fdl-1.2.en.html">GNU Free Documentation License</a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
             on 2020-07-30 
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> ALaDyn was developed by The ALaDyn Collaboration</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>