<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="A High-Accuracy PIC Code for the Maxwell-Vlasov Equations">
    
    <meta name="author" content="The ALaDyn Collaboration" >
    <link rel="icon" href="../favicon.png">

    <title>util.f90 &ndash; ALaDyn</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">ALaDyn <small>3.0.1</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>Guide</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../program/aladyn.html">Program</a></li>
      
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/aladyn.html">Program</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>util.f90
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 1.4% of total for source files.">333 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/util.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
  
     <li class="active">util.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/util.html">util</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/util.f90.html#src">util.f90</a>
  </div>
</div>



</div>

    </div>
    <div class="col-md-9" id='text'>
      
      <br>
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">This file depends on</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~util.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefileutilf90EfferentGraph" width="321pt" height="52pt"
 viewBox="0.00 0.00 321.00 52.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~util.f90~~EfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 48)">
<title>sourcefile~~util.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-48 317,-48 317,4 -4,4"/>
<!-- sourcefile~util.f90 -->
<g id="sourcefile~~util.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~util.f90</title>
<polygon fill="none" stroke="#000000" points="313,-24 259,-24 259,0 313,0 313,-24"/>
<text text-anchor="middle" x="286" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">util.f90</text>
</g>
<!-- sourcefile~code_util.f90 -->
<g id="sourcefile~~util.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~code_util.f90</title>
<g id="a_sourcefile~~util.f90~~EfferentGraph_node2"><a xlink:href=".././sourcefile/code_util.f90.html" xlink:title="code_util.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="223,-44 142,-44 142,-20 223,-20 223,-44"/>
<text text-anchor="middle" x="182.5" y="-29.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">code_util.f90</text>
</a>
</g>
</g>
<!-- sourcefile~util.f90&#45;&gt;sourcefile~code_util.f90 -->
<g id="sourcefile~~util.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~util.f90&#45;&gt;sourcefile~code_util.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M258.8066,-17.2548C250.8867,-18.7852 241.9678,-20.5086 233.0942,-22.2233"/>
<polygon fill="#ff0000" stroke="#ff0000" points="232.3049,-18.811 223.1506,-24.1448 233.6331,-25.6839 232.3049,-18.811"/>
</g>
<!-- sourcefile~precision_def.f90 -->
<g id="sourcefile~~util.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~precision_def.f90</title>
<g id="a_sourcefile~~util.f90~~EfferentGraph_node3"><a xlink:href=".././sourcefile/precision_def.f90.html" xlink:title="precision_def.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="106,-24 0,-24 0,0 106,0 106,-24"/>
<text text-anchor="middle" x="53" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">precision_def.F90</text>
</a>
</g>
</g>
<!-- sourcefile~util.f90&#45;&gt;sourcefile~precision_def.f90 -->
<g id="sourcefile~~util.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~util.f90&#45;&gt;sourcefile~precision_def.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M258.7124,-11.4725C247.6304,-11.2828 234.7042,-11.0929 223,-11 187.0011,-10.7143 177.9994,-10.7978 142,-11 133.6703,-11.0468 124.9024,-11.1182 116.25,-11.2018"/>
<polygon fill="#ff0000" stroke="#ff0000" points="116.1429,-7.7026 106.1792,-11.3048 116.2145,-14.7023 116.1429,-7.7026"/>
</g>
<!-- sourcefile~code_util.f90&#45;&gt;sourcefile~precision_def.f90 -->
<g id="sourcefile~~util.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~code_util.f90&#45;&gt;sourcefile~precision_def.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M141.8807,-25.7267C133.777,-24.4752 125.0848,-23.1328 116.4242,-21.7952"/>
<polygon fill="#ff0000" stroke="#ff0000" points="116.7263,-18.3005 106.3092,-20.2331 115.6578,-25.2185 116.7263,-18.3005"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="202pt" height="32pt"
 viewBox="0.00 0.00 201.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 197.5,-28 197.5,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="71,-24 0,-24 0,0 71,0 71,-24"/>
<text text-anchor="middle" x="35.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="193.5,-24 89.5,-24 89.5,0 193.5,0 193.5,-24"/>
<text text-anchor="middle" x="141.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
    
      
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Files dependent on this one</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~util.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefileutilf90AfferentGraph" width="641pt" height="317pt"
 viewBox="0.00 0.00 641.00 316.55" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~util.f90~~AfferentGraph" class="graph" transform="scale(.6163 .6163) rotate(0) translate(4 509.5981)">
<title>sourcefile~~util.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-509.5981 1036,-509.5981 1036,4 -4,4"/>
<!-- sourcefile~util.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~util.f90</title>
<polygon fill="none" stroke="#000000" points="54,-277.2016 0,-277.2016 0,-253.2016 54,-253.2016 54,-277.2016"/>
<text text-anchor="middle" x="27" y="-262.8016" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">util.f90</text>
</g>
<!-- sourcefile~env_evolve_in_time.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~env_evolve_in_time.f90</title>
<g id="a_sourcefile~~util.f90~~AfferentGraph_node2"><a xlink:href=".././sourcefile/env_evolve_in_time.f90.html" xlink:title="env_evolve_in_time.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="920,-297.2016 783,-297.2016 783,-273.2016 920,-273.2016 920,-297.2016"/>
<text text-anchor="middle" x="851.5" y="-282.8016" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">env_evolve_in_time.f90</text>
</a>
</g>
</g>
<!-- sourcefile~env_evolve_in_time.f90&#45;&gt;sourcefile~util.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~env_evolve_in_time.f90&#45;&gt;sourcefile~util.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M845.1157,-297.3576C823.7248,-337.9868 755.4505,-466.8208 747,-472.2016 649.0805,-534.5521 602.5728,-489.4956 486.5,-491.2016"/>
</g>
<!-- sourcefile~window.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~window.f90</title>
<g id="a_sourcefile~~util.f90~~AfferentGraph_node3"><a xlink:href=".././sourcefile/window.f90.html" xlink:title="window.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="704.5,-257.2016 632.5,-257.2016 632.5,-233.2016 704.5,-233.2016 704.5,-257.2016"/>
<text text-anchor="middle" x="668.5" y="-242.8016" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">window.f90</text>
</a>
</g>
</g>
<!-- sourcefile~env_evolve_in_time.f90&#45;&gt;sourcefile~window.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge9" class="edge">
<title>sourcefile~env_evolve_in_time.f90&#45;&gt;sourcefile~window.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M796.594,-273.2003C770.4074,-267.4765 739.4332,-260.7062 714.5032,-255.257"/>
<polygon fill="#ffff00" stroke="#ffff00" points="715.088,-251.8023 704.5713,-253.0861 713.5932,-258.6408 715.088,-251.8023"/>
</g>
<!-- sourcefile~ionize.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_node7" class="node">
<title>sourcefile~ionize.f90</title>
<g id="a_sourcefile~~util.f90~~AfferentGraph_node7"><a xlink:href=".././sourcefile/ionize.f90.html" xlink:title="ionize.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="700.5,-177.2016 636.5,-177.2016 636.5,-153.2016 700.5,-153.2016 700.5,-177.2016"/>
<text text-anchor="middle" x="668.5" y="-162.8016" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ionize.f90</text>
</a>
</g>
</g>
<!-- sourcefile~env_evolve_in_time.f90&#45;&gt;sourcefile~ionize.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge23" class="edge">
<title>sourcefile~env_evolve_in_time.f90&#45;&gt;sourcefile~ionize.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M829.6326,-273.0347C816.0459,-265.3274 798.3123,-254.9988 783,-245.2016 751.3029,-224.9211 715.9624,-199.8329 693.0418,-183.217"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="695.044,-180.3454 684.8988,-177.2913 690.9251,-186.0054 695.044,-180.3454"/>
</g>
<!-- sourcefile~mpi_part_interface.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_node16" class="node">
<title>sourcefile~mpi_part_interface.f90</title>
<g id="a_sourcefile~~util.f90~~AfferentGraph_node16"><a xlink:href=".././sourcefile/mpi_part_interface.f90.html" xlink:title="mpi_part_interface.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="553,-297.2016 420,-297.2016 420,-273.2016 553,-273.2016 553,-297.2016"/>
<text text-anchor="middle" x="486.5" y="-282.8016" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mpi_part_interface.f90</text>
</a>
</g>
</g>
<!-- sourcefile~env_evolve_in_time.f90&#45;&gt;sourcefile~mpi_part_interface.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge38" class="edge">
<title>sourcefile~env_evolve_in_time.f90&#45;&gt;sourcefile~mpi_part_interface.f90</title>
<path fill="none" stroke="#004eff" stroke-dasharray="5,2" d="M782.8463,-285.2016C720.4138,-285.2016 628.3854,-285.2016 563.4808,-285.2016"/>
<polygon fill="#004eff" stroke="#004eff" points="563.3056,-281.7017 553.3056,-285.2016 563.3056,-288.7017 563.3056,-281.7017"/>
</g>
<!-- sourcefile~curr_and_fields_util.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_node21" class="node">
<title>sourcefile~curr_and_fields_util.f90</title>
<g id="a_sourcefile~~util.f90~~AfferentGraph_node21"><a xlink:href=".././sourcefile/curr_and_fields_util.f90.html" xlink:title="curr_and_fields_util.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="736.5,-379.2016 600.5,-379.2016 600.5,-355.2016 736.5,-355.2016 736.5,-379.2016"/>
<text text-anchor="middle" x="668.5" y="-364.8016" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">curr_and_fields_util.f90</text>
</a>
</g>
</g>
<!-- sourcefile~env_evolve_in_time.f90&#45;&gt;sourcefile~curr_and_fields_util.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge50" class="edge">
<title>sourcefile~env_evolve_in_time.f90&#45;&gt;sourcefile~curr_and_fields_util.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M834.1325,-297.3C813.9859,-310.859 779.382,-332.7056 747,-346.2016 741.954,-348.3047 736.637,-350.2522 731.2466,-352.0432"/>
<polygon fill="#ff0000" stroke="#ff0000" points="730.0019,-348.7654 721.5075,-355.0974 732.0966,-355.4446 730.0019,-348.7654"/>
</g>
<!-- sourcefile~fluid_density_momenta.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_node24" class="node">
<title>sourcefile~fluid_density_momenta.f90</title>
<g id="a_sourcefile~~util.f90~~AfferentGraph_node24"><a xlink:href=".././sourcefile/fluid_density_momenta.f90.html" xlink:title="fluid_density_momenta.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="747,-337.2016 590,-337.2016 590,-313.2016 747,-313.2016 747,-337.2016"/>
<text text-anchor="middle" x="668.5" y="-322.8016" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">fluid_density_momenta.f90</text>
</a>
</g>
</g>
<!-- sourcefile~env_evolve_in_time.f90&#45;&gt;sourcefile~fluid_density_momenta.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge54" class="edge">
<title>sourcefile~env_evolve_in_time.f90&#45;&gt;sourcefile~fluid_density_momenta.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M796.594,-297.203C776.7798,-301.5339 754.2245,-306.464 733.6206,-310.9676"/>
<polygon fill="#0066ff" stroke="#0066ff" points="732.7052,-307.585 723.6833,-313.1397 734.2001,-314.4235 732.7052,-307.585"/>
</g>
<!-- sourcefile~window.f90&#45;&gt;sourcefile~util.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~window.f90&#45;&gt;sourcefile~util.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M632.2395,-242.7926C529.6851,-236.3599 239.0685,-220.8632 147.5,-245.2016"/>
</g>
<!-- sourcefile~run_data_info.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_node11" class="node">
<title>sourcefile~run_data_info.f90</title>
<g id="a_sourcefile~~util.f90~~AfferentGraph_node11"><a xlink:href=".././sourcefile/run_data_info.f90.html" xlink:title="run_data_info.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="539.5,-217.2016 433.5,-217.2016 433.5,-193.2016 539.5,-193.2016 539.5,-217.2016"/>
<text text-anchor="middle" x="486.5" y="-202.8016" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">run_data_info.f90</text>
</a>
</g>
</g>
<!-- sourcefile~window.f90&#45;&gt;sourcefile~run_data_info.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge30" class="edge">
<title>sourcefile~window.f90&#45;&gt;sourcefile~run_data_info.f90</title>
<path fill="none" stroke="#9cff00" stroke-dasharray="5,2" d="M632.107,-237.2032C608.5479,-232.0253 577.2399,-225.1445 549.6929,-219.0902"/>
<polygon fill="#9cff00" stroke="#9cff00" points="550.2537,-215.63 539.7355,-216.9018 548.7511,-222.4668 550.2537,-215.63"/>
</g>
<!-- sourcefile~window.f90&#45;&gt;sourcefile~mpi_part_interface.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge37" class="edge">
<title>sourcefile~window.f90&#45;&gt;sourcefile~mpi_part_interface.f90</title>
<path fill="none" stroke="#004eff" stroke-dasharray="5,2" d="M632.107,-253.2001C608.9174,-258.2967 578.2202,-265.0434 550.992,-271.0276"/>
<polygon fill="#004eff" stroke="#004eff" points="550.1534,-267.6283 541.1378,-273.1933 551.656,-274.4651 550.1534,-267.6283"/>
</g>
<!-- sourcefile~mpi_field_interface.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_node20" class="node">
<title>sourcefile~mpi_field_interface.f90</title>
<g id="a_sourcefile~~util.f90~~AfferentGraph_node20"><a xlink:href=".././sourcefile/mpi_field_interface.f90.html" xlink:title="mpi_field_interface.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="554,-377.2016 419,-377.2016 419,-353.2016 554,-353.2016 554,-377.2016"/>
<text text-anchor="middle" x="486.5" y="-362.8016" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mpi_field_interface.f90</text>
</a>
</g>
</g>
<!-- sourcefile~window.f90&#45;&gt;sourcefile~mpi_field_interface.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge46" class="edge">
<title>sourcefile~window.f90&#45;&gt;sourcefile~mpi_field_interface.f90</title>
<path fill="none" stroke="#ff0075" stroke-dasharray="5,2" d="M651.1728,-257.2598C634.9354,-268.7818 610.2053,-286.9076 590,-304.2016 573.0466,-318.7123 572.7934,-327.1691 554,-339.2016 548.1733,-342.9322 541.7282,-346.2613 535.2008,-349.1889"/>
<polygon fill="#ff0075" stroke="#ff0075" points="533.5137,-346.1008 525.6409,-353.1909 536.2168,-352.5578 533.5137,-346.1008"/>
</g>
<!-- sourcefile~init_beam_part_distrib.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~init_beam_part_distrib.f90</title>
<g id="a_sourcefile~~util.f90~~AfferentGraph_node4"><a xlink:href=".././sourcefile/init_beam_part_distrib.f90.html" xlink:title="init_beam_part_distrib.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="744,-463.2016 593,-463.2016 593,-439.2016 744,-439.2016 744,-463.2016"/>
<text text-anchor="middle" x="668.5" y="-448.8016" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">init_beam_part_distrib.f90</text>
</a>
</g>
</g>
<!-- sourcefile~init_beam_part_distrib.f90&#45;&gt;sourcefile~util.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~init_beam_part_distrib.f90&#45;&gt;sourcefile~util.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M630.6504,-463.2746C594.1781,-474.0083 537.2156,-488.4234 486.5,-491.2016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M486.5,-491.2016C376.6306,-497.2203 340.8784,-505.3732 241,-459.2016 151.9455,-418.0338 74.0201,-326.4828 42.2262,-285.6023"/>
<polygon fill="#ff0000" stroke="#ff0000" points="44.8479,-283.2692 35.9865,-277.4617 39.2922,-287.5277 44.8479,-283.2692"/>
</g>
<!-- sourcefile~mpi_curr_interface.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_node9" class="node">
<title>sourcefile~mpi_curr_interface.f90</title>
<g id="a_sourcefile~~util.f90~~AfferentGraph_node9"><a xlink:href=".././sourcefile/mpi_curr_interface.f90.html" xlink:title="mpi_curr_interface.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="553,-419.2016 420,-419.2016 420,-395.2016 553,-395.2016 553,-419.2016"/>
<text text-anchor="middle" x="486.5" y="-404.8016" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mpi_curr_interface.f90</text>
</a>
</g>
</g>
<!-- sourcefile~init_beam_part_distrib.f90&#45;&gt;sourcefile~mpi_curr_interface.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge27" class="edge">
<title>sourcefile~init_beam_part_distrib.f90&#45;&gt;sourcefile~mpi_curr_interface.f90</title>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M618.7677,-439.1785C596.2973,-433.746 569.5678,-427.284 546.0385,-421.5956"/>
<polygon fill="#ff7500" stroke="#ff7500" points="546.7146,-418.1583 536.1722,-419.2103 545.0697,-424.9623 546.7146,-418.1583"/>
</g>
<!-- sourcefile~init_beam_part_distrib.f90&#45;&gt;sourcefile~mpi_field_interface.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge47" class="edge">
<title>sourcefile~init_beam_part_distrib.f90&#45;&gt;sourcefile~mpi_field_interface.f90</title>
<path fill="none" stroke="#ff0075" stroke-dasharray="5,2" d="M607.6994,-439.0972C601.4796,-436.654 595.4522,-433.7212 590,-430.2016 568.7719,-416.4981 574.9482,-400.3293 554,-386.2016 551.5675,-384.5612 549.0007,-383.0439 546.3459,-381.6413"/>
<polygon fill="#ff0075" stroke="#ff0075" points="547.5895,-378.3593 537.0477,-377.3008 544.6286,-384.7022 547.5895,-378.3593"/>
</g>
<!-- sourcefile~psolve.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_node25" class="node">
<title>sourcefile~psolve.f90</title>
<g id="a_sourcefile~~util.f90~~AfferentGraph_node25"><a xlink:href=".././sourcefile/psolve.f90.html" xlink:title="psolve.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="520,-461.2016 453,-461.2016 453,-437.2016 520,-437.2016 520,-461.2016"/>
<text text-anchor="middle" x="486.5" y="-446.8016" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">psolve.f90</text>
</a>
</g>
</g>
<!-- sourcefile~init_beam_part_distrib.f90&#45;&gt;sourcefile~psolve.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge56" class="edge">
<title>sourcefile~init_beam_part_distrib.f90&#45;&gt;sourcefile~psolve.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M592.8967,-450.3708C571.6364,-450.1372 549.2212,-449.8909 530.4765,-449.6849"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="530.5089,-446.1851 520.471,-449.575 530.4319,-453.1847 530.5089,-446.1851"/>
</g>
<!-- sourcefile~parallel.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_node5" class="node">
<title>sourcefile~parallel.f90</title>
<g id="a_sourcefile~~util.f90~~AfferentGraph_node5"><a xlink:href=".././sourcefile/parallel.f90.html" xlink:title="parallel.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="185.5,-297.2016 109.5,-297.2016 109.5,-273.2016 185.5,-273.2016 185.5,-297.2016"/>
<text text-anchor="middle" x="147.5" y="-282.8016" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">parallel.F90</text>
</a>
</g>
</g>
<!-- sourcefile~parallel.f90&#45;&gt;sourcefile~util.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge4" class="edge">
<title>sourcefile~parallel.f90&#45;&gt;sourcefile~util.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M109.373,-278.8735C94.9473,-276.4792 78.5566,-273.7588 64.2156,-271.3785"/>
<polygon fill="#ff0000" stroke="#ff0000" points="64.6309,-267.8996 54.1928,-269.715 63.4847,-274.8052 64.6309,-267.8996"/>
</g>
<!-- sourcefile~init_part_distrib.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_node6" class="node">
<title>sourcefile~init_part_distrib.f90</title>
<g id="a_sourcefile~~util.f90~~AfferentGraph_node6"><a xlink:href=".././sourcefile/init_part_distrib.f90.html" xlink:title="init_part_distrib.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="205,-99.2016 90,-99.2016 90,-75.2016 205,-75.2016 205,-99.2016"/>
<text text-anchor="middle" x="147.5" y="-84.8016" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">init_part_distrib.f90</text>
</a>
</g>
</g>
<!-- sourcefile~init_part_distrib.f90&#45;&gt;sourcefile~util.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge5" class="edge">
<title>sourcefile~init_part_distrib.f90&#45;&gt;sourcefile~util.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M139.2175,-99.4363C118.9239,-129.4137 66.5307,-206.8077 41.1697,-244.2704"/>
<polygon fill="#ff0000" stroke="#ff0000" points="38.048,-242.6383 35.3404,-252.8814 43.8447,-246.5625 38.048,-242.6383"/>
</g>
<!-- sourcefile~ionize.f90&#45;&gt;sourcefile~util.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge6" class="edge">
<title>sourcefile~ionize.f90&#45;&gt;sourcefile~util.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M636.4226,-154.0084C562.7757,-130.2686 377.4324,-81.7889 241,-142.2016 184.4682,-167.2341 206.9705,-228.2982 147.5,-245.2016"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M147.5,-245.2016C120.0857,-252.8003 88.3139,-257.9272 64.2793,-261.0863"/>
<polygon fill="#ff0000" stroke="#ff0000" points="63.6409,-257.6389 54.1567,-262.3611 64.5157,-264.5841 63.6409,-257.6389"/>
</g>
<!-- sourcefile~pic_in.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_node8" class="node">
<title>sourcefile~pic_in.f90</title>
<g id="a_sourcefile~~util.f90~~AfferentGraph_node8"><a xlink:href=".././sourcefile/pic_in.f90.html" xlink:title="pic_in.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="700.5,-59.2016 636.5,-59.2016 636.5,-35.2016 700.5,-35.2016 700.5,-59.2016"/>
<text text-anchor="middle" x="668.5" y="-44.8016" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pic_in.f90</text>
</a>
</g>
</g>
<!-- sourcefile~pic_in.f90&#45;&gt;sourcefile~init_part_distrib.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge20" class="edge">
<title>sourcefile~pic_in.f90&#45;&gt;sourcefile~init_part_distrib.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M636.2376,-38.2767C563.7336,-19.7687 383.1316,17.6406 241,-25.2016 213.2751,-33.5587 186.2179,-53.1198 168.4036,-68.0528"/>
<polygon fill="#0000ff" stroke="#0000ff" points="165.712,-65.7533 160.4385,-74.9425 170.2915,-71.0476 165.712,-65.7533"/>
</g>
<!-- sourcefile~init_laser_field.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_node23" class="node">
<title>sourcefile~init_laser_field.f90</title>
<g id="a_sourcefile~~util.f90~~AfferentGraph_node23"><a xlink:href=".././sourcefile/init_laser_field.f90.html" xlink:title="init_laser_field.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="541,-175.2016 432,-175.2016 432,-151.2016 541,-151.2016 541,-175.2016"/>
<text text-anchor="middle" x="486.5" y="-160.8016" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">init_laser_field.f90</text>
</a>
</g>
</g>
<!-- sourcefile~pic_in.f90&#45;&gt;sourcefile~init_laser_field.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge52" class="edge">
<title>sourcefile~pic_in.f90&#45;&gt;sourcefile~init_laser_field.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M636.3469,-54.7383C621.6439,-58.9531 604.3458,-65.0298 590,-73.2016 556.3906,-92.3467 523.762,-123.4314 504.4013,-143.5957"/>
<polygon fill="#00ff66" stroke="#00ff66" points="501.7374,-141.3191 497.4214,-150.995 506.8294,-146.1225 501.7374,-141.3191"/>
</g>
<!-- sourcefile~mpi_curr_interface.f90&#45;&gt;sourcefile~parallel.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge11" class="edge">
<title>sourcefile~mpi_curr_interface.f90&#45;&gt;sourcefile~parallel.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M419.6698,-404.0422C386.7693,-401.2607 346.797,-396.0315 312,-386.2016"/>
</g>
<!-- sourcefile~pic_evolve_in_time.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_node10" class="node">
<title>sourcefile~pic_evolve_in_time.f90</title>
<g id="a_sourcefile~~util.f90~~AfferentGraph_node10"><a xlink:href=".././sourcefile/pic_evolve_in_time.f90.html" xlink:title="pic_evolve_in_time.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="918,-236.2016 785,-236.2016 785,-212.2016 918,-212.2016 918,-236.2016"/>
<text text-anchor="middle" x="851.5" y="-221.8016" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pic_evolve_in_time.f90</text>
</a>
</g>
</g>
<!-- sourcefile~pic_evolve_in_time.f90&#45;&gt;sourcefile~window.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge8" class="edge">
<title>sourcefile~pic_evolve_in_time.f90&#45;&gt;sourcefile~window.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M784.9151,-231.8425C761.6416,-234.5133 736.0402,-237.4511 714.7862,-239.8901"/>
<polygon fill="#ffff00" stroke="#ffff00" points="714.2667,-236.4267 704.7309,-241.044 715.0648,-243.381 714.2667,-236.4267"/>
</g>
<!-- sourcefile~pic_evolve_in_time.f90&#45;&gt;sourcefile~ionize.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge22" class="edge">
<title>sourcefile~pic_evolve_in_time.f90&#45;&gt;sourcefile~ionize.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M814.0256,-212.1197C783.9258,-202.4154 741.6739,-188.7932 710.4474,-178.7257"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="711.3173,-175.3288 700.7257,-175.5914 709.1693,-181.9911 711.3173,-175.3288"/>
</g>
<!-- sourcefile~pic_evolve_in_time.f90&#45;&gt;sourcefile~mpi_part_interface.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge36" class="edge">
<title>sourcefile~pic_evolve_in_time.f90&#45;&gt;sourcefile~mpi_part_interface.f90</title>
<path fill="none" stroke="#004eff" stroke-dasharray="5,2" d="M784.9388,-214.678C731.3122,-209.2557 654.4944,-206.6101 590,-224.2016 559.6759,-232.4729 529.1876,-252.1445 509.2366,-266.9281"/>
<polygon fill="#004eff" stroke="#004eff" points="506.9431,-264.2752 501.1063,-273.1173 511.1832,-269.845 506.9431,-264.2752"/>
</g>
<!-- sourcefile~pic_evolve_in_time.f90&#45;&gt;sourcefile~curr_and_fields_util.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge49" class="edge">
<title>sourcefile~pic_evolve_in_time.f90&#45;&gt;sourcefile~curr_and_fields_util.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M821.9843,-236.3061C808.6902,-242.9451 793.6291,-252.276 783,-264.2016 756.5173,-293.9147 777.2037,-320.28 747,-346.2016 745.4744,-347.5109 743.8755,-348.7395 742.2161,-349.8923"/>
<polygon fill="#ff0000" stroke="#ff0000" points="740.31,-346.953 733.4744,-355.0478 743.866,-352.9825 740.31,-346.953"/>
</g>
<!-- sourcefile~pic_evolve_in_time.f90&#45;&gt;sourcefile~fluid_density_momenta.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge53" class="edge">
<title>sourcefile~pic_evolve_in_time.f90&#45;&gt;sourcefile~fluid_density_momenta.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M829.4259,-236.3846C796.9128,-254.329 736.0283,-287.9319 699.1847,-308.2664"/>
<polygon fill="#0066ff" stroke="#0066ff" points="697.4314,-305.2363 690.3675,-313.1327 700.8138,-311.3649 697.4314,-305.2363"/>
</g>
<!-- sourcefile~run_data_info.f90&#45;&gt;sourcefile~parallel.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge13" class="edge">
<title>sourcefile~run_data_info.f90&#45;&gt;sourcefile~parallel.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M469.7599,-217.3173C439.8742,-237.8901 374.5889,-278.12 312,-285.2016"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M312,-285.2016C273.0779,-289.6055 228.643,-289.2905 195.775,-288.0489"/>
<polygon fill="#00ffff" stroke="#00ffff" points="195.6699,-284.5415 185.5316,-287.6181 195.3757,-291.5353 195.6699,-284.5415"/>
</g>
<!-- sourcefile~diag_part_and_fields.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_node12" class="node">
<title>sourcefile~diag_part_and_fields.f90</title>
<g id="a_sourcefile~~util.f90~~AfferentGraph_node12"><a xlink:href=".././sourcefile/diag_part_and_fields.f90.html" xlink:title="diag_part_and_fields.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="383,-58.2016 241,-58.2016 241,-34.2016 383,-34.2016 383,-58.2016"/>
<text text-anchor="middle" x="312" y="-43.8016" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">diag_part_and_fields.f90</text>
</a>
</g>
</g>
<!-- sourcefile~diag_part_and_fields.f90&#45;&gt;sourcefile~parallel.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge12" class="edge">
<title>sourcefile~diag_part_and_fields.f90&#45;&gt;sourcefile~parallel.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M300.8753,-58.3341C285.4617,-75.7186 257.6336,-109.2647 241,-142.2016 216.4744,-190.766 240.9691,-218.3822 205,-259.2016 201.9432,-262.6707 198.3315,-265.7025 194.431,-268.3471"/>
<polygon fill="#00ffff" stroke="#00ffff" points="192.4082,-265.4751 185.5341,-273.5372 195.9355,-271.5214 192.4082,-265.4751"/>
</g>
<!-- sourcefile~prl_fft.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_node13" class="node">
<title>sourcefile~prl_fft.f90</title>
<g id="a_sourcefile~~util.f90~~AfferentGraph_node13"><a xlink:href=".././sourcefile/prl_fft.f90.html" xlink:title="prl_fft.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="344,-450.2016 280,-450.2016 280,-426.2016 344,-426.2016 344,-450.2016"/>
<text text-anchor="middle" x="312" y="-435.8016" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">prl_fft.f90</text>
</a>
</g>
</g>
<!-- sourcefile~prl_fft.f90&#45;&gt;sourcefile~parallel.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge14" class="edge">
<title>sourcefile~prl_fft.f90&#45;&gt;sourcefile~parallel.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M283.4422,-426.1318C269.8049,-419.5939 253.7258,-410.7001 241,-400.2016 207.2073,-372.3235 177.0087,-330.6636 160.5694,-305.8827"/>
<polygon fill="#00ffff" stroke="#00ffff" points="163.3541,-303.745 154.9638,-297.2755 157.4884,-307.5651 163.3541,-303.745"/>
</g>
<!-- sourcefile~start_all.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_node14" class="node">
<title>sourcefile~start_all.f90</title>
<g id="a_sourcefile~~util.f90~~AfferentGraph_node14"><a xlink:href=".././sourcefile/start_all.f90.html" xlink:title="start_all.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="890,-97.2016 813,-97.2016 813,-73.2016 890,-73.2016 890,-97.2016"/>
<text text-anchor="middle" x="851.5" y="-82.8016" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">start_all.F90</text>
</a>
</g>
</g>
<!-- sourcefile~start_all.f90&#45;&gt;sourcefile~ionize.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge21" class="edge">
<title>sourcefile~start_all.f90&#45;&gt;sourcefile~ionize.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M823.7062,-97.3519C792.0836,-111.176 740.3073,-133.8105 705.3414,-149.0961"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="703.7165,-145.9866 695.9557,-153.1991 706.5204,-152.4005 703.7165,-145.9866"/>
</g>
<!-- sourcefile~start_all.f90&#45;&gt;sourcefile~pic_in.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge24" class="edge">
<title>sourcefile~start_all.f90&#45;&gt;sourcefile~pic_in.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M812.6904,-77.1428C782.715,-70.9184 741.2951,-62.3176 710.5367,-55.9306"/>
<polygon fill="#ff0000" stroke="#ff0000" points="711.049,-52.4624 700.5463,-53.8561 709.6258,-59.3162 711.049,-52.4624"/>
</g>
<!-- sourcefile~start_all.f90&#45;&gt;sourcefile~run_data_info.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge29" class="edge">
<title>sourcefile~start_all.f90&#45;&gt;sourcefile~run_data_info.f90</title>
<path fill="none" stroke="#9cff00" stroke-dasharray="5,2" d="M668.5,-87.2016C632.4813,-93.0039 617.7936,-87.5684 590,-111.2016 562.441,-134.6354 581.5014,-160.7003 554,-184.2016 552.2564,-185.6916 550.4077,-187.076 548.4785,-188.3622"/>
<polygon fill="#9cff00" stroke="#9cff00" points="546.561,-185.4256 539.5809,-193.396 550.008,-191.5182 546.561,-185.4256"/>
</g>
<!-- sourcefile~pic_dump.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_node15" class="node">
<title>sourcefile~pic_dump.f90</title>
<g id="a_sourcefile~~util.f90~~AfferentGraph_node15"><a xlink:href=".././sourcefile/pic_dump.f90.html" xlink:title="pic_dump.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="354.5,-217.2016 269.5,-217.2016 269.5,-193.2016 354.5,-193.2016 354.5,-217.2016"/>
<text text-anchor="middle" x="312" y="-202.8016" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pic_dump.f90</text>
</a>
</g>
</g>
<!-- sourcefile~start_all.f90&#45;&gt;sourcefile~pic_dump.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge35" class="edge">
<title>sourcefile~start_all.f90&#45;&gt;sourcefile~pic_dump.f90</title>
<path fill="none" stroke="#00c4ff" stroke-dasharray="5,2" d="M812.6591,-82.3083C775.4193,-80.3134 717.7483,-79.2683 668.5,-87.2016"/>
<path fill="none" stroke="#00c4ff" stroke-dasharray="5,2" d="M668.5,-87.2016C556.394,-105.2607 516.4189,-83.8627 419,-142.2016 397.9074,-154.8329 403.6336,-170.8338 383,-184.2016 377.2739,-187.9114 370.8701,-190.9856 364.3157,-193.5282"/>
<polygon fill="#00c4ff" stroke="#00c4ff" points="362.9611,-190.2937 354.6665,-196.8854 365.2613,-196.905 362.9611,-190.2937"/>
</g>
<!-- sourcefile~pic_dump.f90&#45;&gt;sourcefile~parallel.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge15" class="edge">
<title>sourcefile~pic_dump.f90&#45;&gt;sourcefile~parallel.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M288.764,-217.2885C267.1849,-228.4274 234.0972,-245.2887 205,-259.2016 198.2727,-262.4183 191.0581,-265.7624 184.0909,-268.9388"/>
<polygon fill="#00ffff" stroke="#00ffff" points="182.4793,-265.8263 174.8124,-273.1386 185.3659,-272.2035 182.4793,-265.8263"/>
</g>
<!-- sourcefile~mpi_part_interface.f90&#45;&gt;sourcefile~parallel.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge16" class="edge">
<title>sourcefile~mpi_part_interface.f90&#45;&gt;sourcefile~parallel.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M419.5974,-281.6874C387.034,-280.8713 347.3711,-281.1995 312,-285.2016"/>
</g>
<!-- sourcefile~grid_fields.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_node17" class="node">
<title>sourcefile~grid_fields.f90</title>
<g id="a_sourcefile~~util.f90~~AfferentGraph_node17"><a xlink:href=".././sourcefile/grid_fields.f90.html" xlink:title="grid_fields.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="356,-337.2016 268,-337.2016 268,-313.2016 356,-313.2016 356,-337.2016"/>
<text text-anchor="middle" x="312" y="-322.8016" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">grid_fields.f90</text>
</a>
</g>
</g>
<!-- sourcefile~grid_fields.f90&#45;&gt;sourcefile~parallel.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge17" class="edge">
<title>sourcefile~grid_fields.f90&#45;&gt;sourcefile~parallel.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M267.917,-314.4824C245.5336,-309.0396 218.3044,-302.4185 195.4048,-296.8502"/>
<polygon fill="#00ffff" stroke="#00ffff" points="196.0967,-293.4165 185.5528,-294.4546 194.4427,-300.2183 196.0967,-293.4165"/>
</g>
<!-- sourcefile~pic_out.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_node18" class="node">
<title>sourcefile~pic_out.f90</title>
<g id="a_sourcefile~~util.f90~~AfferentGraph_node18"><a xlink:href=".././sourcefile/pic_out.f90.html" xlink:title="pic_out.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="347.5,-175.2016 276.5,-175.2016 276.5,-151.2016 347.5,-151.2016 347.5,-175.2016"/>
<text text-anchor="middle" x="312" y="-160.8016" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pic_out.f90</text>
</a>
</g>
</g>
<!-- sourcefile~pic_out.f90&#45;&gt;sourcefile~parallel.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge18" class="edge">
<title>sourcefile~pic_out.f90&#45;&gt;sourcefile~parallel.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M276.3047,-167.7173C264.0207,-170.7398 250.8843,-175.7841 241,-184.2016 212.85,-208.1743 231.442,-233.3573 205,-259.2016 201.5575,-262.5663 197.6029,-265.5419 193.4134,-268.1628"/>
<polygon fill="#00ffff" stroke="#00ffff" points="191.6274,-265.151 184.5728,-273.0557 195.017,-271.2756 191.6274,-265.151"/>
</g>
<!-- sourcefile~aladyn.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_node19" class="node">
<title>sourcefile~aladyn.f90</title>
<g id="a_sourcefile~~util.f90~~AfferentGraph_node19"><a xlink:href=".././sourcefile/aladyn.f90.html" xlink:title="ALaDyn.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1032,-196.2016 956,-196.2016 956,-172.2016 1032,-172.2016 1032,-196.2016"/>
<text text-anchor="middle" x="994" y="-181.8016" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ALaDyn.F90</text>
</a>
</g>
</g>
<!-- sourcefile~aladyn.f90&#45;&gt;sourcefile~env_evolve_in_time.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge7" class="edge">
<title>sourcefile~aladyn.f90&#45;&gt;sourcefile~env_evolve_in_time.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M980.6108,-196.3575C966.1739,-209.1926 942.2602,-229.6779 920,-245.2016 908.4128,-253.2823 895.1134,-261.3094 883.3342,-268.0286"/>
<polygon fill="#ff0000" stroke="#ff0000" points="881.2827,-265.1663 874.2753,-273.1128 884.7087,-271.2707 881.2827,-265.1663"/>
</g>
<!-- sourcefile~aladyn.f90&#45;&gt;sourcefile~init_beam_part_distrib.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge10" class="edge">
<title>sourcefile~aladyn.f90&#45;&gt;sourcefile~init_beam_part_distrib.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M851.5,-430.2016C822.6242,-446.8454 786.9293,-453.418 754.7535,-455.361"/>
<polygon fill="#00ff00" stroke="#00ff00" points="754.2718,-451.8794 744.4435,-455.8361 754.5941,-458.872 754.2718,-451.8794"/>
</g>
<!-- sourcefile~aladyn.f90&#45;&gt;sourcefile~pic_evolve_in_time.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge28" class="edge">
<title>sourcefile~aladyn.f90&#45;&gt;sourcefile~pic_evolve_in_time.f90</title>
<path fill="none" stroke="#ffeb00" stroke-dasharray="5,2" d="M955.8126,-194.9209C939.9619,-199.3702 921.3061,-204.607 904.1871,-209.4123"/>
<polygon fill="#ffeb00" stroke="#ffeb00" points="903,-206.1101 894.3181,-212.1825 904.8919,-212.8497 903,-206.1101"/>
</g>
<!-- sourcefile~aladyn.f90&#45;&gt;sourcefile~run_data_info.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge31" class="edge">
<title>sourcefile~aladyn.f90&#45;&gt;sourcefile~run_data_info.f90</title>
<path fill="none" stroke="#9cff00" stroke-dasharray="5,2" d="M965.7765,-172.1832C897.7167,-145.1054 720.5409,-86.0636 590,-144.2016 568.1513,-153.9322 574.1388,-171.299 554,-184.2016 551.2615,-185.9561 548.3667,-187.5724 545.3773,-189.0603"/>
<polygon fill="#9cff00" stroke="#9cff00" points="543.901,-185.8863 536.1868,-193.1486 546.7461,-192.282 543.901,-185.8863"/>
</g>
<!-- sourcefile~aladyn.f90&#45;&gt;sourcefile~diag_part_and_fields.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge32" class="edge">
<title>sourcefile~aladyn.f90&#45;&gt;sourcefile~diag_part_and_fields.f90</title>
<path fill="none" stroke="#27ff00" stroke-dasharray="5,2" d="M990.1424,-172.1132C981.6724,-147.6194 959.0291,-92.0969 920,-64.2016 826.7555,2.443 783.0025,-12.225 668.5,-7.2016"/>
<path fill="none" stroke="#27ff00" stroke-dasharray="5,2" d="M668.5,-7.2016C558.3875,6.9418 528.8097,-2.873 419,-19.2016 399.9727,-22.031 379.411,-26.7943 361.4456,-31.5394"/>
<polygon fill="#27ff00" stroke="#27ff00" points="360.4964,-28.1703 351.7581,-34.1612 362.3252,-34.9272 360.4964,-28.1703"/>
</g>
<!-- sourcefile~aladyn.f90&#45;&gt;sourcefile~start_all.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge34" class="edge">
<title>sourcefile~aladyn.f90&#45;&gt;sourcefile~start_all.f90</title>
<path fill="none" stroke="#00ffc4" stroke-dasharray="5,2" d="M984.445,-172.0255C971.3982,-156.1105 946.5766,-128.2619 920,-111.2016 913.7446,-107.1861 906.7756,-103.649 899.7449,-100.5812"/>
<polygon fill="#00ffc4" stroke="#00ffc4" points="900.762,-97.2164 890.1804,-96.6878 898.1228,-103.6999 900.762,-97.2164"/>
</g>
<!-- sourcefile~aladyn.f90&#45;&gt;sourcefile~pic_out.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge43" class="edge">
<title>sourcefile~aladyn.f90&#45;&gt;sourcefile~pic_out.f90</title>
<path fill="none" stroke="#9c00ff" stroke-dasharray="5,2" d="M668.5,-7.2016C531.6734,6.9301 386.984,-100.0979 333.4912,-144.4982"/>
<polygon fill="#9c00ff" stroke="#9c00ff" points="331.097,-141.9387 325.7041,-151.0583 335.607,-147.2922 331.097,-141.9387"/>
</g>
<!-- sourcefile~pic_out_util.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_node22" class="node">
<title>sourcefile~pic_out_util.f90</title>
<g id="a_sourcefile~~util.f90~~AfferentGraph_node22"><a xlink:href=".././sourcefile/pic_out_util.f90.html" xlink:title="pic_out_util.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="715,-421.2016 622,-421.2016 622,-397.2016 715,-397.2016 715,-421.2016"/>
<text text-anchor="middle" x="668.5" y="-406.8016" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pic_out_util.f90</text>
</a>
</g>
</g>
<!-- sourcefile~aladyn.f90&#45;&gt;sourcefile~pic_out_util.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge51" class="edge">
<title>sourcefile~aladyn.f90&#45;&gt;sourcefile~pic_out_util.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M991.4152,-196.4431C981.8118,-238.4338 943.865,-376.9632 851.5,-430.2016"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M851.5,-430.2016C830.5919,-442.2529 770.7307,-432.7954 725.1134,-423.0015"/>
<polygon fill="#cbff00" stroke="#cbff00" points="725.8414,-419.5781 715.323,-420.8486 724.3379,-426.4147 725.8414,-419.5781"/>
</g>
<!-- sourcefile~mpi_field_interface.f90&#45;&gt;sourcefile~parallel.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge19" class="edge">
<title>sourcefile~mpi_field_interface.f90&#45;&gt;sourcefile~parallel.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M451.7752,-377.2486C416.1071,-387.8078 359.2769,-399.557 312,-386.2016"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M312,-386.2016C255.349,-370.1982 198.9908,-328.6029 169.1966,-304.0715"/>
<polygon fill="#00ffff" stroke="#00ffff" points="171.0871,-301.0892 161.1753,-297.3467 166.5899,-306.4535 171.0871,-301.0892"/>
</g>
<!-- sourcefile~curr_and_fields_util.f90&#45;&gt;sourcefile~mpi_curr_interface.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge26" class="edge">
<title>sourcefile~curr_and_fields_util.f90&#45;&gt;sourcefile~mpi_curr_interface.f90</title>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M613.894,-379.203C594.1881,-383.5339 571.7561,-388.464 551.2648,-392.9676"/>
<polygon fill="#ff7500" stroke="#ff7500" points="550.3973,-389.5747 541.3818,-395.1397 551.9,-396.4115 550.3973,-389.5747"/>
</g>
<!-- sourcefile~curr_and_fields_util.f90&#45;&gt;sourcefile~grid_fields.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge41" class="edge">
<title>sourcefile~curr_and_fields_util.f90&#45;&gt;sourcefile~grid_fields.f90</title>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M624.3403,-355.2009C579.4551,-343.3312 512.885,-326.7188 486.5,-325.2016"/>
</g>
<!-- sourcefile~curr_and_fields_util.f90&#45;&gt;sourcefile~mpi_field_interface.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge44" class="edge">
<title>sourcefile~curr_and_fields_util.f90&#45;&gt;sourcefile~mpi_field_interface.f90</title>
<path fill="none" stroke="#ff0075" stroke-dasharray="5,2" d="M600.4711,-366.4541C588.6392,-366.3241 576.2529,-366.1879 564.1858,-366.0553"/>
<polygon fill="#ff0075" stroke="#ff0075" points="564.1817,-362.5552 554.1438,-365.945 564.1047,-369.5548 564.1817,-362.5552"/>
</g>
<!-- sourcefile~pic_out_util.f90&#45;&gt;sourcefile~mpi_curr_interface.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge25" class="edge">
<title>sourcefile~pic_out_util.f90&#45;&gt;sourcefile~mpi_curr_interface.f90</title>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M621.6305,-408.6866C603.8721,-408.4914 583.1552,-408.2638 563.3542,-408.0462"/>
<polygon fill="#ff7500" stroke="#ff7500" points="563.1415,-404.5437 553.1036,-407.9336 563.0645,-411.5433 563.1415,-404.5437"/>
</g>
<!-- sourcefile~pic_out_util.f90&#45;&gt;sourcefile~mpi_field_interface.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge45" class="edge">
<title>sourcefile~pic_out_util.f90&#45;&gt;sourcefile~mpi_field_interface.f90</title>
<path fill="none" stroke="#ff0075" stroke-dasharray="5,2" d="M621.6305,-397.8706C598.6734,-392.3205 570.7722,-385.5751 546.2971,-379.6581"/>
<polygon fill="#ff0075" stroke="#ff0075" points="546.9402,-376.2128 536.3978,-377.2648 545.2953,-383.0168 546.9402,-376.2128"/>
</g>
<!-- sourcefile~pic_out_util.f90&#45;&gt;sourcefile~psolve.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge55" class="edge">
<title>sourcefile~pic_out_util.f90&#45;&gt;sourcefile~psolve.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M621.6305,-419.5026C593.3957,-425.7081 557.6823,-433.5572 530.0622,-439.6275"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="529.2969,-436.2121 520.2813,-441.7772 530.7996,-443.0489 529.2969,-436.2121"/>
</g>
<!-- sourcefile~init_laser_field.f90&#45;&gt;sourcefile~grid_fields.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge39" class="edge">
<title>sourcefile~init_laser_field.f90&#45;&gt;sourcefile~grid_fields.f90</title>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M431.8302,-174.8801C427.1195,-177.405 422.7349,-180.4733 419,-184.2016 381.0962,-222.0388 419.9575,-260.4397 383,-299.2016 378.1311,-304.3082 372.1769,-308.4166 365.8077,-311.7208"/>
<polygon fill="#2700ff" stroke="#2700ff" points="363.9461,-308.72 356.2572,-316.0092 366.8134,-315.1058 363.9461,-308.72"/>
</g>
<!-- sourcefile~fluid_density_momenta.f90&#45;&gt;sourcefile~grid_fields.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge40" class="edge">
<title>sourcefile~fluid_density_momenta.f90&#45;&gt;sourcefile~grid_fields.f90</title>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M589.6092,-327.1741C557.5859,-327.4609 520.2533,-327.1425 486.5,-325.2016"/>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M486.5,-325.2016C446.3448,-322.8927 400.9059,-322.9786 366.464,-323.5965"/>
<polygon fill="#2700ff" stroke="#2700ff" points="366.074,-320.1035 356.1462,-323.8032 366.2143,-327.1021 366.074,-320.1035"/>
</g>
<!-- sourcefile~fluid_density_momenta.f90&#45;&gt;sourcefile~mpi_field_interface.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge48" class="edge">
<title>sourcefile~fluid_density_momenta.f90&#45;&gt;sourcefile~mpi_field_interface.f90</title>
<path fill="none" stroke="#ff0075" stroke-dasharray="5,2" d="M613.894,-337.203C594.1881,-341.5339 571.7561,-346.464 551.2648,-350.9676"/>
<polygon fill="#ff0075" stroke="#ff0075" points="550.3973,-347.5747 541.3818,-353.1397 551.9,-354.4115 550.3973,-347.5747"/>
</g>
<!-- sourcefile~psolve.f90&#45;&gt;sourcefile~prl_fft.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge33" class="edge">
<title>sourcefile~psolve.f90&#45;&gt;sourcefile~prl_fft.f90</title>
<path fill="none" stroke="#00ff4e" stroke-dasharray="5,2" d="M452.8546,-447.0807C424.7707,-445.3104 384.5891,-442.7775 354.3247,-440.8697"/>
<polygon fill="#00ff4e" stroke="#00ff4e" points="354.2699,-437.3594 344.0695,-440.2232 353.8295,-444.3455 354.2699,-437.3594"/>
</g>
<!-- sourcefile~psolve.f90&#45;&gt;sourcefile~grid_fields.f90 -->
<g id="sourcefile~~util.f90~~AfferentGraph_edge42" class="edge">
<title>sourcefile~psolve.f90&#45;&gt;sourcefile~grid_fields.f90</title>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M452.7321,-443.5913C441.2022,-440.4645 428.7662,-435.6342 419,-428.2016 395.455,-410.2826 403.7812,-393.2634 383,-372.2016 371.6117,-360.6597 356.948,-350.3799 343.9064,-342.3997"/>
<polygon fill="#2700ff" stroke="#2700ff" points="345.5871,-339.3275 335.1969,-337.2551 342.0269,-345.3546 345.5871,-339.3275"/>
</g>
</g>
</svg>
</div><script>var pansourcefileutilf90AfferentGraph = svgPanZoom('#sourcefileutilf90AfferentGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="202pt" height="32pt"
 viewBox="0.00 0.00 201.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 197.5,-28 197.5,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="71,-24 0,-24 0,0 71,0 71,-24"/>
<text text-anchor="middle" x="35.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="193.5,-24 89.5,-24 89.5,0 193.5,0 193.5,-24"/>
<text text-anchor="middle" x="141.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
      
      <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/util.html">util</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/util.f90.html#src">util.f90</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="c">!*****************************************************************************************************!</span>
<a name="ln-2"></a><span class="c">!                            Copyright 2008-2020  The ALaDyn Collaboration                            !</span>
<a name="ln-3"></a><span class="c">!*****************************************************************************************************!</span>
<a name="ln-4"></a>
<a name="ln-5"></a><span class="c">!*****************************************************************************************************!</span>
<a name="ln-6"></a><span class="c">!  This file is part of ALaDyn.                                                                       !</span>
<a name="ln-7"></a><span class="c">!                                                                                                     !</span>
<a name="ln-8"></a><span class="c">!  ALaDyn is free software: you can redistribute it and/or modify                                     !</span>
<a name="ln-9"></a><span class="c">!  it under the terms of the GNU General Public License as published by                               !</span>
<a name="ln-10"></a><span class="c">!  the Free Software Foundation, either version 3 of the License, or                                  !</span>
<a name="ln-11"></a><span class="c">!  (at your option) any later version.                                                                !</span>
<a name="ln-12"></a><span class="c">!                                                                                                     !</span>
<a name="ln-13"></a><span class="c">!  ALaDyn is distributed in the hope that it will be useful,                                          !</span>
<a name="ln-14"></a><span class="c">!  but WITHOUT ANY WARRANTY; without even the implied warranty of                                     !</span>
<a name="ln-15"></a><span class="c">!  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the                                      !</span>
<a name="ln-16"></a><span class="c">!  GNU General Public License for more details.                                                       !</span>
<a name="ln-17"></a><span class="c">!                                                                                                     !</span>
<a name="ln-18"></a><span class="c">!  You should have received a copy of the GNU General Public License                                  !</span>
<a name="ln-19"></a><span class="c">!  along with ALaDyn.  If not, see &lt;http://www.gnu.org/licenses/&gt;.                                    !</span>
<a name="ln-20"></a><span class="c">!*****************************************************************************************************!</span>
<a name="ln-21"></a>
<a name="ln-22"></a> <span class="k">module </span><span class="n">util</span>
<a name="ln-23"></a>
<a name="ln-24"></a>  <span class="k">use </span><span class="n">precision_def</span>
<a name="ln-25"></a>  <span class="k">use </span><span class="n">code_util</span>
<a name="ln-26"></a>
<a name="ln-27"></a>  <span class="k">implicit none</span>
<a name="ln-28"></a><span class="k">  private</span>
<a name="ln-29"></a><span class="k">  public</span> <span class="kd">::</span> <span class="n">gasdev</span><span class="p">,</span> <span class="n">init_random_seed</span><span class="p">,</span> <span class="n">bunch_gen</span>
<a name="ln-30"></a>
<a name="ln-31"></a> <span class="k">contains</span>
<a name="ln-32"></a>
<a name="ln-33"></a><span class="k">  subroutine </span><span class="n">init_random_seed</span><span class="p">(</span><span class="n">myrank</span><span class="p">)</span>
<a name="ln-34"></a>   <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">myrank</span>
<a name="ln-35"></a>   <span class="kt">integer</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">seed</span><span class="p">(:)</span>
<a name="ln-36"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">un</span><span class="p">,</span> <span class="n">istat</span><span class="p">,</span> <span class="n">dt</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span> <span class="n">pid</span><span class="p">,</span> <span class="n">t</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">s</span>
<a name="ln-37"></a>   <span class="kt">integer</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="kd">::</span> <span class="nb">count</span><span class="p">,</span> <span class="n">tms</span>
<a name="ln-38"></a>
<a name="ln-39"></a>   <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-40"></a>   <span class="k">call </span><span class="nb">random_seed</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<a name="ln-41"></a>   <span class="k">allocate</span> <span class="p">(</span><span class="n">seed</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
<a name="ln-42"></a>
<a name="ln-43"></a>   <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">l_disable_rng_seed</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-44"></a><span class="k">    </span><span class="n">un</span> <span class="o">=</span> <span class="mi">123</span>
<a name="ln-45"></a>    <span class="c">! First try if the OS provides a random number generator</span>
<a name="ln-46"></a>    <span class="k">open</span> <span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">un</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="s1">&#39;/dev/urandom&#39;</span><span class="p">,</span> <span class="nb">access</span><span class="o">=</span><span class="s1">&#39;stream&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-47"></a>          <span class="n">form</span><span class="o">=</span><span class="s1">&#39;unformatted&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;read&#39;</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="s1">&#39;old&#39;</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">istat</span><span class="p">)</span>
<a name="ln-48"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">istat</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-49"></a><span class="k">     read</span> <span class="p">(</span><span class="n">un</span><span class="p">)</span> <span class="n">seed</span>
<a name="ln-50"></a>     <span class="k">close</span> <span class="p">(</span><span class="n">un</span><span class="p">)</span>
<a name="ln-51"></a>    <span class="k">else</span>
<a name="ln-52"></a>     <span class="c">! Fallback to XOR:ing the current time and pid. The PID is</span>
<a name="ln-53"></a>     <span class="c">! useful in case one launches multiple instances of the same</span>
<a name="ln-54"></a>     <span class="c">! program in parallel.</span>
<a name="ln-55"></a>     <span class="k">call </span><span class="nb">system_clock</span><span class="p">(</span><span class="nb">count</span><span class="p">)</span>
<a name="ln-56"></a>     <span class="k">if</span> <span class="p">(</span><span class="nb">count</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-57"></a><span class="k">      </span><span class="n">t</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="nb">count</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<a name="ln-58"></a>     <span class="k">else</span>
<a name="ln-59"></a><span class="k">      call </span><span class="nb">date_and_time</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="n">dt</span><span class="p">)</span>
<a name="ln-60"></a>      <span class="n">tms</span> <span class="o">=</span> <span class="p">(</span><span class="n">dt</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1970</span><span class="p">)</span><span class="o">*</span><span class="mi">365</span><span class="err">_</span><span class="mi">8</span><span class="o">*</span><span class="mi">24</span><span class="o">*</span><span class="mi">60</span><span class="o">*</span><span class="mi">60</span><span class="o">*</span><span class="mi">1000</span> <span class="o">+</span> <span class="n">dt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="mi">31</span><span class="err">_</span><span class="mi">8</span><span class="o">*</span><span class="mi">24</span><span class="o">*</span><span class="mi">60</span><span class="o">*</span><span class="mi">60</span><span class="o">*</span><span class="mi">1000</span> <span class="p">&amp;</span>
<a name="ln-61"></a>            <span class="o">+</span> <span class="n">dt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="mi">24</span><span class="o">*</span><span class="mi">60</span><span class="o">*</span><span class="mi">60</span><span class="o">*</span><span class="mi">60</span><span class="o">*</span><span class="mi">1000</span> <span class="o">+</span> <span class="n">dt</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="mi">60</span><span class="o">*</span><span class="mi">60</span><span class="o">*</span><span class="mi">1000</span> <span class="o">+</span> <span class="n">dt</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="mi">60</span><span class="o">*</span><span class="mi">1000</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-62"></a>            <span class="n">dt</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="mi">1000</span> <span class="o">+</span> <span class="n">dt</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-63"></a>      <span class="n">t</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">tms</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<a name="ln-64"></a>     <span class="k">end if</span>
<a name="ln-65"></a><span class="k">     </span><span class="n">s</span> <span class="o">=</span> <span class="nb">ieor</span><span class="p">(</span><span class="n">t</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">t</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-66"></a>     <span class="n">pid</span> <span class="o">=</span> <span class="n">myrank</span> <span class="o">+</span> <span class="mi">1099279</span> <span class="c">! Add a prime</span>
<a name="ln-67"></a>     <span class="n">s</span> <span class="o">=</span> <span class="nb">ieor</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">pid</span><span class="p">)</span>
<a name="ln-68"></a>     <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-69"></a><span class="k">      </span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">t</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">36269</span>
<a name="ln-70"></a>      <span class="n">seed</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">t</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">72551</span>
<a name="ln-71"></a>      <span class="n">seed</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">pid</span>
<a name="ln-72"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-73"></a><span class="k">       </span><span class="n">seed</span><span class="p">(</span><span class="mi">4</span><span class="p">:)</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="mi">37</span><span class="o">*</span><span class="p">[(</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">4</span><span class="p">)]</span>
<a name="ln-74"></a>      <span class="k">end if</span>
<a name="ln-75"></a><span class="k">     else</span>
<a name="ln-76"></a><span class="k">      </span><span class="n">seed</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="mi">37</span><span class="o">*</span><span class="p">[(</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span>
<a name="ln-77"></a>     <span class="k">end if</span>
<a name="ln-78"></a><span class="k">    end if</span>
<a name="ln-79"></a><span class="k">   else</span>
<a name="ln-80"></a><span class="k">    </span><span class="n">seed</span> <span class="o">=</span> <span class="n">myrank</span>
<a name="ln-81"></a>   <span class="k">end if</span>
<a name="ln-82"></a><span class="k">   call </span><span class="nb">random_seed</span><span class="p">(</span><span class="n">put</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>
<a name="ln-83"></a>  <span class="k">end subroutine</span>
<a name="ln-84"></a>  <span class="c">!========================</span>
<a name="ln-85"></a>
<a name="ln-86"></a>  <span class="k">subroutine </span><span class="n">gasdev</span><span class="p">(</span><span class="n">dev</span><span class="p">)</span>
<a name="ln-87"></a>
<a name="ln-88"></a>   <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dev</span>
<a name="ln-89"></a>   <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">,</span> <span class="n">rsq</span>
<a name="ln-90"></a>   <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">save</span> <span class="kd">::</span> <span class="n">g</span>
<a name="ln-91"></a>   <span class="kt">logical</span><span class="p">,</span> <span class="k">save</span> <span class="kd">::</span> <span class="n">gaus_store</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-92"></a>
<a name="ln-93"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">gaus_store</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-94"></a><span class="k">    </span><span class="n">dev</span> <span class="o">=</span> <span class="n">g</span>
<a name="ln-95"></a>    <span class="n">gaus_store</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-96"></a>   <span class="k">else</span>
<a name="ln-97"></a><span class="k">    do</span>
<a name="ln-98"></a><span class="k">     call </span><span class="nb">random_number</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span>
<a name="ln-99"></a>     <span class="k">call </span><span class="nb">random_number</span><span class="p">(</span><span class="n">v2</span><span class="p">)</span>
<a name="ln-100"></a>     <span class="n">v1</span> <span class="o">=</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">v1</span> <span class="o">-</span> <span class="mf">1.0</span>
<a name="ln-101"></a>     <span class="n">v2</span> <span class="o">=</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">v2</span> <span class="o">-</span> <span class="mf">1.0</span>
<a name="ln-102"></a>     <span class="n">rsq</span> <span class="o">=</span> <span class="n">v1</span><span class="o">*</span><span class="n">v1</span> <span class="o">+</span> <span class="n">v2</span><span class="o">*</span><span class="n">v2</span>
<a name="ln-103"></a>     <span class="k">if</span> <span class="p">(</span><span class="n">rsq</span> <span class="o">&lt;</span> <span class="mf">1.0</span><span class="p">)</span> <span class="k">exit</span>
<a name="ln-104"></a><span class="k">    end do</span>
<a name="ln-105"></a><span class="k">    </span><span class="n">rsq</span> <span class="o">=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="o">-</span><span class="mf">2.0</span><span class="o">*</span><span class="nb">log</span><span class="p">(</span><span class="n">rsq</span><span class="p">)</span><span class="o">/</span><span class="n">rsq</span><span class="p">)</span>
<a name="ln-106"></a>    <span class="n">dev</span> <span class="o">=</span> <span class="n">v1</span><span class="o">*</span><span class="n">rsq</span>
<a name="ln-107"></a>    <span class="n">g</span> <span class="o">=</span> <span class="n">v2</span><span class="o">*</span><span class="n">rsq</span>
<a name="ln-108"></a>    <span class="n">gaus_store</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-109"></a>   <span class="k">end if</span>
<a name="ln-110"></a><span class="k">  end subroutine</span>
<a name="ln-111"></a>
<a name="ln-112"></a>  <span class="c">!===============================</span>
<a name="ln-113"></a>
<a name="ln-114"></a>  <span class="k">subroutine </span><span class="n">sort</span><span class="p">(</span><span class="n">part</span><span class="p">,</span> <span class="n">np</span><span class="p">)</span>
<a name="ln-115"></a>
<a name="ln-116"></a>   <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">part</span><span class="p">(:)</span>
<a name="ln-117"></a>   <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">np</span>
<a name="ln-118"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ir</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">jstack</span>
<a name="ln-119"></a>   <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">m</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span> <span class="n">nstack</span> <span class="o">=</span> <span class="mi">50</span>
<a name="ln-120"></a>   <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">a</span>
<a name="ln-121"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">istack</span><span class="p">(</span><span class="n">nstack</span><span class="p">)</span>
<a name="ln-122"></a>
<a name="ln-123"></a>   <span class="n">jstack</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-124"></a>   <span class="n">ir</span> <span class="o">=</span> <span class="n">np</span>
<a name="ln-125"></a>   <span class="n">l</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-126"></a>   <span class="k">do</span>
<a name="ln-127"></a><span class="k">    if</span> <span class="p">(</span><span class="n">ir</span> <span class="o">-</span> <span class="n">l</span> <span class="o">&lt;</span> <span class="n">m</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-128"></a><span class="k">     do </span><span class="n">j</span> <span class="o">=</span> <span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ir</span>
<a name="ln-129"></a>      <span class="n">a</span> <span class="o">=</span> <span class="n">part</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
<a name="ln-130"></a>      <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span>
<a name="ln-131"></a>       <span class="k">if</span> <span class="p">(</span><span class="n">part</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">a</span><span class="p">)</span> <span class="k">exit</span>
<a name="ln-132"></a><span class="k">       </span><span class="n">part</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">part</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-133"></a>      <span class="k">end do</span>
<a name="ln-134"></a><span class="k">      </span><span class="n">part</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">a</span>
<a name="ln-135"></a>     <span class="k">end do</span>
<a name="ln-136"></a><span class="k">     if</span> <span class="p">(</span><span class="n">jstack</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-137"></a><span class="k">     </span><span class="n">ir</span> <span class="o">=</span> <span class="n">istack</span><span class="p">(</span><span class="n">jstack</span><span class="p">)</span>
<a name="ln-138"></a>     <span class="n">l</span> <span class="o">=</span> <span class="n">istack</span><span class="p">(</span><span class="n">jstack</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-139"></a>     <span class="n">jstack</span> <span class="o">=</span> <span class="n">jstack</span> <span class="o">-</span> <span class="mi">2</span>
<a name="ln-140"></a>    <span class="k">else</span>
<a name="ln-141"></a><span class="k">     </span><span class="n">k</span> <span class="o">=</span> <span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="n">ir</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
<a name="ln-142"></a>     <span class="k">call </span><span class="n">swap</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-143"></a>
<a name="ln-144"></a>     <span class="k">if</span> <span class="p">(</span><span class="n">part</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">part</span><span class="p">(</span><span class="n">ir</span><span class="p">))</span> <span class="k">call </span><span class="n">swap</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">ir</span><span class="p">)</span>
<a name="ln-145"></a>     <span class="k">if</span> <span class="p">(</span><span class="n">part</span><span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">part</span><span class="p">(</span><span class="n">ir</span><span class="p">))</span> <span class="k">call </span><span class="n">swap</span><span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ir</span><span class="p">)</span>
<a name="ln-146"></a>     <span class="k">if</span> <span class="p">(</span><span class="n">part</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">part</span><span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="k">call </span><span class="n">swap</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-147"></a>
<a name="ln-148"></a>     <span class="n">i</span> <span class="o">=</span> <span class="n">l</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-149"></a>     <span class="n">j</span> <span class="o">=</span> <span class="n">ir</span>
<a name="ln-150"></a>     <span class="n">a</span> <span class="o">=</span> <span class="n">part</span><span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-151"></a>     <span class="k">do</span>
<a name="ln-152"></a><span class="k">      do</span>
<a name="ln-153"></a><span class="k">       </span><span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-154"></a>       <span class="k">if</span> <span class="p">(</span><span class="n">part</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">a</span><span class="p">)</span> <span class="k">exit</span>
<a name="ln-155"></a><span class="k">      end do</span>
<a name="ln-156"></a><span class="k">      do</span>
<a name="ln-157"></a><span class="k">       </span><span class="n">j</span> <span class="o">=</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-158"></a>       <span class="k">if</span> <span class="p">(</span><span class="n">part</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">a</span><span class="p">)</span> <span class="k">exit</span>
<a name="ln-159"></a><span class="k">      end do</span>
<a name="ln-160"></a><span class="k">      if</span> <span class="p">(</span><span class="n">j</span> <span class="o">&lt;</span> <span class="n">i</span><span class="p">)</span> <span class="k">exit</span>
<a name="ln-161"></a><span class="k">      call </span><span class="n">swap</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
<a name="ln-162"></a>     <span class="k">end do</span>
<a name="ln-163"></a><span class="k">     </span><span class="n">part</span><span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">part</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
<a name="ln-164"></a>     <span class="n">part</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">a</span>
<a name="ln-165"></a>     <span class="n">jstack</span> <span class="o">=</span> <span class="n">jstack</span> <span class="o">+</span> <span class="mi">2</span>
<a name="ln-166"></a>     <span class="k">if</span> <span class="p">(</span><span class="n">jstack</span> <span class="o">&gt;</span> <span class="n">nstack</span><span class="p">)</span> <span class="k">exit</span>
<a name="ln-167"></a><span class="k">     if</span> <span class="p">(</span><span class="n">ir</span> <span class="o">-</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&gt;=</span> <span class="n">j</span> <span class="o">-</span> <span class="n">l</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-168"></a><span class="k">      </span><span class="n">istack</span><span class="p">(</span><span class="n">jstack</span><span class="p">)</span> <span class="o">=</span> <span class="n">ir</span>
<a name="ln-169"></a>      <span class="n">istack</span><span class="p">(</span><span class="n">jstack</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">i</span>
<a name="ln-170"></a>      <span class="n">ir</span> <span class="o">=</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-171"></a>     <span class="k">else</span>
<a name="ln-172"></a><span class="k">      </span><span class="n">istack</span><span class="p">(</span><span class="n">jstack</span><span class="p">)</span> <span class="o">=</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-173"></a>      <span class="n">istack</span><span class="p">(</span><span class="n">jstack</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">l</span>
<a name="ln-174"></a>      <span class="n">l</span> <span class="o">=</span> <span class="n">i</span>
<a name="ln-175"></a>     <span class="k">end if</span>
<a name="ln-176"></a><span class="k">    end if</span>
<a name="ln-177"></a><span class="k">   end do</span>
<a name="ln-178"></a>
<a name="ln-179"></a><span class="k">  contains</span>
<a name="ln-180"></a>
<a name="ln-181"></a><span class="k">   subroutine </span><span class="n">swap</span><span class="p">(</span><span class="n">i1</span><span class="p">,</span> <span class="n">i2</span><span class="p">)</span>
<a name="ln-182"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">i1</span><span class="p">,</span> <span class="n">i2</span>
<a name="ln-183"></a>    <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">temp</span>
<a name="ln-184"></a>
<a name="ln-185"></a>    <span class="n">temp</span> <span class="o">=</span> <span class="n">part</span><span class="p">(</span><span class="n">i1</span><span class="p">)</span>
<a name="ln-186"></a>    <span class="n">part</span><span class="p">(</span><span class="n">i1</span><span class="p">)</span> <span class="o">=</span> <span class="n">part</span><span class="p">(</span><span class="n">i2</span><span class="p">)</span>
<a name="ln-187"></a>    <span class="n">part</span><span class="p">(</span><span class="n">i2</span><span class="p">)</span> <span class="o">=</span> <span class="n">temp</span>
<a name="ln-188"></a>
<a name="ln-189"></a>   <span class="k">end subroutine</span>
<a name="ln-190"></a>
<a name="ln-191"></a><span class="k">  end subroutine</span>
<a name="ln-192"></a>
<a name="ln-193"></a>  <span class="c">!=========================</span>
<a name="ln-194"></a>
<a name="ln-195"></a>  <span class="k">subroutine </span><span class="n">vsort</span><span class="p">(</span><span class="n">part</span><span class="p">,</span> <span class="n">np</span><span class="p">,</span> <span class="n">ndv</span><span class="p">,</span> <span class="n">dir</span><span class="p">)</span>
<a name="ln-196"></a>
<a name="ln-197"></a>   <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">part</span><span class="p">(:,</span> <span class="p">:)</span>
<a name="ln-198"></a>   <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">np</span><span class="p">,</span> <span class="n">ndv</span><span class="p">,</span> <span class="n">dir</span>
<a name="ln-199"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ir</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">jstack</span>
<a name="ln-200"></a>   <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">m</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span> <span class="n">nstack</span> <span class="o">=</span> <span class="mi">50</span>
<a name="ln-201"></a>   <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">a</span><span class="p">(</span><span class="n">ndv</span><span class="p">),</span> <span class="n">temp</span><span class="p">(</span><span class="n">ndv</span><span class="p">)</span>
<a name="ln-202"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">istack</span><span class="p">(</span><span class="n">nstack</span><span class="p">)</span>
<a name="ln-203"></a>
<a name="ln-204"></a>   <span class="n">jstack</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-205"></a>   <span class="n">ir</span> <span class="o">=</span> <span class="n">np</span>
<a name="ln-206"></a>   <span class="n">l</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-207"></a>   <span class="k">do</span>
<a name="ln-208"></a><span class="k">    if</span> <span class="p">(</span><span class="n">ir</span> <span class="o">-</span> <span class="n">l</span> <span class="o">&lt;</span> <span class="n">m</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-209"></a><span class="k">     do </span><span class="n">j</span> <span class="o">=</span> <span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ir</span>
<a name="ln-210"></a>      <span class="n">a</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">ndv</span><span class="p">)</span> <span class="o">=</span> <span class="n">part</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">ndv</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
<a name="ln-211"></a>      <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span>
<a name="ln-212"></a>       <span class="k">if</span> <span class="p">(</span><span class="n">part</span><span class="p">(</span><span class="n">dir</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">a</span><span class="p">(</span><span class="n">dir</span><span class="p">))</span> <span class="k">exit</span>
<a name="ln-213"></a><span class="k">       </span><span class="n">part</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">ndv</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">part</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">ndv</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
<a name="ln-214"></a>      <span class="k">end do</span>
<a name="ln-215"></a><span class="k">      </span><span class="n">part</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">ndv</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">a</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">ndv</span><span class="p">)</span>
<a name="ln-216"></a>     <span class="k">end do</span>
<a name="ln-217"></a><span class="k">     if</span> <span class="p">(</span><span class="n">jstack</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-218"></a><span class="k">     </span><span class="n">ir</span> <span class="o">=</span> <span class="n">istack</span><span class="p">(</span><span class="n">jstack</span><span class="p">)</span>
<a name="ln-219"></a>     <span class="n">l</span> <span class="o">=</span> <span class="n">istack</span><span class="p">(</span><span class="n">jstack</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-220"></a>     <span class="n">jstack</span> <span class="o">=</span> <span class="n">jstack</span> <span class="o">-</span> <span class="mi">2</span>
<a name="ln-221"></a>    <span class="k">else</span>
<a name="ln-222"></a><span class="k">     </span><span class="n">k</span> <span class="o">=</span> <span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="n">ir</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
<a name="ln-223"></a>     <span class="k">call </span><span class="n">swap</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ndv</span><span class="p">)</span>
<a name="ln-224"></a>
<a name="ln-225"></a>     <span class="k">if</span> <span class="p">(</span><span class="n">part</span><span class="p">(</span><span class="n">dir</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">part</span><span class="p">(</span><span class="n">dir</span><span class="p">,</span> <span class="n">ir</span><span class="p">))</span> <span class="k">call </span><span class="n">swap</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">ir</span><span class="p">,</span> <span class="n">ndv</span><span class="p">)</span>
<a name="ln-226"></a>     <span class="k">if</span> <span class="p">(</span><span class="n">part</span><span class="p">(</span><span class="n">dir</span><span class="p">,</span> <span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">part</span><span class="p">(</span><span class="n">dir</span><span class="p">,</span> <span class="n">ir</span><span class="p">))</span> <span class="k">call </span><span class="n">swap</span><span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ir</span><span class="p">,</span> <span class="n">ndv</span><span class="p">)</span>
<a name="ln-227"></a>     <span class="k">if</span> <span class="p">(</span><span class="n">part</span><span class="p">(</span><span class="n">dir</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">part</span><span class="p">(</span><span class="n">dir</span><span class="p">,</span> <span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="k">call </span><span class="n">swap</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ndv</span><span class="p">)</span>
<a name="ln-228"></a>
<a name="ln-229"></a>     <span class="n">i</span> <span class="o">=</span> <span class="n">l</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-230"></a>     <span class="n">j</span> <span class="o">=</span> <span class="n">ir</span>
<a name="ln-231"></a>     <span class="n">a</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">ndv</span><span class="p">)</span> <span class="o">=</span> <span class="n">part</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">ndv</span><span class="p">,</span> <span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-232"></a>     <span class="k">do</span>
<a name="ln-233"></a><span class="k">      do</span>
<a name="ln-234"></a><span class="k">       </span><span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-235"></a>       <span class="k">if</span> <span class="p">(</span><span class="n">part</span><span class="p">(</span><span class="n">dir</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">a</span><span class="p">(</span><span class="n">dir</span><span class="p">))</span> <span class="k">exit</span>
<a name="ln-236"></a><span class="k">      end do</span>
<a name="ln-237"></a><span class="k">      do</span>
<a name="ln-238"></a><span class="k">       </span><span class="n">j</span> <span class="o">=</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-239"></a>       <span class="k">if</span> <span class="p">(</span><span class="n">part</span><span class="p">(</span><span class="n">dir</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">a</span><span class="p">(</span><span class="n">dir</span><span class="p">))</span> <span class="k">exit</span>
<a name="ln-240"></a><span class="k">      end do</span>
<a name="ln-241"></a><span class="k">      if</span> <span class="p">(</span><span class="n">j</span> <span class="o">&lt;</span> <span class="n">i</span><span class="p">)</span> <span class="k">exit</span>
<a name="ln-242"></a><span class="k">      call </span><span class="n">swap</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">ndv</span><span class="p">)</span>
<a name="ln-243"></a>     <span class="k">end do</span>
<a name="ln-244"></a><span class="k">     </span><span class="n">part</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">ndv</span><span class="p">,</span> <span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">part</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">ndv</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
<a name="ln-245"></a>     <span class="n">part</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">ndv</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">a</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">ndv</span><span class="p">)</span>
<a name="ln-246"></a>     <span class="n">jstack</span> <span class="o">=</span> <span class="n">jstack</span> <span class="o">+</span> <span class="mi">2</span>
<a name="ln-247"></a>     <span class="k">if</span> <span class="p">(</span><span class="n">jstack</span> <span class="o">&gt;</span> <span class="n">nstack</span><span class="p">)</span> <span class="k">exit</span>
<a name="ln-248"></a><span class="k">     if</span> <span class="p">(</span><span class="n">ir</span> <span class="o">-</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&gt;=</span> <span class="n">j</span> <span class="o">-</span> <span class="n">l</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-249"></a><span class="k">      </span><span class="n">istack</span><span class="p">(</span><span class="n">jstack</span><span class="p">)</span> <span class="o">=</span> <span class="n">ir</span>
<a name="ln-250"></a>      <span class="n">istack</span><span class="p">(</span><span class="n">jstack</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">i</span>
<a name="ln-251"></a>      <span class="n">ir</span> <span class="o">=</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-252"></a>     <span class="k">else</span>
<a name="ln-253"></a><span class="k">      </span><span class="n">istack</span><span class="p">(</span><span class="n">jstack</span><span class="p">)</span> <span class="o">=</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-254"></a>      <span class="n">istack</span><span class="p">(</span><span class="n">jstack</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">l</span>
<a name="ln-255"></a>      <span class="n">l</span> <span class="o">=</span> <span class="n">i</span>
<a name="ln-256"></a>     <span class="k">end if</span>
<a name="ln-257"></a><span class="k">    end if</span>
<a name="ln-258"></a><span class="k">   end do</span>
<a name="ln-259"></a>
<a name="ln-260"></a><span class="k">  contains</span>
<a name="ln-261"></a>
<a name="ln-262"></a><span class="k">   subroutine </span><span class="n">swap</span><span class="p">(</span><span class="n">i1</span><span class="p">,</span> <span class="n">i2</span><span class="p">,</span> <span class="n">nd</span><span class="p">)</span>
<a name="ln-263"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">i1</span><span class="p">,</span> <span class="n">i2</span><span class="p">,</span> <span class="n">nd</span>
<a name="ln-264"></a>
<a name="ln-265"></a>    <span class="n">temp</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nd</span><span class="p">)</span> <span class="o">=</span> <span class="n">part</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nd</span><span class="p">,</span> <span class="n">i1</span><span class="p">)</span>
<a name="ln-266"></a>    <span class="n">part</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nd</span><span class="p">,</span> <span class="n">i1</span><span class="p">)</span> <span class="o">=</span> <span class="n">part</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nd</span><span class="p">,</span> <span class="n">i2</span><span class="p">)</span>
<a name="ln-267"></a>    <span class="n">part</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nd</span><span class="p">,</span> <span class="n">i2</span><span class="p">)</span> <span class="o">=</span> <span class="n">temp</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nd</span><span class="p">)</span>
<a name="ln-268"></a>
<a name="ln-269"></a>   <span class="k">end subroutine</span>
<a name="ln-270"></a>
<a name="ln-271"></a><span class="k">  end subroutine</span>
<a name="ln-272"></a>
<a name="ln-273"></a>  <span class="c">!===========================</span>
<a name="ln-274"></a>  <span class="k">subroutine </span><span class="n">bunch_gen</span><span class="p">(</span><span class="n">ndm</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">n2</span><span class="p">,</span> <span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">,</span> <span class="n">sz</span><span class="p">,</span> <span class="n">gm</span><span class="p">,</span> <span class="n">ey</span><span class="p">,</span> <span class="n">ez</span><span class="p">,</span> <span class="n">cut</span><span class="p">,</span> <span class="n">dg</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-275"></a>                       <span class="n">bunch</span><span class="p">)</span>
<a name="ln-276"></a>   <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ndm</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">n2</span>
<a name="ln-277"></a>   <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">,</span> <span class="n">sz</span><span class="p">,</span> <span class="n">gm</span><span class="p">,</span> <span class="n">ey</span><span class="p">,</span> <span class="n">ez</span><span class="p">,</span> <span class="n">cut</span><span class="p">,</span> <span class="n">dg</span>
<a name="ln-278"></a>   <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">bunch</span><span class="p">(:,</span> <span class="p">:)</span>
<a name="ln-279"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">np</span>
<a name="ln-280"></a>   <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">sigs</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-281"></a>   <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">xm</span><span class="p">,</span> <span class="n">ym</span><span class="p">,</span> <span class="n">zm</span><span class="p">,</span> <span class="n">pxm</span><span class="p">,</span> <span class="n">pym</span><span class="p">,</span> <span class="n">pzm</span>
<a name="ln-282"></a>   <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">,</span> <span class="n">rnd</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">np_norm</span>
<a name="ln-283"></a>
<a name="ln-284"></a>   <span class="c">!============= ey,ez are emittances (in mm-microns)</span>
<a name="ln-285"></a>   <span class="c">! FIX emittances are ALWAYS a dimension times an angle...</span>
<a name="ln-286"></a>   <span class="c">! so this (in mm-micron) doesn&#39;t make any sense</span>
<a name="ln-287"></a>   <span class="c">! dg=d(gamma)/gamma (%)</span>
<a name="ln-288"></a>   <span class="c">! dp_y=ey/s_y dp_z=ez/s_z dp_x=d(gamma)</span>
<a name="ln-289"></a>   <span class="c">!=============================================</span>
<a name="ln-290"></a>
<a name="ln-291"></a>   <span class="c">!Distribute (x,y,z,px,py,pz) centered on 0; px=&gt; px+gamma</span>
<a name="ln-292"></a>
<a name="ln-293"></a>   <span class="k">select case</span> <span class="p">(</span><span class="n">ndm</span><span class="p">)</span>
<a name="ln-294"></a>   <span class="k">case</span> <span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-295"></a>    <span class="n">sigs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">sx</span>
<a name="ln-296"></a>    <span class="n">sigs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">sy</span>
<a name="ln-297"></a>    <span class="n">sigs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span><span class="o">*</span><span class="mf">0.01</span><span class="o">*</span><span class="n">dg</span><span class="o">*</span><span class="n">gm</span> <span class="c">!dpz</span>
<a name="ln-298"></a>    <span class="n">sigs</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">ey</span><span class="o">/</span><span class="n">sy</span>
<a name="ln-299"></a>    <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">n1</span><span class="p">,</span> <span class="n">n2</span>
<a name="ln-300"></a>     <span class="k">do</span>
<a name="ln-301"></a><span class="k">      call </span><span class="nb">random_number</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span>
<a name="ln-302"></a>      <span class="k">call </span><span class="nb">random_number</span><span class="p">(</span><span class="n">v2</span><span class="p">)</span>
<a name="ln-303"></a>      <span class="n">v1</span> <span class="o">=</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">v1</span> <span class="o">-</span> <span class="mf">1.0</span>
<a name="ln-304"></a>      <span class="n">v2</span> <span class="o">=</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">v2</span> <span class="o">-</span> <span class="mf">1.0</span>
<a name="ln-305"></a>      <span class="n">rnd</span> <span class="o">=</span> <span class="n">v1</span><span class="o">*</span><span class="n">v1</span> <span class="o">+</span> <span class="n">v2</span><span class="o">*</span><span class="n">v2</span>
<a name="ln-306"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">rnd</span> <span class="o">&lt;</span> <span class="mf">1.0</span><span class="p">)</span> <span class="k">exit</span>
<a name="ln-307"></a><span class="k">     end do</span>
<a name="ln-308"></a><span class="k">     </span><span class="n">rnd</span> <span class="o">=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="o">-</span><span class="mf">2.0</span><span class="o">*</span><span class="nb">log</span><span class="p">(</span><span class="n">rnd</span><span class="p">)</span><span class="o">/</span><span class="n">rnd</span><span class="p">)</span>
<a name="ln-309"></a>     <span class="n">bunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">v1</span><span class="o">*</span><span class="n">rnd</span>
<a name="ln-310"></a>     <span class="n">bunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">v2</span><span class="o">*</span><span class="n">rnd</span>
<a name="ln-311"></a>     <span class="k">call </span><span class="n">gasdev</span><span class="p">(</span><span class="n">rnd</span><span class="p">)</span>
<a name="ln-312"></a>     <span class="n">bunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">rnd</span>
<a name="ln-313"></a>     <span class="k">do</span>
<a name="ln-314"></a><span class="k">      call </span><span class="nb">random_number</span><span class="p">(</span><span class="n">rnd</span><span class="p">)</span>
<a name="ln-315"></a>      <span class="n">rnd</span> <span class="o">=</span> <span class="mf">2.</span><span class="o">*</span><span class="n">rnd</span> <span class="o">-</span> <span class="mf">1.</span>
<a name="ln-316"></a>      <span class="n">a</span> <span class="o">=</span> <span class="n">cut</span><span class="o">*</span><span class="n">rnd</span>
<a name="ln-317"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">a</span> <span class="o">&lt;</span> <span class="mf">1.</span><span class="p">)</span> <span class="k">exit</span>
<a name="ln-318"></a><span class="k">     end do</span>
<a name="ln-319"></a><span class="k">     </span><span class="n">bunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">a</span>
<a name="ln-320"></a>    <span class="k">end do</span>
<a name="ln-321"></a><span class="k">    do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span>
<a name="ln-322"></a>     <span class="n">bunch</span><span class="p">(</span><span class="n">n1</span><span class="p">:</span><span class="n">n2</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">sigs</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="n">bunch</span><span class="p">(</span><span class="n">n1</span><span class="p">:</span><span class="n">n2</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
<a name="ln-323"></a>    <span class="k">end do</span>
<a name="ln-324"></a><span class="k">    </span><span class="n">bunch</span><span class="p">(</span><span class="n">n1</span><span class="p">:</span><span class="n">n2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">bunch</span><span class="p">(</span><span class="n">n1</span><span class="p">:</span><span class="n">n2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">gm</span>
<a name="ln-325"></a>    <span class="n">xm</span> <span class="o">=</span> <span class="mf">0.0</span>
<a name="ln-326"></a>    <span class="n">ym</span> <span class="o">=</span> <span class="mf">0.0</span>
<a name="ln-327"></a>    <span class="n">pxm</span> <span class="o">=</span> <span class="mf">0.0</span>
<a name="ln-328"></a>    <span class="n">pym</span> <span class="o">=</span> <span class="mf">0.0</span>
<a name="ln-329"></a>    <span class="c">! Reset centering</span>
<a name="ln-330"></a>    <span class="n">xm</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">bunch</span><span class="p">(</span><span class="n">n1</span><span class="p">:</span><span class="n">n2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<a name="ln-331"></a>    <span class="n">ym</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">bunch</span><span class="p">(</span><span class="n">n1</span><span class="p">:</span><span class="n">n2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<a name="ln-332"></a>    <span class="n">pxm</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">bunch</span><span class="p">(</span><span class="n">n1</span><span class="p">:</span><span class="n">n2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<a name="ln-333"></a>    <span class="n">pym</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">bunch</span><span class="p">(</span><span class="n">n1</span><span class="p">:</span><span class="n">n2</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<a name="ln-334"></a>
<a name="ln-335"></a>    <span class="n">np</span> <span class="o">=</span> <span class="n">n2</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">n1</span>
<a name="ln-336"></a>    <span class="n">xm</span> <span class="o">=</span> <span class="n">xm</span><span class="o">/</span><span class="kt">real</span><span class="p">(</span><span class="n">np</span><span class="p">,</span> <span class="n">dp</span><span class="p">)</span>
<a name="ln-337"></a>    <span class="n">ym</span> <span class="o">=</span> <span class="n">ym</span><span class="o">/</span><span class="kt">real</span><span class="p">(</span><span class="n">np</span><span class="p">,</span> <span class="n">dp</span><span class="p">)</span>
<a name="ln-338"></a>    <span class="n">pxm</span> <span class="o">=</span> <span class="n">pxm</span><span class="o">/</span><span class="kt">real</span><span class="p">(</span><span class="n">np</span><span class="p">,</span> <span class="n">dp</span><span class="p">)</span>
<a name="ln-339"></a>    <span class="n">pym</span> <span class="o">=</span> <span class="n">pym</span><span class="o">/</span><span class="kt">real</span><span class="p">(</span><span class="n">np</span><span class="p">,</span> <span class="n">dp</span><span class="p">)</span>
<a name="ln-340"></a>    <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">n1</span><span class="p">,</span> <span class="n">n2</span>
<a name="ln-341"></a>     <span class="n">bunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">bunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">xm</span>
<a name="ln-342"></a>     <span class="n">bunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">bunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">ym</span>
<a name="ln-343"></a>     <span class="n">bunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">bunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">pxm</span> <span class="o">-</span> <span class="n">gm</span><span class="p">)</span>
<a name="ln-344"></a>     <span class="n">bunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">bunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-</span> <span class="n">pym</span>
<a name="ln-345"></a>    <span class="k">end do</span>
<a name="ln-346"></a><span class="k">   case</span> <span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-347"></a>    <span class="n">sigs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">sx</span>
<a name="ln-348"></a>    <span class="n">sigs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">sy</span>
<a name="ln-349"></a>    <span class="n">sigs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">sz</span>
<a name="ln-350"></a>    <span class="n">sigs</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span><span class="o">*</span><span class="mf">0.01</span><span class="o">*</span><span class="n">dg</span><span class="o">*</span><span class="n">gm</span> <span class="c">!dpz</span>
<a name="ln-351"></a>    <span class="n">sigs</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">ey</span><span class="o">/</span><span class="n">sy</span>
<a name="ln-352"></a>    <span class="n">sigs</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="n">ez</span><span class="o">/</span><span class="n">sz</span>
<a name="ln-353"></a>    <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span>
<a name="ln-354"></a>     <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">n1</span><span class="p">,</span> <span class="n">n2</span>
<a name="ln-355"></a>      <span class="k">do</span>
<a name="ln-356"></a><span class="k">       call </span><span class="nb">random_number</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span>
<a name="ln-357"></a>       <span class="k">call </span><span class="nb">random_number</span><span class="p">(</span><span class="n">v2</span><span class="p">)</span>
<a name="ln-358"></a>       <span class="n">v1</span> <span class="o">=</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">v1</span> <span class="o">-</span> <span class="mf">1.0</span>
<a name="ln-359"></a>       <span class="n">v2</span> <span class="o">=</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">v2</span> <span class="o">-</span> <span class="mf">1.0</span>
<a name="ln-360"></a>       <span class="n">rnd</span> <span class="o">=</span> <span class="n">v1</span><span class="o">*</span><span class="n">v1</span> <span class="o">+</span> <span class="n">v2</span><span class="o">*</span><span class="n">v2</span>
<a name="ln-361"></a>       <span class="k">if</span> <span class="p">(</span><span class="n">rnd</span> <span class="o">&lt;</span> <span class="mf">1.0</span><span class="p">)</span> <span class="k">exit</span>
<a name="ln-362"></a><span class="k">      end do</span>
<a name="ln-363"></a><span class="k">      </span><span class="n">rnd</span> <span class="o">=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="o">-</span><span class="mf">2.0</span><span class="o">*</span><span class="nb">log</span><span class="p">(</span><span class="n">rnd</span><span class="p">)</span><span class="o">/</span><span class="n">rnd</span><span class="p">)</span>
<a name="ln-364"></a>      <span class="n">bunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">v1</span><span class="o">*</span><span class="n">rnd</span>
<a name="ln-365"></a>      <span class="n">bunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">v2</span><span class="o">*</span><span class="n">rnd</span>
<a name="ln-366"></a>     <span class="k">end do</span>
<a name="ln-367"></a><span class="k">    </span><span class="n">enddo</span>
<a name="ln-368"></a>    <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-369"></a>    <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">n1</span><span class="p">,</span> <span class="n">n2</span>
<a name="ln-370"></a>     <span class="k">call </span><span class="n">gasdev</span><span class="p">(</span><span class="n">rnd</span><span class="p">)</span>
<a name="ln-371"></a>     <span class="n">bunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">rnd</span>
<a name="ln-372"></a>     <span class="k">do</span>
<a name="ln-373"></a><span class="k">      call </span><span class="nb">random_number</span><span class="p">(</span><span class="n">rnd</span><span class="p">)</span>
<a name="ln-374"></a>      <span class="n">rnd</span> <span class="o">=</span> <span class="mf">2.</span><span class="o">*</span><span class="n">rnd</span> <span class="o">-</span> <span class="mf">1.</span>
<a name="ln-375"></a>      <span class="n">a</span> <span class="o">=</span> <span class="n">cut</span><span class="o">*</span><span class="n">rnd</span>
<a name="ln-376"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">a</span> <span class="o">&lt;</span> <span class="mf">1.</span><span class="p">)</span> <span class="k">exit</span>
<a name="ln-377"></a><span class="k">     end do</span>
<a name="ln-378"></a><span class="k">     </span><span class="n">bunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">a</span>
<a name="ln-379"></a>    <span class="k">end do</span>
<a name="ln-380"></a><span class="c">!======================</span>
<a name="ln-381"></a>    <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span>
<a name="ln-382"></a>     <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">n1</span><span class="p">,</span> <span class="n">n2</span>
<a name="ln-383"></a>      <span class="n">bunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">sigs</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="n">bunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
<a name="ln-384"></a>     <span class="k">end do</span>
<a name="ln-385"></a><span class="k">    end do</span>
<a name="ln-386"></a><span class="k">    </span><span class="n">bunch</span><span class="p">(</span><span class="n">n1</span><span class="p">:</span><span class="n">n2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">bunch</span><span class="p">(</span><span class="n">n1</span><span class="p">:</span><span class="n">n2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="n">gm</span>
<a name="ln-387"></a>
<a name="ln-388"></a>    <span class="n">xm</span> <span class="o">=</span> <span class="mf">0.0</span>
<a name="ln-389"></a>    <span class="n">ym</span> <span class="o">=</span> <span class="mf">0.0</span>
<a name="ln-390"></a>    <span class="n">zm</span> <span class="o">=</span> <span class="mf">0.0</span>
<a name="ln-391"></a>    <span class="n">pxm</span> <span class="o">=</span> <span class="mf">0.0</span>
<a name="ln-392"></a>    <span class="n">pym</span> <span class="o">=</span> <span class="mf">0.0</span>
<a name="ln-393"></a>    <span class="n">pzm</span> <span class="o">=</span> <span class="mf">0.0</span>
<a name="ln-394"></a>
<a name="ln-395"></a>    <span class="c">! Reset centering</span>
<a name="ln-396"></a>    <span class="n">np</span> <span class="o">=</span> <span class="n">n2</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">n1</span>
<a name="ln-397"></a>    <span class="n">np_norm</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="kt">real</span><span class="p">(</span><span class="n">np</span><span class="p">,</span> <span class="n">dp</span><span class="p">)</span>
<a name="ln-398"></a>    <span class="n">xm</span> <span class="o">=</span> <span class="n">np_norm</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">bunch</span><span class="p">(</span><span class="n">n1</span><span class="p">:</span><span class="n">n2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<a name="ln-399"></a>    <span class="n">ym</span> <span class="o">=</span> <span class="n">np_norm</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">bunch</span><span class="p">(</span><span class="n">n1</span><span class="p">:</span><span class="n">n2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<a name="ln-400"></a>    <span class="n">zm</span> <span class="o">=</span> <span class="n">np_norm</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">bunch</span><span class="p">(</span><span class="n">n1</span><span class="p">:</span><span class="n">n2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<a name="ln-401"></a>    <span class="n">pxm</span> <span class="o">=</span> <span class="n">np_norm</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">bunch</span><span class="p">(</span><span class="n">n1</span><span class="p">:</span><span class="n">n2</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<a name="ln-402"></a>    <span class="n">pym</span> <span class="o">=</span> <span class="n">np_norm</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">bunch</span><span class="p">(</span><span class="n">n1</span><span class="p">:</span><span class="n">n2</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<a name="ln-403"></a>    <span class="n">pzm</span> <span class="o">=</span> <span class="n">np_norm</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">bunch</span><span class="p">(</span><span class="n">n1</span><span class="p">:</span><span class="n">n2</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<a name="ln-404"></a>
<a name="ln-405"></a>    <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">n1</span><span class="p">,</span> <span class="n">n2</span>
<a name="ln-406"></a>     <span class="n">bunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">bunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">xm</span>
<a name="ln-407"></a>     <span class="n">bunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">bunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">ym</span>
<a name="ln-408"></a>     <span class="n">bunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">bunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="n">zm</span>
<a name="ln-409"></a>     <span class="n">bunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">bunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">pxm</span> <span class="o">-</span> <span class="n">gm</span><span class="p">)</span>
<a name="ln-410"></a>     <span class="n">bunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">bunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="o">-</span> <span class="n">pym</span>
<a name="ln-411"></a>     <span class="n">bunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="n">bunch</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="n">pzm</span>
<a name="ln-412"></a>    <span class="k">end do</span>
<a name="ln-413"></a><span class="k">   end select</span>
<a name="ln-414"></a><span class="k">  end subroutine</span>
<a name="ln-415"></a>
<a name="ln-416"></a><span class="k"> end module</span>
</pre></div>

    </section>
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2020 <a rel="license" href="http://www.gnu.org/licenses/old-licenses/fdl-1.2.en.html">GNU Free Documentation License</a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
             on 2020-07-30 
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> ALaDyn was developed by The ALaDyn Collaboration</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>