<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="A High-Accuracy PIC Code for the Maxwell-Vlasov Equations">
    
    <meta name="author" content="The ALaDyn Collaboration" >
    <link rel="icon" href="../favicon.png">

    <title>curr_and_fields_util.f90 &ndash; ALaDyn</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">ALaDyn <small>3.0.1</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>Guide</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../program/aladyn.html">Program</a></li>
      
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/aladyn.html">Program</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>curr_and_fields_util.f90
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 1.0% of total for source files.">235 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/curr_and_fields_util.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
  
     <li class="active">curr_and_fields_util.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/curr_and_fields_util.html">curr_and_fields_util</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/curr_and_fields_util.f90.html#src">curr_and_fields_util.f90</a>
  </div>
</div>



</div>

    </div>
    <div class="col-md-9" id='text'>
      
      <br>
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">This file depends on</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~curr_and_fields_util.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefilecurr_and_fields_utilf90EfferentGraph" width="641pt" height="213pt"
 viewBox="0.00 0.00 641.00 212.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph" class="graph" transform="scale(.5979 .5979) rotate(0) translate(4 351.3905)">
<title>sourcefile~~curr_and_fields_util.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-351.3905 1068,-351.3905 1068,4 -4,4"/>
<!-- sourcefile~curr_and_fields_util.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~curr_and_fields_util.f90</title>
<polygon fill="none" stroke="#000000" points="1064,-292.9439 928,-292.9439 928,-268.9439 1064,-268.9439 1064,-292.9439"/>
<text text-anchor="middle" x="996" y="-278.5439" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">curr_and_fields_util.f90</text>
</g>
<!-- sourcefile~mpi_curr_interface.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~mpi_curr_interface.f90</title>
<g id="a_sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node2"><a xlink:href=".././sourcefile/mpi_curr_interface.f90.html" xlink:title="mpi_curr_interface.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="726,-213.9439 593,-213.9439 593,-189.9439 726,-189.9439 726,-213.9439"/>
<text text-anchor="middle" x="659.5" y="-199.5439" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mpi_curr_interface.f90</text>
</a>
</g>
</g>
<!-- sourcefile~curr_and_fields_util.f90&#45;&gt;sourcefile~mpi_curr_interface.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~curr_and_fields_util.f90&#45;&gt;sourcefile~mpi_curr_interface.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M827.5,-201.9439C798.5854,-193.0044 765.5093,-191.3118 736.3957,-192.4601"/>
<polygon fill="#ff0000" stroke="#ff0000" points="736.0847,-188.9713 726.2765,-192.9775 736.4422,-195.9622 736.0847,-188.9713"/>
</g>
<!-- sourcefile~mpi_field_interface.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~mpi_field_interface.f90</title>
<g id="a_sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node3"><a xlink:href=".././sourcefile/mpi_field_interface.f90.html" xlink:title="mpi_field_interface.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="727,-171.9439 592,-171.9439 592,-147.9439 727,-147.9439 727,-171.9439"/>
<text text-anchor="middle" x="659.5" y="-157.5439" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mpi_field_interface.f90</text>
</a>
</g>
</g>
<!-- sourcefile~curr_and_fields_util.f90&#45;&gt;sourcefile~mpi_field_interface.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge8" class="edge">
<title>sourcefile~curr_and_fields_util.f90&#45;&gt;sourcefile~mpi_field_interface.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M827.5,-201.9439C793.6771,-191.4869 755.4239,-181.7634 723.9725,-174.3112"/>
<polygon fill="#ff0000" stroke="#ff0000" points="724.5496,-170.8515 714.0143,-171.9734 722.9497,-177.6663 724.5496,-170.8515"/>
</g>
<!-- sourcefile~pstruct_data.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~pstruct_data.f90</title>
<g id="a_sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node4"><a xlink:href=".././sourcefile/pstruct_data.f90.html" xlink:title="pstruct_data.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="544,-295.9439 445,-295.9439 445,-271.9439 544,-271.9439 544,-295.9439"/>
<text text-anchor="middle" x="494.5" y="-281.5439" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pstruct_data.f90</text>
</a>
</g>
</g>
<!-- sourcefile~curr_and_fields_util.f90&#45;&gt;sourcefile~pstruct_data.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~curr_and_fields_util.f90&#45;&gt;sourcefile~pstruct_data.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M965.1579,-292.9909C896.9779,-317.9233 728.658,-370.1084 592,-335.9439 565.4899,-329.3164 538.2954,-313.9652 519.3856,-301.6501"/>
<polygon fill="#ff0000" stroke="#ff0000" points="521.3166,-298.731 511.0602,-296.0743 517.4212,-304.5471 521.3166,-298.731"/>
</g>
<!-- sourcefile~init_grid_fields.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node5" class="node">
<title>sourcefile~init_grid_fields.f90</title>
<g id="a_sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node5"><a xlink:href=".././sourcefile/init_grid_fields.f90.html" xlink:title="init_grid_fields.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="714,-255.9439 605,-255.9439 605,-231.9439 714,-231.9439 714,-255.9439"/>
<text text-anchor="middle" x="659.5" y="-241.5439" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">init_grid_fields.f90</text>
</a>
</g>
</g>
<!-- sourcefile~curr_and_fields_util.f90&#45;&gt;sourcefile~init_grid_fields.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~curr_and_fields_util.f90&#45;&gt;sourcefile~init_grid_fields.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M827.5,-201.9439C816.0604,-198.4071 753.798,-215.5374 708.3978,-228.9819"/>
<polygon fill="#ff0000" stroke="#ff0000" points="707.2862,-225.661 698.7031,-231.8723 709.2863,-232.3692 707.2862,-225.661"/>
</g>
<!-- sourcefile~grid_fields.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node6" class="node">
<title>sourcefile~grid_fields.f90</title>
<g id="a_sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node6"><a xlink:href=".././sourcefile/grid_fields.f90.html" xlink:title="grid_fields.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="703.5,-49.9439 615.5,-49.9439 615.5,-25.9439 703.5,-25.9439 703.5,-49.9439"/>
<text text-anchor="middle" x="659.5" y="-35.5439" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">grid_fields.f90</text>
</a>
</g>
</g>
<!-- sourcefile~curr_and_fields_util.f90&#45;&gt;sourcefile~grid_fields.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~curr_and_fields_util.f90&#45;&gt;sourcefile~grid_fields.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M975.2152,-268.8777C944.1309,-251.378 883.2158,-219.1696 827.5,-201.9439"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M827.5,-201.9439C753.2845,-178.9987 789.7731,-104.7037 727,-58.9439 722.7696,-55.8601 718.0749,-53.2209 713.1881,-50.9638"/>
<polygon fill="#ff0000" stroke="#ff0000" points="714.2072,-47.6 703.6253,-47.0777 711.5719,-54.085 714.2072,-47.6"/>
</g>
<!-- sourcefile~fstruct_data.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node7" class="node">
<title>sourcefile~fstruct_data.f90</title>
<g id="a_sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node7"><a xlink:href=".././sourcefile/fstruct_data.f90.html" xlink:title="fstruct_data.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="542.5,-253.9439 446.5,-253.9439 446.5,-229.9439 542.5,-229.9439 542.5,-253.9439"/>
<text text-anchor="middle" x="494.5" y="-239.5439" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">fstruct_data.f90</text>
</a>
</g>
</g>
<!-- sourcefile~curr_and_fields_util.f90&#45;&gt;sourcefile~fstruct_data.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge6" class="edge">
<title>sourcefile~curr_and_fields_util.f90&#45;&gt;sourcefile~fstruct_data.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M827.5,-201.9439C777.1349,-186.3725 777.6647,-250.3767 727,-264.9439 664.403,-282.9419 588.8571,-269.3117 541.236,-256.65"/>
<polygon fill="#ff0000" stroke="#ff0000" points="542.0829,-253.2531 531.5127,-253.9746 540.2258,-260.0022 542.0829,-253.2531"/>
</g>
<!-- sourcefile~grid_part_connect.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node8" class="node">
<title>sourcefile~grid_part_connect.f90</title>
<g id="a_sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node8"><a xlink:href=".././sourcefile/grid_part_connect.f90.html" xlink:title="grid_part_connect.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="892,-292.9439 763,-292.9439 763,-268.9439 892,-268.9439 892,-292.9439"/>
<text text-anchor="middle" x="827.5" y="-278.5439" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">grid_part_connect.f90</text>
</a>
</g>
</g>
<!-- sourcefile~curr_and_fields_util.f90&#45;&gt;sourcefile~grid_part_connect.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge7" class="edge">
<title>sourcefile~curr_and_fields_util.f90&#45;&gt;sourcefile~grid_part_connect.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M927.9503,-280.9439C919.5736,-280.9439 910.9749,-280.9439 902.5025,-280.9439"/>
<polygon fill="#ff0000" stroke="#ff0000" points="902.254,-277.444 892.254,-280.9439 902.2539,-284.444 902.254,-277.444"/>
</g>
<!-- sourcefile~grid_param.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node9" class="node">
<title>sourcefile~grid_param.f90</title>
<g id="a_sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node9"><a xlink:href=".././sourcefile/grid_param.f90.html" xlink:title="grid_param.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="383.5,-173.9439 289.5,-173.9439 289.5,-149.9439 383.5,-149.9439 383.5,-173.9439"/>
<text text-anchor="middle" x="336.5" y="-159.5439" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">grid_param.f90</text>
</a>
</g>
</g>
<!-- sourcefile~curr_and_fields_util.f90&#45;&gt;sourcefile~grid_param.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~curr_and_fields_util.f90&#45;&gt;sourcefile~grid_param.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M827.5,-201.9439C777.2412,-186.0329 777.6647,-153.5111 727,-138.9439 669.3362,-122.3643 651.5979,-132.0096 592,-138.9439 547.7756,-144.0895 538.9293,-159.0614 494.5,-161.9439"/>
</g>
<!-- sourcefile~mpi_curr_interface.f90&#45;&gt;sourcefile~pstruct_data.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge10" class="edge">
<title>sourcefile~mpi_curr_interface.f90&#45;&gt;sourcefile~pstruct_data.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M609.8132,-213.997C603.5792,-216.4788 597.4769,-219.4349 592,-222.9439 571.8612,-235.8466 575.9599,-249.7663 556,-262.9439 553.446,-264.63 550.7429,-266.1946 547.9507,-267.6445"/>
<polygon fill="#ff0000" stroke="#ff0000" points="546.3993,-264.5059 538.8043,-271.8929 549.3482,-270.8545 546.3993,-264.5059"/>
</g>
<!-- sourcefile~mpi_curr_interface.f90&#45;&gt;sourcefile~fstruct_data.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge9" class="edge">
<title>sourcefile~mpi_curr_interface.f90&#45;&gt;sourcefile~fstruct_data.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M609.9946,-213.9452C591.8901,-218.3342 571.2477,-223.3384 552.4702,-227.8905"/>
<polygon fill="#ff0000" stroke="#ff0000" points="551.4461,-224.5373 542.5522,-230.2949 553.0953,-231.3403 551.4461,-224.5373"/>
</g>
<!-- sourcefile~mpi_curr_interface.f90&#45;&gt;sourcefile~grid_param.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge11" class="edge">
<title>sourcefile~mpi_curr_interface.f90&#45;&gt;sourcefile~grid_param.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M621.3431,-189.8895C580.6695,-177.5451 518.8399,-160.3648 494.5,-161.9439"/>
</g>
<!-- sourcefile~parallel.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node13" class="node">
<title>sourcefile~parallel.f90</title>
<g id="a_sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node13"><a xlink:href=".././sourcefile/parallel.f90.html" xlink:title="parallel.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="532.5,-49.9439 456.5,-49.9439 456.5,-25.9439 532.5,-25.9439 532.5,-49.9439"/>
<text text-anchor="middle" x="494.5" y="-35.5439" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">parallel.F90</text>
</a>
</g>
</g>
<!-- sourcefile~mpi_curr_interface.f90&#45;&gt;sourcefile~parallel.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge12" class="edge">
<title>sourcefile~mpi_curr_interface.f90&#45;&gt;sourcefile~parallel.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M603.788,-189.7897C599.4626,-187.3572 595.4457,-184.4406 592,-180.9439 552.3192,-140.6763 595.1248,-99.752 556,-58.9439 552.0471,-54.821 547.2526,-51.5075 542.1039,-48.8445"/>
<polygon fill="#ff0000" stroke="#ff0000" points="543.1269,-45.4737 532.5589,-44.7193 540.3498,-51.8993 543.1269,-45.4737"/>
</g>
<!-- sourcefile~mpi_field_interface.f90&#45;&gt;sourcefile~pstruct_data.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge14" class="edge">
<title>sourcefile~mpi_field_interface.f90&#45;&gt;sourcefile~pstruct_data.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M605.2453,-172.0618C600.4521,-174.4993 595.9347,-177.4271 592,-180.9439 562.3237,-207.4677 585.3098,-236.0156 556,-262.9439 554.6863,-264.1509 553.3002,-265.2889 551.8557,-266.3619"/>
<polygon fill="#ffbf00" stroke="#ffbf00" points="549.6988,-263.5808 543.0414,-271.8227 553.3855,-269.5313 549.6988,-263.5808"/>
</g>
<!-- sourcefile~mpi_field_interface.f90&#45;&gt;sourcefile~fstruct_data.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge13" class="edge">
<title>sourcefile~mpi_field_interface.f90&#45;&gt;sourcefile~fstruct_data.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M614.9523,-172.0123C607.1699,-174.6241 599.25,-177.6159 592,-180.9439 565.9953,-192.8809 538.5522,-210.5685 519.4299,-223.8279"/>
<polygon fill="#ffbf00" stroke="#ffbf00" points="517.1729,-221.1364 511.0095,-229.754 521.2016,-226.8608 517.1729,-221.1364"/>
</g>
<!-- sourcefile~mpi_field_interface.f90&#45;&gt;sourcefile~grid_param.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge15" class="edge">
<title>sourcefile~mpi_field_interface.f90&#45;&gt;sourcefile~grid_param.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M591.6035,-159.1596C561.7851,-159.2299 526.3754,-159.8759 494.5,-161.9439"/>
</g>
<!-- sourcefile~mpi_field_interface.f90&#45;&gt;sourcefile~parallel.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge16" class="edge">
<title>sourcefile~mpi_field_interface.f90&#45;&gt;sourcefile~parallel.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M644.4687,-147.8664C630.4134,-136.3307 609.0855,-118.1956 592,-100.9439 574.6998,-83.4754 576.352,-72.7367 556,-58.9439 551.7315,-56.0511 547.0269,-53.5219 542.1781,-51.3186"/>
<polygon fill="#ffbf00" stroke="#ffbf00" points="543.3336,-48.01 532.7523,-47.4734 540.6895,-54.4914 543.3336,-48.01"/>
</g>
<!-- sourcefile~struct_def.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node10" class="node">
<title>sourcefile~struct_def.f90</title>
<g id="a_sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node10"><a xlink:href=".././sourcefile/struct_def.f90.html" xlink:title="struct_def.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="233.5,-213.9439 148.5,-213.9439 148.5,-189.9439 233.5,-189.9439 233.5,-213.9439"/>
<text text-anchor="middle" x="191" y="-199.5439" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">struct_def.f90</text>
</a>
</g>
</g>
<!-- sourcefile~pstruct_data.f90&#45;&gt;sourcefile~struct_def.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge17" class="edge">
<title>sourcefile~pstruct_data.f90&#45;&gt;sourcefile~struct_def.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M444.7861,-285.2481C413.5425,-285.3583 372.4813,-284.2038 336.5,-278.9439"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M336.5,-278.9439C288.7824,-271.9684 240.7558,-240.7352 213.5588,-220.2531"/>
<polygon fill="#7fff00" stroke="#7fff00" points="215.5427,-217.363 205.4874,-214.0252 211.2665,-222.9051 215.5427,-217.363"/>
</g>
<!-- sourcefile~precision_def.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node15" class="node">
<title>sourcefile~precision_def.f90</title>
<g id="a_sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node15"><a xlink:href=".././sourcefile/precision_def.f90.html" xlink:title="precision_def.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="106,-151.9439 0,-151.9439 0,-127.9439 106,-127.9439 106,-151.9439"/>
<text text-anchor="middle" x="53" y="-137.5439" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">precision_def.F90</text>
</a>
</g>
</g>
<!-- sourcefile~pstruct_data.f90&#45;&gt;sourcefile~precision_def.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge18" class="edge">
<title>sourcefile~pstruct_data.f90&#45;&gt;sourcefile~precision_def.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M336.5,-278.9439C272.5134,-269.5901 251.5169,-301.736 191,-278.9439"/>
</g>
<!-- sourcefile~init_grid_fields.f90&#45;&gt;sourcefile~pstruct_data.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge22" class="edge">
<title>sourcefile~init_grid_fields.f90&#45;&gt;sourcefile~pstruct_data.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M609.9946,-255.9452C592.3729,-260.2171 572.3468,-265.072 553.9763,-269.5254"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="553.1493,-266.1244 544.2554,-271.882 554.7986,-272.9274 553.1493,-266.1244"/>
</g>
<!-- sourcefile~init_grid_fields.f90&#45;&gt;sourcefile~fstruct_data.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge20" class="edge">
<title>sourcefile~init_grid_fields.f90&#45;&gt;sourcefile~fstruct_data.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M604.5574,-243.2779C587.9436,-243.0766 569.6453,-242.8548 552.8191,-242.6508"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="552.6026,-239.148 542.5609,-242.5265 552.5177,-246.1475 552.6026,-239.148"/>
</g>
<!-- sourcefile~phys_param.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node11" class="node">
<title>sourcefile~phys_param.f90</title>
<g id="a_sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node11"><a xlink:href=".././sourcefile/phys_param.f90.html" xlink:title="phys_param.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="240,-171.9439 142,-171.9439 142,-147.9439 240,-147.9439 240,-171.9439"/>
<text text-anchor="middle" x="191" y="-157.5439" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">phys_param.f90</text>
</a>
</g>
</g>
<!-- sourcefile~init_grid_fields.f90&#45;&gt;sourcefile~phys_param.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge21" class="edge">
<title>sourcefile~init_grid_fields.f90&#45;&gt;sourcefile~phys_param.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M609.3961,-231.9223C592.4959,-228.1046 573.486,-224.0677 556,-220.9439 432.372,-198.8585 399.0925,-207.8415 276,-182.9439 264.6424,-180.6466 252.559,-177.6934 241.1751,-174.6741"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="241.9545,-171.2591 231.3869,-172.0186 240.1216,-178.0149 241.9545,-171.2591"/>
</g>
<!-- sourcefile~grid_field_param.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node14" class="node">
<title>sourcefile~grid_field_param.f90</title>
<g id="a_sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node14"><a xlink:href=".././sourcefile/grid_field_param.f90.html" xlink:title="grid_field_param.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="556,-133.9439 433,-133.9439 433,-109.9439 556,-109.9439 556,-133.9439"/>
<text text-anchor="middle" x="494.5" y="-119.5439" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">grid_field_param.f90</text>
</a>
</g>
</g>
<!-- sourcefile~init_grid_fields.f90&#45;&gt;sourcefile~grid_field_param.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge19" class="edge">
<title>sourcefile~init_grid_fields.f90&#45;&gt;sourcefile~grid_field_param.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M605.7042,-231.8541C600.7624,-229.4107 596.0865,-226.4738 592,-222.9439 564.0191,-198.7741 582.759,-173.4599 556,-147.9439 552.3192,-144.4341 548.0936,-141.3636 543.6181,-138.685"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="545.2561,-135.592 534.7809,-134.0044 541.9797,-141.7779 545.2561,-135.592"/>
</g>
<!-- sourcefile~grid_fields.f90&#45;&gt;sourcefile~parallel.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge24" class="edge">
<title>sourcefile~grid_fields.f90&#45;&gt;sourcefile~parallel.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M615.283,-37.9439C592.9322,-37.9439 565.7645,-37.9439 542.8597,-37.9439"/>
<polygon fill="#00ffff" stroke="#00ffff" points="542.6685,-34.444 532.6685,-37.9439 542.6684,-41.444 542.6685,-34.444"/>
</g>
<!-- sourcefile~grid_fields.f90&#45;&gt;sourcefile~grid_field_param.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge23" class="edge">
<title>sourcefile~grid_fields.f90&#45;&gt;sourcefile~grid_field_param.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M615.3923,-47.7393C607.2391,-50.6188 599.0745,-54.2897 592,-58.9439 571.4608,-72.4563 576.352,-87.1511 556,-100.9439 553.5921,-102.5757 551.0455,-104.0919 548.4125,-105.4991"/>
<polygon fill="#00ffff" stroke="#00ffff" points="546.7344,-102.4213 539.2036,-109.8736 549.7381,-108.7442 546.7344,-102.4213"/>
</g>
<!-- sourcefile~fstruct_data.f90&#45;&gt;sourcefile~precision_def.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge25" class="edge">
<title>sourcefile~fstruct_data.f90&#45;&gt;sourcefile~precision_def.f90</title>
<path fill="none" stroke="#003fff" stroke-dasharray="5,2" d="M446.2354,-246.209C401.8963,-250.3206 334.4031,-257.0672 276,-264.9439 238.0568,-270.0612 227.2261,-291.3352 191,-278.9439"/>
<path fill="none" stroke="#003fff" stroke-dasharray="5,2" d="M191,-278.9439C132.2032,-256.7996 86.3942,-194.2161 65.4523,-161.1001"/>
<polygon fill="#003fff" stroke="#003fff" points="68.2107,-158.9043 59.9889,-152.2219 62.249,-162.5729 68.2107,-158.9043"/>
</g>
<!-- sourcefile~grid_part_connect.f90&#45;&gt;sourcefile~pstruct_data.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge28" class="edge">
<title>sourcefile~grid_part_connect.f90&#45;&gt;sourcefile~pstruct_data.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M659.5,-321.9439C618.3971,-319.8038 572.8976,-308.6374 540.1063,-298.9585"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="540.9414,-295.5547 530.3566,-296.0141 538.9177,-302.2558 540.9414,-295.5547"/>
</g>
<!-- sourcefile~grid_part_connect.f90&#45;&gt;sourcefile~fstruct_data.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge26" class="edge">
<title>sourcefile~grid_part_connect.f90&#45;&gt;sourcefile~fstruct_data.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M799.7427,-292.961C766.8179,-305.9795 710.0198,-324.5743 659.5,-321.9439"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M659.5,-321.9439C627.7032,-320.2884 619.0361,-314.7613 592,-297.9439 573.0514,-286.1572 575.0223,-274.6113 556,-262.9439 553.2109,-261.2332 550.2646,-259.6406 547.2323,-258.1613"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="548.5108,-254.8998 537.9494,-254.0585 545.681,-261.3023 548.5108,-254.8998"/>
</g>
<!-- sourcefile~grid_part_lib.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node12" class="node">
<title>sourcefile~grid_part_lib.f90</title>
<g id="a_sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node12"><a xlink:href=".././sourcefile/grid_part_lib.f90.html" xlink:title="grid_part_lib.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="709,-91.9439 610,-91.9439 610,-67.9439 709,-67.9439 709,-91.9439"/>
<text text-anchor="middle" x="659.5" y="-77.5439" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">grid_part_lib.f90</text>
</a>
</g>
</g>
<!-- sourcefile~grid_part_connect.f90&#45;&gt;sourcefile~grid_part_lib.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge27" class="edge">
<title>sourcefile~grid_part_connect.f90&#45;&gt;sourcefile~grid_part_lib.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M812.7014,-268.7154C798.5775,-256.4728 777.378,-236.5403 763,-215.9439 741.3758,-184.9673 749.7094,-169.1341 727,-138.9439 715.3004,-123.3902 698.9251,-108.9541 685.2335,-98.2549"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="687.2031,-95.3559 677.1211,-92.0994 682.9718,-100.9323 687.2031,-95.3559"/>
</g>
<!-- sourcefile~grid_param.f90&#45;&gt;sourcefile~struct_def.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge29" class="edge">
<title>sourcefile~grid_param.f90&#45;&gt;sourcefile~struct_def.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M292.8452,-173.9452C277.3176,-178.214 259.6727,-183.0648 243.4831,-187.5156"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="242.3371,-184.2007 233.6227,-190.2263 244.1928,-190.9503 242.3371,-184.2007"/>
</g>
<!-- sourcefile~grid_param.f90&#45;&gt;sourcefile~precision_def.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge30" class="edge">
<title>sourcefile~grid_param.f90&#45;&gt;sourcefile~precision_def.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M299.5855,-149.8443C260.1801,-137.16 201.9156,-119.157 191,-119.9439"/>
</g>
<!-- sourcefile~struct_def.f90&#45;&gt;sourcefile~precision_def.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge31" class="edge">
<title>sourcefile~struct_def.f90&#45;&gt;sourcefile~precision_def.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M162.4424,-189.8576C155.7224,-186.9713 148.5967,-183.8763 142,-180.9439 124.0669,-172.9722 104.2236,-163.8594 87.833,-156.2528"/>
<polygon fill="#ff0000" stroke="#ff0000" points="89.1653,-153.0124 78.6221,-151.9681 86.2129,-159.3593 89.1653,-153.0124"/>
</g>
<!-- sourcefile~phys_param.f90&#45;&gt;sourcefile~precision_def.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge32" class="edge">
<title>sourcefile~phys_param.f90&#45;&gt;sourcefile~precision_def.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M141.9578,-152.8363C133.6055,-151.6259 124.8262,-150.3535 116.1702,-149.099"/>
<polygon fill="#ffff00" stroke="#ffff00" points="116.4971,-145.6099 106.0984,-147.6393 115.493,-152.5375 116.4971,-145.6099"/>
</g>
<!-- sourcefile~grid_part_lib.f90&#45;&gt;sourcefile~grid_param.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge34" class="edge">
<title>sourcefile~grid_part_lib.f90&#45;&gt;sourcefile~grid_param.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M619.5449,-92.0665C610.1209,-95.7955 600.3848,-100.4098 592,-105.9439 572.851,-118.5825 575.5678,-130.9638 556,-142.9439 531.6015,-157.8816 523.048,-160.0918 494.5,-161.9439"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M494.5,-161.9439C461.199,-164.1044 423.8669,-164.2115 393.8554,-163.7289"/>
<polygon fill="#00ff00" stroke="#00ff00" points="393.6278,-160.2241 383.5639,-163.536 393.4965,-167.2228 393.6278,-160.2241"/>
</g>
<!-- sourcefile~common_param.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node17" class="node">
<title>sourcefile~common_param.f90</title>
<g id="a_sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node17"><a xlink:href=".././sourcefile/common_param.f90.html" xlink:title="common_param.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="397,-89.9439 276,-89.9439 276,-65.9439 397,-65.9439 397,-89.9439"/>
<text text-anchor="middle" x="336.5" y="-75.5439" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">common_param.f90</text>
</a>
</g>
</g>
<!-- sourcefile~grid_part_lib.f90&#45;&gt;sourcefile~common_param.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge33" class="edge">
<title>sourcefile~grid_part_lib.f90&#45;&gt;sourcefile~common_param.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M609.7324,-68.0153C603.5113,-65.5137 597.4341,-62.5189 592,-58.9439 571.4608,-45.4315 578.3362,-27.2171 556,-16.9439 506.3346,5.8989 482.938,5.2966 433,-16.9439 411.1513,-26.6745 416.9266,-43.7159 397,-56.9439 394.5685,-58.558 391.9995,-60.062 389.3468,-61.4613"/>
<polygon fill="#00ff00" stroke="#00ff00" points="387.6388,-58.3969 380.0833,-65.8241 390.6215,-64.7296 387.6388,-58.3969"/>
</g>
<!-- sourcefile~stretched_grid.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node19" class="node">
<title>sourcefile~stretched_grid.f90</title>
<g id="a_sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node19"><a xlink:href=".././sourcefile/stretched_grid.f90.html" xlink:title="stretched_grid.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="549,-91.9439 440,-91.9439 440,-67.9439 549,-67.9439 549,-91.9439"/>
<text text-anchor="middle" x="494.5" y="-77.5439" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">stretched_grid.f90</text>
</a>
</g>
</g>
<!-- sourcefile~grid_part_lib.f90&#45;&gt;sourcefile~stretched_grid.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge35" class="edge">
<title>sourcefile~grid_part_lib.f90&#45;&gt;sourcefile~stretched_grid.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M609.9946,-79.9439C594.1153,-79.9439 576.2836,-79.9439 559.4703,-79.9439"/>
<polygon fill="#00ff00" stroke="#00ff00" points="559.1598,-76.444 549.1597,-79.9439 559.1597,-83.444 559.1598,-76.444"/>
</g>
<!-- sourcefile~mpi_var.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node16" class="node">
<title>sourcefile~mpi_var.f90</title>
<g id="a_sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node16"><a xlink:href=".././sourcefile/mpi_var.f90.html" xlink:title="mpi_var.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="374,-131.9439 299,-131.9439 299,-107.9439 374,-107.9439 374,-131.9439"/>
<text text-anchor="middle" x="336.5" y="-117.5439" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mpi_var.f90</text>
</a>
</g>
</g>
<!-- sourcefile~parallel.f90&#45;&gt;sourcefile~mpi_var.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge36" class="edge">
<title>sourcefile~parallel.f90&#45;&gt;sourcefile~mpi_var.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M456.333,-47.601C448.2642,-50.5489 440.0616,-54.2818 433,-58.9439 413.0401,-72.1215 416.9266,-85.7159 397,-98.9439 392.7665,-101.7542 388.1163,-104.2304 383.3332,-106.4022"/>
<polygon fill="#00ffff" stroke="#00ffff" points="381.9696,-103.1785 374.0457,-110.2114 384.6259,-109.6549 381.9696,-103.1785"/>
</g>
<!-- sourcefile~parallel.f90&#45;&gt;sourcefile~common_param.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge37" class="edge">
<title>sourcefile~parallel.f90&#45;&gt;sourcefile~common_param.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M456.2526,-47.6268C437.5729,-52.3558 414.7072,-58.1446 393.9808,-63.3918"/>
<polygon fill="#00ffff" stroke="#00ffff" points="392.8408,-60.0699 384.0056,-65.9172 394.5588,-66.8558 392.8408,-60.0699"/>
</g>
<!-- sourcefile~util.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node18" class="node">
<title>sourcefile~util.f90</title>
<g id="a_sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node18"><a xlink:href=".././sourcefile/util.f90.html" xlink:title="util.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="363.5,-47.9439 309.5,-47.9439 309.5,-23.9439 363.5,-23.9439 363.5,-47.9439"/>
<text text-anchor="middle" x="336.5" y="-33.5439" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">util.f90</text>
</a>
</g>
</g>
<!-- sourcefile~parallel.f90&#45;&gt;sourcefile~util.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge38" class="edge">
<title>sourcefile~parallel.f90&#45;&gt;sourcefile~util.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M456.2526,-37.4598C431.1599,-37.1421 398.5135,-36.7289 373.6461,-36.4141"/>
<polygon fill="#00ffff" stroke="#00ffff" points="373.5532,-32.9127 363.5097,-36.2858 373.4645,-39.9122 373.5532,-32.9127"/>
</g>
<!-- sourcefile~grid_field_param.f90&#45;&gt;sourcefile~grid_param.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge41" class="edge">
<title>sourcefile~grid_field_param.f90&#45;&gt;sourcefile~grid_param.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M447.0948,-133.9452C430.3021,-138.1965 411.229,-143.0252 393.7075,-147.461"/>
<polygon fill="#0000ff" stroke="#0000ff" points="392.4345,-144.1728 383.5993,-150.02 394.1525,-150.9587 392.4345,-144.1728"/>
</g>
<!-- sourcefile~grid_field_param.f90&#45;&gt;sourcefile~mpi_var.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge39" class="edge">
<title>sourcefile~grid_field_param.f90&#45;&gt;sourcefile~mpi_var.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M432.9607,-121.1649C416.9091,-120.9617 399.8452,-120.7457 384.6029,-120.5528"/>
<polygon fill="#0000ff" stroke="#0000ff" points="384.4199,-117.0503 374.3763,-120.4233 384.3312,-124.0497 384.4199,-117.0503"/>
</g>
<!-- sourcefile~grid_field_param.f90&#45;&gt;sourcefile~common_param.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge40" class="edge">
<title>sourcefile~grid_field_param.f90&#45;&gt;sourcefile~common_param.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M451.3258,-109.9207C432.1669,-104.5853 409.4414,-98.2567 389.2842,-92.6433"/>
<polygon fill="#0000ff" stroke="#0000ff" points="390.1944,-89.2637 379.622,-89.9526 388.3164,-96.0071 390.1944,-89.2637"/>
</g>
<!-- sourcefile~mpi_var.f90&#45;&gt;sourcefile~precision_def.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge42" class="edge">
<title>sourcefile~mpi_var.f90&#45;&gt;sourcefile~precision_def.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M298.7628,-118.4586C269.3595,-117.6601 227.5328,-117.3104 191,-119.9439"/>
</g>
<!-- sourcefile~common_param.f90&#45;&gt;sourcefile~precision_def.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge43" class="edge">
<title>sourcefile~common_param.f90&#45;&gt;sourcefile~precision_def.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M300.9771,-90.0446C265.1899,-101.899 212.3068,-118.408 191,-119.9439"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M191,-119.9439C166.4961,-121.7103 139.7336,-125.2192 116.3538,-128.8114"/>
<polygon fill="#7fff00" stroke="#7fff00" points="115.5496,-125.3948 106.215,-130.4063 116.6374,-132.3098 115.5496,-125.3948"/>
</g>
<!-- sourcefile~util.f90&#45;&gt;sourcefile~precision_def.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge45" class="edge">
<title>sourcefile~util.f90&#45;&gt;sourcefile~precision_def.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M309.3129,-33.8569C270.3756,-31.9816 197.328,-32.6658 142,-57.9439 111.537,-71.8617 84.5026,-100.2419 68.4389,-119.6765"/>
<polygon fill="#00ffff" stroke="#00ffff" points="65.5779,-117.6497 62.0526,-127.6409 71.039,-122.0288 65.5779,-117.6497"/>
</g>
<!-- sourcefile~code_util.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node20" class="node">
<title>sourcefile~code_util.f90</title>
<g id="a_sourcefile~~curr_and_fields_util.f90~~EfferentGraph_node20"><a xlink:href=".././sourcefile/code_util.f90.html" xlink:title="code_util.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="231.5,-90.9439 150.5,-90.9439 150.5,-66.9439 231.5,-66.9439 231.5,-90.9439"/>
<text text-anchor="middle" x="191" y="-76.5439" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">code_util.f90</text>
</a>
</g>
</g>
<!-- sourcefile~util.f90&#45;&gt;sourcefile~code_util.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge44" class="edge">
<title>sourcefile~util.f90&#45;&gt;sourcefile~code_util.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M309.4736,-43.9311C290.4309,-49.5588 264.3595,-57.2638 241.5213,-64.0132"/>
<polygon fill="#00ffff" stroke="#00ffff" points="240.2261,-60.7463 231.6281,-66.937 242.21,-67.4592 240.2261,-60.7463"/>
</g>
<!-- sourcefile~stretched_grid.f90&#45;&gt;sourcefile~grid_param.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge48" class="edge">
<title>sourcefile~stretched_grid.f90&#45;&gt;sourcefile~grid_param.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M450.1957,-91.9949C444.1814,-94.4999 438.2727,-97.4629 433,-100.9439 413.0401,-114.1215 416.9266,-127.7159 397,-140.9439 394.5685,-142.558 391.9995,-144.062 389.3468,-145.4613"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="387.6388,-142.3969 380.0833,-149.8241 390.6215,-148.7296 387.6388,-142.3969"/>
</g>
<!-- sourcefile~stretched_grid.f90&#45;&gt;sourcefile~mpi_var.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge46" class="edge">
<title>sourcefile~stretched_grid.f90&#45;&gt;sourcefile~mpi_var.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M447.0948,-91.9452C427.1103,-97.0046 403.8963,-102.8816 383.9112,-107.9411"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="382.9245,-104.5804 374.0894,-110.4276 384.6425,-111.3663 382.9245,-104.5804"/>
</g>
<!-- sourcefile~stretched_grid.f90&#45;&gt;sourcefile~common_param.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge47" class="edge">
<title>sourcefile~stretched_grid.f90&#45;&gt;sourcefile~common_param.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M439.6827,-79.25C429.281,-79.1183 418.2604,-78.9788 407.4433,-78.8419"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="407.205,-75.3387 397.1615,-78.7118 407.1164,-82.3382 407.205,-75.3387"/>
</g>
<!-- sourcefile~code_util.f90&#45;&gt;sourcefile~precision_def.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~EfferentGraph_edge49" class="edge">
<title>sourcefile~code_util.f90&#45;&gt;sourcefile~precision_def.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M163.7356,-90.9955C142.472,-100.3947 112.738,-113.538 89.4346,-123.8387"/>
<polygon fill="#ff0000" stroke="#ff0000" points="87.939,-120.6731 80.2077,-127.9173 90.7691,-127.0755 87.939,-120.6731"/>
</g>
</g>
</svg>
</div><script>var pansourcefilecurr_and_fields_utilf90EfferentGraph = svgPanZoom('#sourcefilecurr_and_fields_utilf90EfferentGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="202pt" height="32pt"
 viewBox="0.00 0.00 201.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 197.5,-28 197.5,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="71,-24 0,-24 0,0 71,0 71,-24"/>
<text text-anchor="middle" x="35.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="193.5,-24 89.5,-24 89.5,0 193.5,0 193.5,-24"/>
<text text-anchor="middle" x="141.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
    
      
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Files dependent on this one</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~curr_and_fields_util.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefilecurr_and_fields_utilf90AfferentGraph" width="429pt" height="74pt"
 viewBox="0.00 0.00 429.00 74.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~curr_and_fields_util.f90~~AfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 70)">
<title>sourcefile~~curr_and_fields_util.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-70 425,-70 425,4 -4,4"/>
<!-- sourcefile~curr_and_fields_util.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~curr_and_fields_util.f90</title>
<polygon fill="none" stroke="#000000" points="136,-45 0,-45 0,-21 136,-21 136,-45"/>
<text text-anchor="middle" x="68" y="-30.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">curr_and_fields_util.f90</text>
</g>
<!-- sourcefile~pic_evolve_in_time.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~pic_evolve_in_time.f90</title>
<g id="a_sourcefile~~curr_and_fields_util.f90~~AfferentGraph_node2"><a xlink:href=".././sourcefile/pic_evolve_in_time.f90.html" xlink:title="pic_evolve_in_time.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="307,-66 174,-66 174,-42 307,-42 307,-66"/>
<text text-anchor="middle" x="240.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">pic_evolve_in_time.f90</text>
</a>
</g>
</g>
<!-- sourcefile~pic_evolve_in_time.f90&#45;&gt;sourcefile~curr_and_fields_util.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~pic_evolve_in_time.f90&#45;&gt;sourcefile~curr_and_fields_util.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M173.807,-45.8809C164.7558,-44.779 155.4014,-43.6402 146.1714,-42.5165"/>
<polygon fill="#ff0000" stroke="#ff0000" points="146.5747,-39.0399 136.2249,-41.3056 145.7287,-45.9886 146.5747,-39.0399"/>
</g>
<!-- sourcefile~env_evolve_in_time.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~env_evolve_in_time.f90</title>
<g id="a_sourcefile~~curr_and_fields_util.f90~~AfferentGraph_node3"><a xlink:href=".././sourcefile/env_evolve_in_time.f90.html" xlink:title="env_evolve_in_time.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="309,-24 172,-24 172,0 309,0 309,-24"/>
<text text-anchor="middle" x="240.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">env_evolve_in_time.f90</text>
</a>
</g>
</g>
<!-- sourcefile~env_evolve_in_time.f90&#45;&gt;sourcefile~curr_and_fields_util.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~env_evolve_in_time.f90&#45;&gt;sourcefile~curr_and_fields_util.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M171.8278,-20.3601C163.3866,-21.3877 154.7107,-22.4439 146.1426,-23.487"/>
<polygon fill="#ff0000" stroke="#ff0000" points="145.658,-20.02 136.1543,-24.703 146.504,-26.9687 145.658,-20.02"/>
</g>
<!-- sourcefile~aladyn.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~aladyn.f90</title>
<g id="a_sourcefile~~curr_and_fields_util.f90~~AfferentGraph_node4"><a xlink:href=".././sourcefile/aladyn.f90.html" xlink:title="ALaDyn.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="421,-45 345,-45 345,-21 421,-21 421,-45"/>
<text text-anchor="middle" x="383" y="-30.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ALaDyn.F90</text>
</a>
</g>
</g>
<!-- sourcefile~aladyn.f90&#45;&gt;sourcefile~pic_evolve_in_time.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~aladyn.f90&#45;&gt;sourcefile~pic_evolve_in_time.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M344.8126,-38.6276C336.1852,-39.899 326.7268,-41.2929 317.1375,-42.7061"/>
<polygon fill="#ff0000" stroke="#ff0000" points="316.5092,-39.2608 307.1264,-44.1814 317.5298,-46.186 316.5092,-39.2608"/>
</g>
<!-- sourcefile~aladyn.f90&#45;&gt;sourcefile~env_evolve_in_time.f90 -->
<g id="sourcefile~~curr_and_fields_util.f90~~AfferentGraph_edge4" class="edge">
<title>sourcefile~aladyn.f90&#45;&gt;sourcefile~env_evolve_in_time.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M344.8126,-27.3724C336.7861,-26.1895 328.0404,-24.9007 319.1391,-23.5889"/>
<polygon fill="#00ffff" stroke="#00ffff" points="319.4567,-20.098 309.0533,-22.1026 318.4361,-27.0232 319.4567,-20.098"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="202pt" height="32pt"
 viewBox="0.00 0.00 201.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 197.5,-28 197.5,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="71,-24 0,-24 0,0 71,0 71,-24"/>
<text text-anchor="middle" x="35.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="193.5,-24 89.5,-24 89.5,0 193.5,0 193.5,-24"/>
<text text-anchor="middle" x="141.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
      
      <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/curr_and_fields_util.html">curr_and_fields_util</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/curr_and_fields_util.f90.html#src">curr_and_fields_util.f90</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="c">!*****************************************************************************************************!</span>
<a name="ln-2"></a><span class="c">!                            Copyright 2008-2020  The ALaDyn Collaboration                            !</span>
<a name="ln-3"></a><span class="c">!*****************************************************************************************************!</span>
<a name="ln-4"></a>
<a name="ln-5"></a><span class="c">!*****************************************************************************************************!</span>
<a name="ln-6"></a><span class="c">!  This file is part of ALaDyn.                                                                       !</span>
<a name="ln-7"></a><span class="c">!                                                                                                     !</span>
<a name="ln-8"></a><span class="c">!  ALaDyn is free software: you can redistribute it and/or modify                                     !</span>
<a name="ln-9"></a><span class="c">!  it under the terms of the GNU General Public License as published by                               !</span>
<a name="ln-10"></a><span class="c">!  the Free Software Foundation, either version 3 of the License, or                                  !</span>
<a name="ln-11"></a><span class="c">!  (at your option) any later version.                                                                !</span>
<a name="ln-12"></a><span class="c">!                                                                                                     !</span>
<a name="ln-13"></a><span class="c">!  ALaDyn is distributed in the hope that it will be useful,                                          !</span>
<a name="ln-14"></a><span class="c">!  but WITHOUT ANY WARRANTY; without even the implied warranty of                                     !</span>
<a name="ln-15"></a><span class="c">!  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the                                      !</span>
<a name="ln-16"></a><span class="c">!  GNU General Public License for more details.                                                       !</span>
<a name="ln-17"></a><span class="c">!                                                                                                     !</span>
<a name="ln-18"></a><span class="c">!  You should have received a copy of the GNU General Public License                                  !</span>
<a name="ln-19"></a><span class="c">!  along with ALaDyn.  If not, see &lt;http://www.gnu.org/licenses/&gt;.                                    !</span>
<a name="ln-20"></a><span class="c">!*****************************************************************************************************!</span>
<a name="ln-21"></a>
<a name="ln-22"></a> <span class="k">module </span><span class="n">curr_and_fields_util</span>
<a name="ln-23"></a>  <span class="k">use </span><span class="n">pstruct_data</span>
<a name="ln-24"></a>  <span class="k">use </span><span class="n">fstruct_data</span>
<a name="ln-25"></a>  <span class="k">use </span><span class="n">grid_param</span>
<a name="ln-26"></a>  <span class="k">use </span><span class="n">mpi_curr_interface</span>
<a name="ln-27"></a>  <span class="k">use </span><span class="n">mpi_field_interface</span>
<a name="ln-28"></a>  <span class="k">use </span><span class="n">grid_part_connect</span>
<a name="ln-29"></a>  <span class="k">use </span><span class="n">grid_fields</span>
<a name="ln-30"></a>  <span class="k">use </span><span class="n">init_grid_field</span>
<a name="ln-31"></a>
<a name="ln-32"></a>  <span class="k">implicit none</span>
<a name="ln-33"></a>  <span class="c">!===============================</span>
<a name="ln-34"></a>  <span class="c">! MOVING WINDOW SECTION</span>
<a name="ln-35"></a>  <span class="c">!=============================</span>
<a name="ln-36"></a> <span class="k">contains</span>
<a name="ln-37"></a>  <span class="c">!============================</span>
<a name="ln-38"></a>  <span class="k">subroutine </span><span class="n">set_lpf_acc</span><span class="p">(</span><span class="n">ef</span><span class="p">,</span> <span class="n">sp_loc</span><span class="p">,</span> <span class="n">apt</span><span class="p">,</span> <span class="n">np</span><span class="p">,</span> <span class="n">nf</span><span class="p">)</span>
<a name="ln-39"></a>
<a name="ln-40"></a>   <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ef</span><span class="p">(:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:)</span>
<a name="ln-41"></a>   <span class="k">type</span><span class="p">(</span><span class="n">species</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">sp_loc</span>
<a name="ln-42"></a>   <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">apt</span><span class="p">(:,</span> <span class="p">:)</span>
<a name="ln-43"></a>   <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">np</span><span class="p">,</span> <span class="n">nf</span>
<a name="ln-44"></a>
<a name="ln-45"></a>   <span class="c">! Uses alternating order quadratic or linear shapes</span>
<a name="ln-46"></a>
<a name="ln-47"></a>   <span class="k">select case</span> <span class="p">(</span><span class="n">ndim</span><span class="p">)</span>
<a name="ln-48"></a>   <span class="k">case</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-49"></a>    <span class="k">call </span><span class="n">set_part1d_acc</span><span class="p">(</span><span class="n">ef</span><span class="p">,</span> <span class="n">sp_loc</span><span class="p">,</span> <span class="n">apt</span><span class="p">,</span> <span class="n">np</span><span class="p">,</span> <span class="n">nf</span><span class="p">)</span>
<a name="ln-50"></a>   <span class="k">case</span> <span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-51"></a>    <span class="k">call </span><span class="n">set_part2d_hcell_acc</span><span class="p">(</span><span class="n">ef</span><span class="p">,</span> <span class="n">sp_loc</span><span class="p">,</span> <span class="n">apt</span><span class="p">,</span> <span class="n">np</span><span class="p">,</span> <span class="n">nf</span><span class="p">)</span>
<a name="ln-52"></a>   <span class="k">case</span> <span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-53"></a>    <span class="k">call </span><span class="n">set_part3d_hcell_acc</span><span class="p">(</span><span class="n">ef</span><span class="p">,</span> <span class="n">sp_loc</span><span class="p">,</span> <span class="n">apt</span><span class="p">,</span> <span class="n">np</span><span class="p">)</span>
<a name="ln-54"></a>   <span class="k">end select</span>
<a name="ln-55"></a><span class="k">  end subroutine</span>
<a name="ln-56"></a>
<a name="ln-57"></a><span class="k">  subroutine </span><span class="n">field_charge_multiply</span><span class="p">(</span><span class="n">sp_loc</span><span class="p">,</span> <span class="n">apt</span><span class="p">,</span> <span class="n">np</span><span class="p">,</span> <span class="n">ncmp</span><span class="p">)</span>
<a name="ln-58"></a>
<a name="ln-59"></a>   <span class="k">type</span><span class="p">(</span><span class="n">species</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">sp_loc</span>
<a name="ln-60"></a>   <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">apt</span><span class="p">(:,</span> <span class="p">:)</span>
<a name="ln-61"></a>   <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">np</span><span class="p">,</span> <span class="n">ncmp</span>
<a name="ln-62"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">p</span><span class="p">,</span> <span class="n">ch</span>
<a name="ln-63"></a>
<a name="ln-64"></a>   <span class="n">ch</span> <span class="o">=</span> <span class="n">size</span><span class="p">(</span><span class="n">apt</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<a name="ln-65"></a>   <span class="c">!==========================</span>
<a name="ln-66"></a>   <span class="k">do </span><span class="n">p</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">np</span>
<a name="ln-67"></a>    <span class="n">wgh_cmp</span> <span class="o">=</span> <span class="n">sp_loc</span><span class="p">%</span><span class="n">part</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">ch</span><span class="p">)</span>
<a name="ln-68"></a>    <span class="n">apt</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">ncmp</span><span class="p">)</span> <span class="o">=</span> <span class="n">charge</span><span class="o">*</span><span class="n">apt</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">ncmp</span><span class="p">)</span>
<a name="ln-69"></a>   <span class="k">end do</span>
<a name="ln-70"></a>   <span class="c">! EXIT p-assigned (E,B) fields multiplied by charge</span>
<a name="ln-71"></a>  <span class="k">end subroutine</span>
<a name="ln-72"></a>
<a name="ln-73"></a><span class="k">  subroutine </span><span class="n">curr_accumulate</span><span class="p">(</span><span class="n">sp_loc</span><span class="p">,</span> <span class="n">pdata</span><span class="p">,</span> <span class="n">curr</span><span class="p">,</span> <span class="n">npt</span><span class="p">)</span>
<a name="ln-74"></a>   <span class="k">type</span><span class="p">(</span><span class="n">species</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">sp_loc</span>
<a name="ln-75"></a>   <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pdata</span><span class="p">(:,</span> <span class="p">:),</span> <span class="n">curr</span><span class="p">(:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:)</span>
<a name="ln-76"></a>   <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">npt</span>
<a name="ln-77"></a>   <span class="c">! real(dp),intent(in) :: dtloc</span>
<a name="ln-78"></a>   <span class="c">!=========================</span>
<a name="ln-79"></a>   <span class="c">! charge preserving for iform=0, 1</span>
<a name="ln-80"></a>   <span class="c">!iform=0 =&gt; (D_xJx,D_yJy,D_zJz) inverted on each particle=&gt; (Jx,Jy,Jz)</span>
<a name="ln-81"></a>   <span class="c">!iform=1    as iform=0</span>
<a name="ln-82"></a>   <span class="c">!iform=2    no charge preserving</span>
<a name="ln-83"></a>   <span class="c">!=========================</span>
<a name="ln-84"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">npt</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-85"></a><span class="k">   if</span> <span class="p">(</span><span class="n">ndim</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-86"></a><span class="k">    if</span> <span class="p">(</span><span class="n">iform</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-87"></a><span class="k">     call </span><span class="n">esirkepov_2d_curr</span><span class="p">(</span><span class="n">sp_loc</span><span class="p">,</span> <span class="n">pdata</span><span class="p">,</span> <span class="n">curr</span><span class="p">,</span> <span class="n">npt</span><span class="p">)</span>
<a name="ln-88"></a>    <span class="k">else</span>
<a name="ln-89"></a><span class="k">     call </span><span class="n">ncdef_2d_curr</span><span class="p">(</span><span class="n">sp_loc</span><span class="p">,</span> <span class="n">pdata</span><span class="p">,</span> <span class="n">curr</span><span class="p">,</span> <span class="n">npt</span><span class="p">)</span>
<a name="ln-90"></a>    <span class="k">end if</span>
<a name="ln-91"></a><span class="k">    return</span>
<a name="ln-92"></a><span class="k">   end if</span>
<a name="ln-93"></a><span class="k">   if</span> <span class="p">(</span><span class="n">iform</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-94"></a><span class="k">    call </span><span class="n">esirkepov_3d_curr</span><span class="p">(</span><span class="n">sp_loc</span><span class="p">,</span> <span class="n">pdata</span><span class="p">,</span> <span class="n">curr</span><span class="p">,</span> <span class="n">npt</span><span class="p">)</span>
<a name="ln-95"></a>   <span class="k">else</span>
<a name="ln-96"></a><span class="k">    call </span><span class="n">ncdef_3d_curr</span><span class="p">(</span><span class="n">sp_loc</span><span class="p">,</span> <span class="n">pdata</span><span class="p">,</span> <span class="n">curr</span><span class="p">,</span> <span class="n">npt</span><span class="p">)</span>
<a name="ln-97"></a>   <span class="k">end if</span>
<a name="ln-98"></a>   <span class="c">!========================</span>
<a name="ln-99"></a>   <span class="c">! accumulates for each species currents on curr(i1:n1p,j1:n2p,k1:n3p,1:compnent)</span>
<a name="ln-100"></a>   <span class="c">!============================</span>
<a name="ln-101"></a>  <span class="k">end subroutine</span>
<a name="ln-102"></a>  <span class="c">!==============================</span>
<a name="ln-103"></a>  <span class="k">subroutine </span><span class="n">curr_mpi_collect</span><span class="p">(</span><span class="n">curr</span><span class="p">)</span>
<a name="ln-104"></a>
<a name="ln-105"></a>   <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">curr</span><span class="p">(:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:)</span>
<a name="ln-106"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">jj</span><span class="p">,</span> <span class="n">kk</span>
<a name="ln-107"></a>   <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dery</span><span class="p">,</span> <span class="n">derhy</span><span class="p">,</span> <span class="n">derz</span><span class="p">,</span> <span class="n">derhz</span>
<a name="ln-108"></a>   <span class="c">!============sums data on ghost points</span>
<a name="ln-109"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">prl</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-110"></a><span class="k">    call </span><span class="n">fill_curr_yzxbdsdata</span><span class="p">(</span><span class="n">curr</span><span class="p">,</span> <span class="n">curr_ndim</span><span class="p">)</span>
<a name="ln-111"></a>   <span class="k">end if</span>
<a name="ln-112"></a><span class="k">   call </span><span class="n">jc_xyzbd</span><span class="p">(</span><span class="n">curr</span><span class="p">,</span> <span class="n">curr_ndim</span><span class="p">)</span>
<a name="ln-113"></a>   <span class="c">!=================</span>
<a name="ln-114"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">iform</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-115"></a><span class="k">    do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ndim</span>
<a name="ln-116"></a>     <span class="n">curr</span><span class="p">(:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">djc</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">curr</span><span class="p">(:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="n">i</span><span class="p">)</span>
<a name="ln-117"></a>    <span class="k">end do</span>
<a name="ln-118"></a><span class="k">   end if</span>
<a name="ln-119"></a><span class="k">   if</span> <span class="p">(</span><span class="n">stretch</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-120"></a><span class="k">    select case</span> <span class="p">(</span><span class="n">curr_ndim</span><span class="p">)</span>
<a name="ln-121"></a>    <span class="k">case</span> <span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-122"></a>     <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kz1</span><span class="p">,</span> <span class="n">kz2</span>
<a name="ln-123"></a>      <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="n">jy1</span><span class="p">,</span> <span class="n">jy2</span>
<a name="ln-124"></a>       <span class="n">jj</span> <span class="o">=</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">2</span>
<a name="ln-125"></a>       <span class="n">dery</span> <span class="o">=</span> <span class="n">loc_yg</span><span class="p">(</span><span class="n">jj</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">imody</span><span class="p">)</span>
<a name="ln-126"></a>       <span class="n">derhy</span> <span class="o">=</span> <span class="n">loc_yg</span><span class="p">(</span><span class="n">jj</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">imody</span><span class="p">)</span>
<a name="ln-127"></a>       <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">ix1</span><span class="p">,</span> <span class="n">ix2</span>
<a name="ln-128"></a>        <span class="n">curr</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">dery</span><span class="o">*</span><span class="n">curr</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-129"></a>        <span class="n">curr</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">derhy</span><span class="o">*</span><span class="n">curr</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<a name="ln-130"></a>       <span class="k">end do</span>
<a name="ln-131"></a><span class="k">      end do</span>
<a name="ln-132"></a><span class="k">     end do</span>
<a name="ln-133"></a><span class="k">    case</span> <span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-134"></a>     <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kz1</span><span class="p">,</span> <span class="n">kz2</span>
<a name="ln-135"></a>      <span class="n">kk</span> <span class="o">=</span> <span class="n">k</span> <span class="o">-</span> <span class="mi">2</span>
<a name="ln-136"></a>      <span class="n">derz</span> <span class="o">=</span> <span class="n">loc_zg</span><span class="p">(</span><span class="n">kk</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">imodz</span><span class="p">)</span>
<a name="ln-137"></a>      <span class="n">derhz</span> <span class="o">=</span> <span class="n">loc_zg</span><span class="p">(</span><span class="n">kk</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">imodz</span><span class="p">)</span>
<a name="ln-138"></a>      <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="n">jy1</span><span class="p">,</span> <span class="n">jy2</span>
<a name="ln-139"></a>       <span class="n">jj</span> <span class="o">=</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">2</span>
<a name="ln-140"></a>       <span class="n">dery</span> <span class="o">=</span> <span class="n">loc_yg</span><span class="p">(</span><span class="n">jj</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">imody</span><span class="p">)</span>
<a name="ln-141"></a>       <span class="n">derhy</span> <span class="o">=</span> <span class="n">loc_yg</span><span class="p">(</span><span class="n">jj</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">imody</span><span class="p">)</span>
<a name="ln-142"></a>       <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">ix1</span><span class="p">,</span> <span class="n">ix2</span>
<a name="ln-143"></a>        <span class="n">curr</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">dery</span><span class="o">*</span><span class="n">derz</span><span class="o">*</span><span class="n">curr</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-144"></a>        <span class="n">curr</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">derhy</span><span class="o">*</span><span class="n">derz</span><span class="o">*</span><span class="n">curr</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<a name="ln-145"></a>        <span class="n">curr</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">dery</span><span class="o">*</span><span class="n">derhz</span><span class="o">*</span><span class="n">curr</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a name="ln-146"></a>       <span class="k">end do</span>
<a name="ln-147"></a><span class="k">      end do</span>
<a name="ln-148"></a><span class="k">     end do</span>
<a name="ln-149"></a><span class="k">    end select</span>
<a name="ln-150"></a><span class="k">   end if</span>
<a name="ln-151"></a><span class="k">  end subroutine</span>
<a name="ln-152"></a>  <span class="c">!=================================</span>
<a name="ln-153"></a>  <span class="c">! END SECTION ON GRID DEFINED PARTICLE VARIABLES</span>
<a name="ln-154"></a>  <span class="c">!================================================</span>
<a name="ln-155"></a>  <span class="k">subroutine </span><span class="n">pfields_prepare</span><span class="p">(</span><span class="n">ef</span><span class="p">,</span> <span class="n">nc</span><span class="p">,</span> <span class="n">spr</span><span class="p">,</span> <span class="n">spl</span><span class="p">)</span>
<a name="ln-156"></a>   <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ef</span><span class="p">(:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:)</span>
<a name="ln-157"></a>   <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nc</span><span class="p">,</span> <span class="n">spr</span><span class="p">,</span> <span class="n">spl</span>
<a name="ln-158"></a>   <span class="c">!===================</span>
<a name="ln-159"></a>   <span class="c">! Enter fields ef[i1:i2,j1,j2,k1,k2,1:nc)</span>
<a name="ln-160"></a>   <span class="c">! Exit fields ef[i1:i2,j1,j2,k1,k2,1:nc)</span>
<a name="ln-161"></a>   <span class="c">!===========================</span>
<a name="ln-162"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">prl</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-163"></a><span class="k">    call </span><span class="n">fill_ebfield_yzxbdsdata</span><span class="p">(</span><span class="n">ef</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nc</span><span class="p">,</span> <span class="n">spr</span><span class="p">,</span> <span class="n">spl</span><span class="p">)</span>
<a name="ln-164"></a>    <span class="c">!======================</span>
<a name="ln-165"></a>    <span class="c">! Adds point data =&gt; spl to the left spr to the right</span>
<a name="ln-166"></a>    <span class="c">! Sets periodic BCs for</span>
<a name="ln-167"></a>    <span class="c">! iby,ibz,ibx =2</span>
<a name="ln-168"></a>    <span class="c">!==================</span>
<a name="ln-169"></a>   <span class="k">end if</span>
<a name="ln-170"></a><span class="k">   call </span><span class="n">field_xyzbd</span><span class="p">(</span><span class="n">ef</span><span class="p">,</span> <span class="n">nc</span><span class="p">)</span>
<a name="ln-171"></a>   <span class="c">! extends for one point at the box boundaries</span>
<a name="ln-172"></a>   <span class="c">!==================================================</span>
<a name="ln-173"></a>  <span class="k">end subroutine</span>
<a name="ln-174"></a>  <span class="c">!================================</span>
<a name="ln-175"></a>  <span class="k">subroutine </span><span class="n">advance_lpf_fields</span><span class="p">(</span><span class="n">ef</span><span class="p">,</span> <span class="n">curr</span><span class="p">,</span> <span class="n">ibd</span><span class="p">)</span>
<a name="ln-176"></a>   <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ef</span><span class="p">(:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:)</span>
<a name="ln-177"></a>   <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">curr</span><span class="p">(:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:)</span>
<a name="ln-178"></a>   <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ibd</span>
<a name="ln-179"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">str</span><span class="p">,</span> <span class="n">stl</span><span class="p">,</span> <span class="n">ik</span>
<a name="ln-180"></a>   <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dth</span><span class="p">,</span> <span class="n">dt_lp</span>
<a name="ln-181"></a>
<a name="ln-182"></a>   <span class="n">dt_lp</span> <span class="o">=</span> <span class="n">dt_loc</span>
<a name="ln-183"></a>   <span class="n">dth</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">dt_lp</span>
<a name="ln-184"></a>   <span class="c">!=======================</span>
<a name="ln-185"></a>   <span class="c">! A LPF order Lpf with time-centered source term</span>
<a name="ln-186"></a>   <span class="c">!=============================</span>
<a name="ln-187"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">prl</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-188"></a><span class="k">    </span><span class="n">str</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-189"></a>    <span class="n">stl</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-190"></a>    <span class="k">call </span><span class="n">fill_ebfield_yzxbdsdata</span><span class="p">(</span><span class="n">ef</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">curr_ndim</span><span class="p">,</span> <span class="n">str</span><span class="p">,</span> <span class="n">stl</span><span class="p">)</span>
<a name="ln-191"></a>    <span class="c">! To fill electric field data</span>
<a name="ln-192"></a>    <span class="c">! sends stl to the left,</span>
<a name="ln-193"></a>    <span class="c">! recvs stl points from right at (nyp+stl), (nzp+stl)</span>
<a name="ln-194"></a>   <span class="k">end if</span>
<a name="ln-195"></a>   <span class="c">!============== first substep dt/2 advance of B-field</span>
<a name="ln-196"></a>   <span class="k">call </span><span class="n">ef_bds</span><span class="p">(</span><span class="n">ef</span><span class="p">,</span> <span class="n">zero_dp</span><span class="p">,</span> <span class="n">ibd</span><span class="p">)</span>
<a name="ln-197"></a>   <span class="c">! Uses upper BCs of E fields: ibd=0 for inflow-outflow</span>
<a name="ln-198"></a>   <span class="c">!                             ibd=1 for symmetric</span>
<a name="ln-199"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">comoving</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-200"></a><span class="k">    call </span><span class="n">field_xadvect</span><span class="p">(</span><span class="n">ef</span><span class="p">,</span> <span class="n">dth</span><span class="p">,</span> <span class="o">-</span><span class="n">vbeam</span><span class="p">,</span> <span class="n">curr_ndim</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nfield</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-201"></a>    <span class="c">! Solves for one-half step backward advection B field explicit</span>
<a name="ln-202"></a>    <span class="c">! B^{n} =&gt; B^{n}+v_b*Dth[Dx]B^n  v_b &gt;0</span>
<a name="ln-203"></a>   <span class="k">end if</span>
<a name="ln-204"></a>   <span class="c">!==================================</span>
<a name="ln-205"></a>   <span class="c">! solves B^{n+1/2}= B^n -Dth[rot E]^n</span>
<a name="ln-206"></a>   <span class="c">!============================</span>
<a name="ln-207"></a>   <span class="k">call </span><span class="n">rote</span><span class="p">(</span><span class="n">ef</span><span class="p">,</span> <span class="n">dth</span><span class="p">)</span>
<a name="ln-208"></a>   <span class="c">!=============================</span>
<a name="ln-209"></a>   <span class="c">!============== central step for advance of E-field</span>
<a name="ln-210"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">prl</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-211"></a><span class="k">    </span><span class="n">str</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-212"></a>    <span class="n">stl</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-213"></a>    <span class="k">call </span><span class="n">fill_ebfield_yzxbdsdata</span><span class="p">(</span><span class="n">ef</span><span class="p">,</span> <span class="n">curr_ndim</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nfield</span><span class="p">,</span> <span class="n">str</span><span class="p">,</span> <span class="n">stl</span><span class="p">)</span>
<a name="ln-214"></a>    <span class="c">! sends nyp+1-str to the right</span>
<a name="ln-215"></a>    <span class="c">! recvs str points from left at (1-str)</span>
<a name="ln-216"></a>   <span class="k">end if</span>
<a name="ln-217"></a>   <span class="c">!======================</span>
<a name="ln-218"></a>   <span class="k">call </span><span class="n">bf_bds</span><span class="p">(</span><span class="n">ef</span><span class="p">,</span> <span class="n">dt_lp</span><span class="p">,</span> <span class="n">ibd</span><span class="p">)</span>
<a name="ln-219"></a>   <span class="c">! Uses lower BCs for B fields: ibd=0 for inflow-outflow</span>
<a name="ln-220"></a>   <span class="c">!                             ibd=1 for symmetric</span>
<a name="ln-221"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">comoving</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-222"></a><span class="k">    call </span><span class="n">field_xadvect</span><span class="p">(</span><span class="n">ef</span><span class="p">,</span> <span class="n">dth</span><span class="p">,</span> <span class="o">-</span><span class="n">vbeam</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">curr_ndim</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<a name="ln-223"></a>    <span class="c">! Solves for half-step backward advection E field explicit</span>
<a name="ln-224"></a>    <span class="c">! E^{n} =&gt; E^{n}+v_b*Dth[Dx]E^n</span>
<a name="ln-225"></a>   <span class="k">end if</span>
<a name="ln-226"></a>   <span class="c">!=======================</span>
<a name="ln-227"></a>   <span class="c">! solves E^{n+1}= E^n +DT[rot B]^{n+1/2}- ompe*DT*J^{n+1/2}</span>
<a name="ln-228"></a>   <span class="c">!==================</span>
<a name="ln-229"></a>   <span class="k">call </span><span class="n">rotb</span><span class="p">(</span><span class="n">ef</span><span class="p">,</span> <span class="n">dt_lp</span><span class="p">)</span>
<a name="ln-230"></a>   <span class="c">!===================</span>
<a name="ln-231"></a>   <span class="c">! adds currents</span>
<a name="ln-232"></a>   <span class="k">do </span><span class="n">ik</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">curr_ndim</span>
<a name="ln-233"></a>    <span class="n">ef</span><span class="p">(</span><span class="n">ix1</span><span class="p">:</span><span class="n">ix2</span><span class="p">,</span> <span class="n">jy1</span><span class="p">:</span><span class="n">jy2</span><span class="p">,</span> <span class="n">kz1</span><span class="p">:</span><span class="n">kz2</span><span class="p">,</span> <span class="n">ik</span><span class="p">)</span> <span class="o">=</span> <span class="n">ef</span><span class="p">(</span><span class="n">ix1</span><span class="p">:</span><span class="n">ix2</span><span class="p">,</span> <span class="n">jy1</span><span class="p">:</span><span class="n">jy2</span><span class="p">,</span> <span class="n">kz1</span><span class="p">:</span><span class="n">kz2</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-234"></a>                                           <span class="n">ik</span><span class="p">)</span> <span class="o">-</span> <span class="n">ompe</span><span class="o">*</span><span class="n">curr</span><span class="p">(</span><span class="n">ix1</span><span class="p">:</span><span class="n">ix2</span><span class="p">,</span> <span class="n">jy1</span><span class="p">:</span><span class="n">jy2</span><span class="p">,</span> <span class="n">kz1</span><span class="p">:</span><span class="n">kz2</span><span class="p">,</span> <span class="n">ik</span><span class="p">)</span>
<a name="ln-235"></a>   <span class="k">end do</span>
<a name="ln-236"></a><span class="k">   if</span> <span class="p">(</span><span class="n">comoving</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-237"></a><span class="k">    call </span><span class="n">field_xadvect</span><span class="p">(</span><span class="n">ef</span><span class="p">,</span> <span class="n">dth</span><span class="p">,</span> <span class="o">-</span><span class="n">vbeam</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">curr_ndim</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<a name="ln-238"></a>    <span class="c">! Solves for backward advection E field implicit</span>
<a name="ln-239"></a>    <span class="c">! E^{n+1} =&gt; E^{n}+v_b*Dth[Dx]E^{n+1}</span>
<a name="ln-240"></a>   <span class="k">end if</span>
<a name="ln-241"></a>   <span class="c">!============== second substep dt/2 advance of B-field</span>
<a name="ln-242"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">prl</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-243"></a><span class="k">    </span><span class="n">str</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-244"></a>    <span class="n">stl</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-245"></a>    <span class="k">call </span><span class="n">fill_ebfield_yzxbdsdata</span><span class="p">(</span><span class="n">ef</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">curr_ndim</span><span class="p">,</span> <span class="n">str</span><span class="p">,</span> <span class="n">stl</span><span class="p">)</span>
<a name="ln-246"></a>   <span class="k">end if</span>
<a name="ln-247"></a>   <span class="c">! E field gets stl points from right (nyp+stl), (nzp+stl)</span>
<a name="ln-248"></a>   <span class="k">call </span><span class="n">ef_bds</span><span class="p">(</span><span class="n">ef</span><span class="p">,</span> <span class="n">dt_lp</span><span class="p">,</span> <span class="n">ibd</span><span class="p">)</span>
<a name="ln-249"></a>   <span class="c">! solves B^{n+1}= B^{n+1/2} -Dth[rot E]^{n+1}</span>
<a name="ln-250"></a>   <span class="c">!===================</span>
<a name="ln-251"></a>   <span class="k">call </span><span class="n">rote</span><span class="p">(</span><span class="n">ef</span><span class="p">,</span> <span class="n">dth</span><span class="p">)</span>
<a name="ln-252"></a>   <span class="c">!==============</span>
<a name="ln-253"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">comoving</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-254"></a><span class="k">    call </span><span class="n">field_xadvect</span><span class="p">(</span><span class="n">ef</span><span class="p">,</span> <span class="n">dth</span><span class="p">,</span> <span class="o">-</span><span class="n">vbeam</span><span class="p">,</span> <span class="n">curr_ndim</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nfield</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<a name="ln-255"></a>    <span class="c">! Solves for one-half step backward advection B field implicit</span>
<a name="ln-256"></a>    <span class="c">! B^{n+1} =&gt; B^{n+1/2}+v_b*Dth[Dx]B^{n+1}</span>
<a name="ln-257"></a>   <span class="k">end if</span>
<a name="ln-258"></a>   <span class="c">!===============</span>
<a name="ln-259"></a>  <span class="k">end subroutine</span>
<a name="ln-260"></a>  <span class="c">!======================</span>
<a name="ln-261"></a>  <span class="k">subroutine </span><span class="n">advance_lpf_envelope</span><span class="p">(</span><span class="n">curr</span><span class="p">,</span> <span class="n">evf</span><span class="p">,</span> <span class="n">omg</span><span class="p">)</span>
<a name="ln-262"></a>
<a name="ln-263"></a>   <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">curr</span><span class="p">(:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:),</span> <span class="n">evf</span><span class="p">(:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:)</span>
<a name="ln-264"></a>   <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">omg</span>
<a name="ln-265"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span>
<a name="ln-266"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">str</span><span class="p">,</span> <span class="n">stl</span><span class="p">,</span> <span class="n">cind</span><span class="p">,</span> <span class="n">ib</span>
<a name="ln-267"></a>   <span class="c">!====== enter env(3:4)=A^{n-1} and env(1:2)= A^{n}</span>
<a name="ln-268"></a>   <span class="c">! enters jc(3)=&lt;wgh*n/gamp&gt; &gt;0</span>
<a name="ln-269"></a>   <span class="n">str</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-270"></a>   <span class="n">stl</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-271"></a>   <span class="c">!ord=2</span>
<a name="ln-272"></a>   <span class="n">cind</span> <span class="o">=</span> <span class="mi">1</span> <span class="c">!cind=0 FFT cind=1 grid deriv</span>
<a name="ln-273"></a>   <span class="n">ib</span> <span class="o">=</span> <span class="mi">2</span> <span class="c">!ib=1 implicit ib=2 optimazid explicit</span>
<a name="ln-274"></a>   <span class="c">!optimized advection scheme</span>
<a name="ln-275"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">comoving</span><span class="p">)</span> <span class="n">ib</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-276"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">prl</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-277"></a><span class="k">    call </span><span class="n">fill_ebfield_yzxbdsdata</span><span class="p">(</span><span class="n">evf</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">str</span><span class="p">,</span> <span class="n">stl</span><span class="p">)</span>
<a name="ln-278"></a>   <span class="k">end if</span>
<a name="ln-279"></a><span class="k">   call </span><span class="n">env_bds</span><span class="p">(</span><span class="n">evf</span><span class="p">,</span> <span class="n">str</span><span class="p">,</span> <span class="n">stl</span><span class="p">)</span>
<a name="ln-280"></a>
<a name="ln-281"></a>   <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kz1</span><span class="p">,</span> <span class="n">kz2</span>
<a name="ln-282"></a>    <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="n">jy1</span><span class="p">,</span> <span class="n">jy2</span>
<a name="ln-283"></a>     <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">ix1</span><span class="p">,</span> <span class="n">ix2</span>
<a name="ln-284"></a>      <span class="n">curr</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">ompe</span><span class="o">*</span><span class="n">curr</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">evf</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-285"></a>      <span class="n">curr</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">ompe</span><span class="o">*</span><span class="n">curr</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">evf</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<a name="ln-286"></a>     <span class="k">end do</span>
<a name="ln-287"></a><span class="k">    end do</span>
<a name="ln-288"></a><span class="k">   end do</span>
<a name="ln-289"></a>   <span class="c">!  curr(1:2)=-ompe*chi*env(1:2)  the J_{env} source term</span>
<a name="ln-290"></a>   <span class="c">!==================================</span>
<a name="ln-291"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">ib</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-292"></a><span class="k">    call </span><span class="n">env_lpf_solve</span><span class="p">(</span><span class="n">jc</span><span class="p">,</span> <span class="n">evf</span><span class="p">,</span> <span class="n">ib</span><span class="p">,</span> <span class="n">omg</span><span class="p">,</span> <span class="n">dt_loc</span><span class="p">)</span>
<a name="ln-293"></a>   <span class="k">else</span>
<a name="ln-294"></a>    <span class="c">!=================== second order in time full wave equation</span>
<a name="ln-295"></a>    <span class="k">call </span><span class="n">env_maxw_solve</span><span class="p">(</span><span class="n">jc</span><span class="p">,</span> <span class="n">evf</span><span class="p">,</span> <span class="n">omg</span><span class="p">,</span> <span class="n">dt_loc</span><span class="p">)</span>
<a name="ln-296"></a>   <span class="k">end if</span>
<a name="ln-297"></a>   <span class="c">! =================================</span>
<a name="ln-298"></a>  <span class="k">end subroutine</span>
<a name="ln-299"></a>  <span class="c">!========================================================</span>
<a name="ln-300"></a>
<a name="ln-301"></a>  <span class="k">subroutine </span><span class="n">wave_field_left_inject</span><span class="p">(</span><span class="n">ef</span><span class="p">,</span> <span class="n">x_left</span><span class="p">)</span>
<a name="ln-302"></a>   <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ef</span><span class="p">(:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:)</span>
<a name="ln-303"></a>   <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">x_left</span>
<a name="ln-304"></a>   <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tnew</span><span class="p">,</span> <span class="n">xm</span>
<a name="ln-305"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">wmodel_id</span><span class="p">,</span> <span class="n">ic</span>
<a name="ln-306"></a>
<a name="ln-307"></a>   <span class="n">wmodel_id</span> <span class="o">=</span> <span class="n">model_id</span>
<a name="ln-308"></a>   <span class="n">xm</span> <span class="o">=</span> <span class="n">xmn</span>
<a name="ln-309"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">plane_wave</span><span class="p">)</span> <span class="n">wmodel_id</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-310"></a>   <span class="n">tnew</span> <span class="o">=</span> <span class="n">tnow</span> <span class="c">!Set inflow values [B_z{n}(i1-1/2) E_y{n}(i-1}</span>
<a name="ln-311"></a>   <span class="n">lp_inject</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-312"></a>   <span class="k">do </span><span class="n">ic</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nb_laser</span>
<a name="ln-313"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">lp_in</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">x_left</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-314"></a><span class="k">     if</span> <span class="p">(</span><span class="n">lp_end</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">xm</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-315"></a><span class="k">      </span><span class="n">lp_inject</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-316"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">model_id</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">)</span> <span class="k">call </span><span class="n">inflow_lp_fields</span><span class="p">(</span><span class="n">ebf</span><span class="p">,</span> <span class="n">lp_amp</span><span class="p">,</span> <span class="n">tnew</span><span class="p">,</span> <span class="n">t0_lp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-317"></a>                                              <span class="n">w0_x</span><span class="p">,</span> <span class="n">w0_y</span><span class="p">,</span> <span class="n">xf_loc</span><span class="p">(</span><span class="n">ic</span><span class="p">),</span> <span class="n">oml</span><span class="p">,</span> <span class="n">wmodel_id</span><span class="p">,</span> <span class="n">ix1</span><span class="p">,</span> <span class="n">jy1</span><span class="p">,</span> <span class="n">jy2</span><span class="p">,</span> <span class="n">kz1</span><span class="p">,</span> <span class="n">kz2</span><span class="p">)</span>
<a name="ln-318"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">model_id</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="k">call </span><span class="n">inflow_cp_fields</span><span class="p">(</span><span class="n">ebf</span><span class="p">,</span> <span class="n">lp_amp</span><span class="p">,</span> <span class="n">tnew</span><span class="p">,</span> <span class="n">t0_lp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-319"></a>                                               <span class="n">w0_x</span><span class="p">,</span> <span class="n">w0_y</span><span class="p">,</span> <span class="n">xf_loc</span><span class="p">(</span><span class="n">ic</span><span class="p">),</span> <span class="n">wmodel_id</span><span class="p">,</span> <span class="n">ix1</span><span class="p">,</span> <span class="n">jy1</span><span class="p">,</span> <span class="n">jy2</span><span class="p">,</span> <span class="n">kz1</span><span class="p">,</span> <span class="n">kz2</span><span class="p">)</span>
<a name="ln-320"></a>     <span class="k">end if</span>
<a name="ln-321"></a><span class="k">    end if</span>
<a name="ln-322"></a><span class="k">    </span><span class="n">lp_in</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span> <span class="o">=</span> <span class="n">lp_in</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span> <span class="o">+</span> <span class="n">dt_loc</span>
<a name="ln-323"></a>    <span class="n">lp_end</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span> <span class="o">=</span> <span class="n">lp_end</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span> <span class="o">+</span> <span class="n">dt_loc</span>
<a name="ln-324"></a>   <span class="k">end do</span>
<a name="ln-325"></a><span class="k">   if</span> <span class="p">(</span><span class="n">Two_color</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-326"></a><span class="k">    if</span> <span class="p">(</span><span class="n">lp_ionz_in</span> <span class="o">&lt;</span> <span class="n">x_left</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-327"></a><span class="k">     if</span> <span class="p">(</span><span class="n">lp_ionz_end</span> <span class="o">&gt;=</span> <span class="n">xm</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-328"></a><span class="k">      </span><span class="n">lp_inject</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-329"></a>      <span class="k">call </span><span class="n">inflow_lp_fields</span><span class="p">(</span><span class="n">ebf</span><span class="p">,</span> <span class="n">lp1_amp</span><span class="p">,</span> <span class="n">tnew</span><span class="p">,</span> <span class="n">t1_lp</span><span class="p">,</span> <span class="n">w1_x</span><span class="p">,</span> <span class="n">w1_y</span><span class="p">,</span> <span class="n">xf1</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-330"></a>                            <span class="n">om1</span><span class="p">,</span> <span class="n">model_id</span><span class="p">,</span> <span class="n">ix1</span><span class="p">,</span> <span class="n">jy1</span><span class="p">,</span> <span class="n">jy2</span><span class="p">,</span> <span class="n">kz1</span><span class="p">,</span> <span class="n">kz2</span><span class="p">)</span>
<a name="ln-331"></a>     <span class="k">end if</span>
<a name="ln-332"></a><span class="k">    end if</span>
<a name="ln-333"></a><span class="k">    </span><span class="n">lp_ionz_in</span> <span class="o">=</span> <span class="n">lp_ionz_in</span> <span class="o">+</span> <span class="n">dt_loc</span>
<a name="ln-334"></a>    <span class="n">lp_ionz_end</span> <span class="o">=</span> <span class="n">lp_ionz_end</span> <span class="o">+</span> <span class="n">dt_loc</span>
<a name="ln-335"></a>   <span class="k">end if</span>
<a name="ln-336"></a><span class="k">  end subroutine</span>
<a name="ln-337"></a>  <span class="c">!===================================================</span>
<a name="ln-338"></a>  <span class="k">subroutine </span><span class="n">advect_bunch_fields</span><span class="p">(</span><span class="n">fb</span><span class="p">,</span> <span class="n">curr</span><span class="p">,</span> <span class="n">v_b</span><span class="p">)</span>
<a name="ln-339"></a>
<a name="ln-340"></a>   <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fb</span><span class="p">(:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:),</span> <span class="n">curr</span><span class="p">(:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:)</span>
<a name="ln-341"></a>   <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">v_b</span>
<a name="ln-342"></a>   <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dth</span>
<a name="ln-343"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span>
<a name="ln-344"></a>
<a name="ln-345"></a>   <span class="n">dth</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">dt_loc</span>
<a name="ln-346"></a>   <span class="c">!In 2D nfield=3 nbfield=4=nfield+1   in fb(4)=Jx[i+1/2,j,k] at t=0</span>
<a name="ln-347"></a>   <span class="c">!fb=[Ex,Ey,Ez,Jx,By,Bz]</span>
<a name="ln-348"></a>   <span class="c">!================================================</span>
<a name="ln-349"></a>   <span class="k">call </span><span class="n">fill_ebfield_xbdsdata</span><span class="p">(</span><span class="n">fb</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nbfield</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-350"></a>   <span class="k">if</span> <span class="p">(</span><span class="n">initial_time</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-351"></a><span class="k">    call </span><span class="n">field_xadvect</span><span class="p">(</span><span class="n">fb</span><span class="p">,</span> <span class="n">dth</span><span class="p">,</span> <span class="o">-</span><span class="n">v_b</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-352"></a>    <span class="n">fb</span><span class="p">(:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">dt_loc</span><span class="o">*</span><span class="n">fb</span><span class="p">(:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="mi">4</span><span class="p">)</span>
<a name="ln-353"></a>   <span class="k">end if</span>
<a name="ln-354"></a><span class="k">   call </span><span class="n">field_xadvect</span><span class="p">(</span><span class="n">fb</span><span class="p">,</span> <span class="n">dt_loc</span><span class="p">,</span> <span class="n">v_b</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nbfield</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-355"></a>   <span class="k">do </span><span class="n">iz</span> <span class="o">=</span> <span class="n">kz1</span><span class="p">,</span> <span class="n">kz2</span>
<a name="ln-356"></a>    <span class="k">do </span><span class="n">iy</span> <span class="o">=</span> <span class="n">jy1</span><span class="p">,</span> <span class="n">jy2</span>
<a name="ln-357"></a>     <span class="k">do </span><span class="n">ix</span> <span class="o">=</span> <span class="n">ix1</span><span class="p">,</span> <span class="n">ix2</span>
<a name="ln-358"></a>      <span class="n">curr</span><span class="p">(</span><span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">curr</span><span class="p">(</span><span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">fb</span><span class="p">(</span><span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<a name="ln-359"></a>     <span class="k">end do</span>
<a name="ln-360"></a><span class="k">    end do</span>
<a name="ln-361"></a><span class="k">   end do</span>
<a name="ln-362"></a>   <span class="c">! Subtracts from the longitudinal bunch current the advected initial bunch</span>
<a name="ln-363"></a>   <span class="c">! current</span>
<a name="ln-364"></a>  <span class="k">end subroutine</span>
<a name="ln-365"></a>  <span class="c">!============================</span>
<a name="ln-366"></a> <span class="k">end module</span>
</pre></div>

    </section>
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2020 <a rel="license" href="http://www.gnu.org/licenses/old-licenses/fdl-1.2.en.html">GNU Free Documentation License</a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
             on 2020-07-30 
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> ALaDyn was developed by The ALaDyn Collaboration</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>